<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Blue-Green Deployment Pattern | Tenant Operator</title>
    <meta name="description" content="Database-Driven Kubernetes Automation / Multi-Tenant Kubernetes Automation Platform">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/assets/style.y1veliee.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.DL_APeiC.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.9Uv4PgnO.js">
    <link rel="modulepreload" href="/assets/chunks/theme.D4bYJWKN.js">
    <link rel="modulepreload" href="/assets/chunks/katex.BbEIqZs1.js">
    <link rel="modulepreload" href="/assets/chunks/dagre-6UL2VRFP.BJ1x8grX.js">
    <link rel="modulepreload" href="/assets/chunks/cose-bilkent-S5V4N54A.Ct0WGeIH.js">
    <link rel="modulepreload" href="/assets/chunks/c4Diagram-YG6GDRKO.CJ6l-pQ4.js">
    <link rel="modulepreload" href="/assets/chunks/flowDiagram-NV44I4VS.Wxzy61_p.js">
    <link rel="modulepreload" href="/assets/chunks/erDiagram-Q2GNP2WA.BEdcUcKF.js">
    <link rel="modulepreload" href="/assets/chunks/gitGraphDiagram-NY62KEGX.bAXcvOu2.js">
    <link rel="modulepreload" href="/assets/chunks/ganttDiagram-LVOFAZNH.Bw_S0usm.js">
    <link rel="modulepreload" href="/assets/chunks/infoDiagram-ER5ION4S.BybMcqNA.js">
    <link rel="modulepreload" href="/assets/chunks/pieDiagram-ADFJNKIX.CRKra_5F.js">
    <link rel="modulepreload" href="/assets/chunks/quadrantDiagram-AYHSOK5B.ChItRrkJ.js">
    <link rel="modulepreload" href="/assets/chunks/xychartDiagram-PRI3JC2R.DamQ_kAm.js">
    <link rel="modulepreload" href="/assets/chunks/requirementDiagram-UZGBJVZJ.DxRoyQMu.js">
    <link rel="modulepreload" href="/assets/chunks/sequenceDiagram-WL72ISMW.GNcELh1z.js">
    <link rel="modulepreload" href="/assets/chunks/classDiagram-2ON5EDUG.DK7hppxv.js">
    <link rel="modulepreload" href="/assets/chunks/classDiagram-v2-WZHVMYZB.DK7hppxv.js">
    <link rel="modulepreload" href="/assets/chunks/stateDiagram-FKZM4ZOC.UDiYukBN.js">
    <link rel="modulepreload" href="/assets/chunks/stateDiagram-v2-4FDKWEC3.e2aym8To.js">
    <link rel="modulepreload" href="/assets/chunks/journeyDiagram-XKPGCS4Q.D7Cz_i02.js">
    <link rel="modulepreload" href="/assets/chunks/timeline-definition-IT6M3QCI.Cqz7SO79.js">
    <link rel="modulepreload" href="/assets/chunks/mindmap-definition-VGOIOE7T.rADOPhmg.js">
    <link rel="modulepreload" href="/assets/chunks/kanban-definition-3W4ZIXB7.Bw563yh1.js">
    <link rel="modulepreload" href="/assets/chunks/sankeyDiagram-TZEHDZUN.Bb6fx0sE.js">
    <link rel="modulepreload" href="/assets/chunks/diagram-S2PKOQOG.Bry09oa7.js">
    <link rel="modulepreload" href="/assets/chunks/diagram-QEK2KX5R.CiKb2zs3.js">
    <link rel="modulepreload" href="/assets/chunks/blockDiagram-VD42YOAC.BDYQ_sOv.js">
    <link rel="modulepreload" href="/assets/chunks/architectureDiagram-VXUJARFQ.BkyyeGoj.js">
    <link rel="modulepreload" href="/assets/chunks/diagram-PSM6KHXK.Cc2HasQa.js">
    <link rel="modulepreload" href="/assets/chunks/virtual_mermaid-config.DDnGl6nM.js">
    <link rel="modulepreload" href="/assets/use-case-blue-green.md.2_nGobwB.lean.js">
    <link rel="icon" type="image/png" href="/logo.png">
    <link rel="shortcut icon" href="/logo.ico">
    <link rel="apple-touch-icon" href="/logo.ico">
    <meta name="google-site-verification" content="g7LPr3Wcm6hCm-Lm8iP5KVl11KvPv6Chxpjh3oNKHPw">
    <script id="check-dark-mode">document.documentElement.classList.add("dark");</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-d8b57b2d><!--[--><!--]--><!--[--><span tabindex="-1" data-v-fcbfc0e0></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-fcbfc0e0>Skip to content</a><!--]--><!----><header class="VPNav" data-v-d8b57b2d data-v-7ad780c2><div class="VPNavBar" data-v-7ad780c2 data-v-9fd4d1dd><div class="wrapper" data-v-9fd4d1dd><div class="container" data-v-9fd4d1dd><div class="title" data-v-9fd4d1dd><div class="VPNavBarTitle has-sidebar" data-v-9fd4d1dd data-v-9f43907a><a class="title" href="/" data-v-9f43907a><!--[--><!--]--><!--[--><img class="VPImage logo" src="/logo.png" alt data-v-ab19afbb><!--]--><span data-v-9f43907a>Tenant Operator</span><!--[--><!--]--></a></div></div><div class="content" data-v-9fd4d1dd><div class="content-body" data-v-9fd4d1dd><!--[--><!--]--><div class="VPNavBarSearch search" data-v-9fd4d1dd><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-9fd4d1dd data-v-afb2845e><span id="main-nav-aria-label" class="visually-hidden" data-v-afb2845e> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/quickstart.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Quick Start</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/architecture.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>Documentation</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/api.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>API</span><!--]--></a><!--]--><!--]--></nav><!----><!----><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-9fd4d1dd data-v-ef6192dc data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/kubernetes-tenants/tenant-operator" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-9fd4d1dd data-v-f953d92f data-v-bfe7971f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-bfe7971f><span class="vpi-more-horizontal icon" data-v-bfe7971f></span></button><div class="menu" data-v-bfe7971f><div class="VPMenu" data-v-bfe7971f data-v-20ed86d6><!----><!--[--><!--[--><!----><!----><div class="group" data-v-f953d92f><div class="item social-links" data-v-f953d92f><div class="VPSocialLinks social-links-list" data-v-f953d92f data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/kubernetes-tenants/tenant-operator" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-9fd4d1dd data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><div class="divider" data-v-9fd4d1dd><div class="divider-line" data-v-9fd4d1dd></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-d8b57b2d data-v-2488c25a><div class="container" data-v-2488c25a><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2488c25a><span class="vpi-align-left menu-icon" data-v-2488c25a></span><span class="menu-text" data-v-2488c25a>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-2488c25a data-v-6b867909><button data-v-6b867909>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-d8b57b2d data-v-42c4c606><div class="curtain" data-v-42c4c606></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-42c4c606><span class="visually-hidden" id="sidebar-aria-label" data-v-42c4c606> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 collapsible" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>Getting Started</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0009425e><span class="vpi-chevron-right caret-icon" data-v-0009425e></span></div></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/installation.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Installation</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/quickstart.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Quick Start</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 collapsible" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>Core Concepts</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0009425e><span class="vpi-chevron-right caret-icon" data-v-0009425e></span></div></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/architecture.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Architecture</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/api.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>API Reference</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/configuration.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Configuration</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/datasource.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Datasources</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/templates.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Templates</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/dependencies.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Dependencies</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1 collapsible" data-v-0009425e data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h3 class="text" data-v-0009425e>Policies</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0009425e><span class="vpi-chevron-right caret-icon" data-v-0009425e></span></div></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/policies.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Overview</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/policies-examples.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Examples</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/field-ignore.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Field-Level Ignore</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 collapsible has-active" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>Advanced Use Cases</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0009425e><span class="vpi-chevron-right caret-icon" data-v-0009425e></span></div></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/advanced-use-cases.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Overview</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/use-case-custom-domains.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Custom Domains</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/use-case-multi-tier.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Multi-Tier Stack</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/use-case-blue-green.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Blue-Green Deployments</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/use-case-database-per-tenant.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Database-per-Tenant</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/use-case-feature-flags.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Feature Flags</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 collapsible" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>Operations</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0009425e><span class="vpi-chevron-right caret-icon" data-v-0009425e></span></div></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/monitoring.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Monitoring & Observability</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/prometheus-queries.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Prometheus Queries</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/performance.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Performance Tuning</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/security.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Security</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/troubleshooting.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Troubleshooting</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/alert-runbooks.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Alert Runbooks</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 collapsible" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>Integrations</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0009425e><span class="vpi-chevron-right caret-icon" data-v-0009425e></span></div></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/integration-crossplane.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Crossplane (Recommended)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/integration-external-dns.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>External DNS (Recommended)</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/integration-terraform-operator.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Terraform Operator</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/integration-argocd.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Argo CD</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 collapsible" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>Development</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-0009425e><span class="vpi-chevron-right caret-icon" data-v-0009425e></span></div></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/local-development-minikube.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Local Development</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/development.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Development Guide</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/contributing-datasource.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Contributing</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/roadmap.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Roadmap</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-0009425e><!----><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/glossary.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Glossary</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-d8b57b2d data-v-9a6c75ad><div class="VPDoc has-sidebar has-aside" data-v-9a6c75ad data-v-e6f2a212><!--[--><!--]--><div class="container" data-v-e6f2a212><div class="aside" data-v-e6f2a212><div class="aside-curtain" data-v-e6f2a212></div><div class="aside-container" data-v-e6f2a212><div class="aside-content" data-v-e6f2a212><div class="VPDocAside" data-v-e6f2a212 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-cb998dce data-v-f610f197><div class="content" data-v-f610f197><div class="outline-marker" data-v-f610f197></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-f610f197>On this page</div><ul class="VPDocOutlineItem root" data-v-f610f197 data-v-53c99d69><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e6f2a212><div class="content-container" data-v-e6f2a212><!--[--><!--]--><main class="main" data-v-e6f2a212><div style="position:relative;" class="vp-doc _use-case-blue-green" data-v-e6f2a212><div><h1 id="blue-green-deployment-pattern" tabindex="-1">Blue-Green Deployment Pattern <a class="header-anchor" href="#blue-green-deployment-pattern" aria-label="Permalink to &quot;Blue-Green Deployment Pattern&quot;">​</a></h1><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p>Implement zero-downtime deployments by maintaining two complete environments (blue and green) and switching traffic between them.</p><p>This pattern is useful when:</p><ul><li>You need instant rollback capability</li><li>You want to test new versions in production before switching traffic</li><li>You need to validate deployments with real production load</li><li>Zero-downtime is critical for your SLA</li></ul><h2 id="architecture" tabindex="-1">Architecture <a class="header-anchor" href="#architecture" aria-label="Permalink to &quot;Architecture&quot;">​</a></h2><div class="mermaid my-class"></div><h2 id="database-schema" tabindex="-1">Database Schema <a class="header-anchor" href="#database-schema" aria-label="Permalink to &quot;Database Schema&quot;">​</a></h2><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#F97583;"> TABLE</span><span style="color:#B392F0;"> tenants</span><span style="color:#E1E4E8;"> (</span></span>
<span class="line"><span style="color:#E1E4E8;">  tenant_id </span><span style="color:#F97583;">VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">63</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">PRIMARY KEY</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  domain </span><span style="color:#F97583;">VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">255</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">NOT NULL</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  is_active </span><span style="color:#F97583;">BOOLEAN</span><span style="color:#F97583;"> DEFAULT</span><span style="color:#E1E4E8;"> TRUE,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">  -- Blue-Green deployment control</span></span>
<span class="line"><span style="color:#E1E4E8;">  active_color </span><span style="color:#F97583;">VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">DEFAULT</span><span style="color:#9ECBFF;"> &#39;blue&#39;</span><span style="color:#E1E4E8;">,   </span><span style="color:#6A737D;">-- &#39;blue&#39; or &#39;green&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">  blue_version </span><span style="color:#F97583;">VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">DEFAULT</span><span style="color:#9ECBFF;"> &#39;v1.0.0&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  green_version </span><span style="color:#F97583;">VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">DEFAULT</span><span style="color:#9ECBFF;"> &#39;v1.0.0&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">  -- Deployment status tracking</span></span>
<span class="line"><span style="color:#E1E4E8;">  deployment_status </span><span style="color:#F97583;">VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">DEFAULT</span><span style="color:#9ECBFF;"> &#39;stable&#39;</span><span style="color:#E1E4E8;">,  </span><span style="color:#6A737D;">-- stable, deploying, testing, rolling-back</span></span>
<span class="line"><span style="color:#E1E4E8;">  last_deployment_at </span><span style="color:#F97583;">TIMESTAMP</span></span>
<span class="line"><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- Deployment workflow:</span></span>
<span class="line"><span style="color:#6A737D;">-- 1. Update inactive color&#39;s version (e.g., green_version = &#39;v2.0.0&#39;)</span></span>
<span class="line"><span style="color:#6A737D;">-- 2. Set deployment_status = &#39;deploying&#39;</span></span>
<span class="line"><span style="color:#6A737D;">-- 3. Operator creates/updates green deployment</span></span>
<span class="line"><span style="color:#6A737D;">-- 4. Run smoke tests against green</span></span>
<span class="line"><span style="color:#6A737D;">-- 5. Switch active_color from &#39;blue&#39; to &#39;green&#39;</span></span>
<span class="line"><span style="color:#6A737D;">-- 6. Set deployment_status = &#39;stable&#39;</span></span>
<span class="line"><span style="color:#6A737D;">-- 7. Blue environment now becomes next deployment target</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="tenantregistry" tabindex="-1">TenantRegistry <a class="header-anchor" href="#tenantregistry" aria-label="Permalink to &quot;TenantRegistry&quot;">​</a></h2><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">operator.kubernetes-tenants.org/v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">TenantRegistry</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">  name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">blue-green-tenants</span></span>
<span class="line"><span style="color:#85E89D;">  namespace</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">tenant-operator-system</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">  source</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">    type</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">mysql</span></span>
<span class="line"><span style="color:#85E89D;">    syncInterval</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">1m</span></span>
<span class="line"><span style="color:#85E89D;">    mysql</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">      host</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">mysql.database.svc.cluster.local</span></span>
<span class="line"><span style="color:#85E89D;">      port</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">3306</span></span>
<span class="line"><span style="color:#85E89D;">      database</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">tenants_db</span></span>
<span class="line"><span style="color:#85E89D;">      username</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">tenant_reader</span></span>
<span class="line"><span style="color:#85E89D;">      passwordRef</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">        name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">mysql-credentials</span></span>
<span class="line"><span style="color:#85E89D;">        key</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">password</span></span>
<span class="line"><span style="color:#85E89D;">      table</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">tenants</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D;">  valueMappings</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">    uid</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">tenant_id</span></span>
<span class="line"><span style="color:#85E89D;">    hostOrUrl</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">domain</span></span>
<span class="line"><span style="color:#85E89D;">    activate</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">is_active</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D;">  extraValueMappings</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">    activeColor</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">active_color</span></span>
<span class="line"><span style="color:#85E89D;">    blueVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">blue_version</span></span>
<span class="line"><span style="color:#85E89D;">    greenVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">green_version</span></span>
<span class="line"><span style="color:#85E89D;">    deploymentStatus</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">deployment_status</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="tenanttemplate" tabindex="-1">TenantTemplate <a class="header-anchor" href="#tenanttemplate" aria-label="Permalink to &quot;TenantTemplate&quot;">​</a></h2><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">operator.kubernetes-tenants.org/v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">TenantTemplate</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">  name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">blue-green-app</span></span>
<span class="line"><span style="color:#85E89D;">  namespace</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">tenant-operator-system</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">  registryId</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">blue-green-tenants</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D;">  deployments</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#6A737D;">    # Blue Deployment</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">blue-deployment</span></span>
<span class="line"><span style="color:#85E89D;">      nameTemplate</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}-blue&quot;</span></span>
<span class="line"><span style="color:#85E89D;">      labelsTemplate</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">        app</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}&quot;</span></span>
<span class="line"><span style="color:#85E89D;">        color</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;blue&quot;</span></span>
<span class="line"><span style="color:#85E89D;">        active</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ if eq .activeColor </span><span style="color:#79B8FF;">\&quot;</span><span style="color:#9ECBFF;">blue</span><span style="color:#79B8FF;">\&quot;</span><span style="color:#9ECBFF;"> }}true{{ else }}false{{ end }}&quot;</span></span>
<span class="line"><span style="color:#85E89D;">      spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">        replicas</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ if eq .activeColor </span><span style="color:#79B8FF;">\&quot;</span><span style="color:#9ECBFF;">blue</span><span style="color:#79B8FF;">\&quot;</span><span style="color:#9ECBFF;"> }}3{{ else }}1{{ end }}&quot;</span><span style="color:#6A737D;">  # Scale down inactive</span></span>
<span class="line"><span style="color:#85E89D;">        selector</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">          matchLabels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">            app</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}&quot;</span></span>
<span class="line"><span style="color:#85E89D;">            color</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;blue&quot;</span></span>
<span class="line"><span style="color:#85E89D;">        template</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">          metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">            labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">              app</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}&quot;</span></span>
<span class="line"><span style="color:#85E89D;">              color</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;blue&quot;</span></span>
<span class="line"><span style="color:#85E89D;">              version</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .blueVersion }}&quot;</span></span>
<span class="line"><span style="color:#85E89D;">          spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">            containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">              - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">app</span></span>
<span class="line"><span style="color:#85E89D;">                image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;registry.example.com/app:{{ .blueVersion }}&quot;</span></span>
<span class="line"><span style="color:#85E89D;">                env</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">                  - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">ENVIRONMENT_COLOR</span></span>
<span class="line"><span style="color:#85E89D;">                    value</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;blue&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">                  - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">TENANT_ID</span></span>
<span class="line"><span style="color:#85E89D;">                    value</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}&quot;</span></span>
<span class="line"><span style="color:#85E89D;">                ports</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">                  - </span><span style="color:#85E89D;">containerPort</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">8080</span></span>
<span class="line"><span style="color:#85E89D;">                resources</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">                  requests</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">                    cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">500m</span></span>
<span class="line"><span style="color:#85E89D;">                    memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">1Gi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">    # Green Deployment</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">green-deployment</span></span>
<span class="line"><span style="color:#85E89D;">      nameTemplate</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}-green&quot;</span></span>
<span class="line"><span style="color:#85E89D;">      labelsTemplate</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">        app</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}&quot;</span></span>
<span class="line"><span style="color:#85E89D;">        color</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;green&quot;</span></span>
<span class="line"><span style="color:#85E89D;">        active</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ if eq .activeColor </span><span style="color:#79B8FF;">\&quot;</span><span style="color:#9ECBFF;">green</span><span style="color:#79B8FF;">\&quot;</span><span style="color:#9ECBFF;"> }}true{{ else }}false{{ end }}&quot;</span></span>
<span class="line"><span style="color:#85E89D;">      spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">        replicas</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ if eq .activeColor </span><span style="color:#79B8FF;">\&quot;</span><span style="color:#9ECBFF;">green</span><span style="color:#79B8FF;">\&quot;</span><span style="color:#9ECBFF;"> }}3{{ else }}1{{ end }}&quot;</span></span>
<span class="line"><span style="color:#85E89D;">        selector</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">          matchLabels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">            app</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}&quot;</span></span>
<span class="line"><span style="color:#85E89D;">            color</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;green&quot;</span></span>
<span class="line"><span style="color:#85E89D;">        template</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">          metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">            labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">              app</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}&quot;</span></span>
<span class="line"><span style="color:#85E89D;">              color</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;green&quot;</span></span>
<span class="line"><span style="color:#85E89D;">              version</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .greenVersion }}&quot;</span></span>
<span class="line"><span style="color:#85E89D;">          spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">            containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">              - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">app</span></span>
<span class="line"><span style="color:#85E89D;">                image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;registry.example.com/app:{{ .greenVersion }}&quot;</span></span>
<span class="line"><span style="color:#85E89D;">                env</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">                  - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">ENVIRONMENT_COLOR</span></span>
<span class="line"><span style="color:#85E89D;">                    value</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;green&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">                  - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">TENANT_ID</span></span>
<span class="line"><span style="color:#85E89D;">                    value</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}&quot;</span></span>
<span class="line"><span style="color:#85E89D;">                ports</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">                  - </span><span style="color:#85E89D;">containerPort</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">8080</span></span>
<span class="line"><span style="color:#85E89D;">                resources</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">                  requests</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">                    cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">500m</span></span>
<span class="line"><span style="color:#85E89D;">                    memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">1Gi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">  # Service routing to active color</span></span>
<span class="line"><span style="color:#85E89D;">  services</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">main-service</span></span>
<span class="line"><span style="color:#85E89D;">      nameTemplate</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}-app&quot;</span></span>
<span class="line"><span style="color:#85E89D;">      dependIds</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;blue-deployment&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;green-deployment&quot;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#85E89D;">      spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">        selector</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">          app</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}&quot;</span></span>
<span class="line"><span style="color:#85E89D;">          color</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .activeColor }}&quot;</span><span style="color:#6A737D;">  # Dynamic selector based on active color</span></span>
<span class="line"><span style="color:#85E89D;">        ports</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">          - </span><span style="color:#85E89D;">port</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">80</span></span>
<span class="line"><span style="color:#85E89D;">            targetPort</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">8080</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">    # Dedicated services for testing inactive environment</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">blue-test-service</span></span>
<span class="line"><span style="color:#85E89D;">      nameTemplate</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}-blue-test&quot;</span></span>
<span class="line"><span style="color:#85E89D;">      spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">        selector</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">          app</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}&quot;</span></span>
<span class="line"><span style="color:#85E89D;">          color</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;blue&quot;</span></span>
<span class="line"><span style="color:#85E89D;">        ports</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">          - </span><span style="color:#85E89D;">port</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">80</span></span>
<span class="line"><span style="color:#85E89D;">            targetPort</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">8080</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">green-test-service</span></span>
<span class="line"><span style="color:#85E89D;">      nameTemplate</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}-green-test&quot;</span></span>
<span class="line"><span style="color:#85E89D;">      spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">        selector</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">          app</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}&quot;</span></span>
<span class="line"><span style="color:#85E89D;">          color</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;green&quot;</span></span>
<span class="line"><span style="color:#85E89D;">        ports</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">          - </span><span style="color:#85E89D;">port</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">80</span></span>
<span class="line"><span style="color:#85E89D;">            targetPort</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">8080</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">  # Main ingress (routes to active)</span></span>
<span class="line"><span style="color:#85E89D;">  ingresses</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">main-ingress</span></span>
<span class="line"><span style="color:#85E89D;">      nameTemplate</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}-ingress&quot;</span></span>
<span class="line"><span style="color:#85E89D;">      dependIds</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;main-service&quot;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#85E89D;">      spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">        ingressClassName</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nginx</span></span>
<span class="line"><span style="color:#85E89D;">        rules</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">          - </span><span style="color:#85E89D;">host</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .host }}&quot;</span></span>
<span class="line"><span style="color:#85E89D;">            http</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">              paths</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">                - </span><span style="color:#85E89D;">path</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">/</span></span>
<span class="line"><span style="color:#85E89D;">                  pathType</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Prefix</span></span>
<span class="line"><span style="color:#85E89D;">                  backend</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">                    service</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">                      name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}-app&quot;</span></span>
<span class="line"><span style="color:#85E89D;">                      port</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">                        number</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">80</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">    # Test ingresses for pre-production validation</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">blue-test-ingress</span></span>
<span class="line"><span style="color:#85E89D;">      nameTemplate</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}-blue-test&quot;</span></span>
<span class="line"><span style="color:#85E89D;">      dependIds</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;blue-test-service&quot;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#85E89D;">      spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">        ingressClassName</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nginx</span></span>
<span class="line"><span style="color:#85E89D;">        rules</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">          - </span><span style="color:#85E89D;">host</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}-blue.test.example.com&quot;</span></span>
<span class="line"><span style="color:#85E89D;">            http</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">              paths</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">                - </span><span style="color:#85E89D;">path</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">/</span></span>
<span class="line"><span style="color:#85E89D;">                  pathType</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Prefix</span></span>
<span class="line"><span style="color:#85E89D;">                  backend</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">                    service</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">                      name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}-blue-test&quot;</span></span>
<span class="line"><span style="color:#85E89D;">                      port</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">                        number</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">80</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">green-test-ingress</span></span>
<span class="line"><span style="color:#85E89D;">      nameTemplate</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}-green-test&quot;</span></span>
<span class="line"><span style="color:#85E89D;">      dependIds</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;green-test-service&quot;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#85E89D;">      spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">        ingressClassName</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nginx</span></span>
<span class="line"><span style="color:#85E89D;">        rules</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">          - </span><span style="color:#85E89D;">host</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}-green.test.example.com&quot;</span></span>
<span class="line"><span style="color:#85E89D;">            http</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">              paths</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">                - </span><span style="color:#85E89D;">path</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">/</span></span>
<span class="line"><span style="color:#85E89D;">                  pathType</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Prefix</span></span>
<span class="line"><span style="color:#85E89D;">                  backend</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">                    service</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">                      name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}-green-test&quot;</span></span>
<span class="line"><span style="color:#85E89D;">                      port</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">                        number</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">80</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br></div></div><h2 id="deployment-workflow" tabindex="-1">Deployment Workflow <a class="header-anchor" href="#deployment-workflow" aria-label="Permalink to &quot;Deployment Workflow&quot;">​</a></h2><h3 id="step-1-deploy-to-inactive-environment" tabindex="-1">Step 1: Deploy to Inactive Environment <a class="header-anchor" href="#step-1-deploy-to-inactive-environment" aria-label="Permalink to &quot;Step 1: Deploy to Inactive Environment&quot;">​</a></h3><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">-- Current state: blue is active with v1.0.0</span></span>
<span class="line"><span style="color:#6A737D;">-- Deploy v2.0.0 to green (inactive)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">UPDATE</span><span style="color:#E1E4E8;"> tenants</span></span>
<span class="line"><span style="color:#F97583;">SET</span><span style="color:#E1E4E8;"> green_version </span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;"> &#39;v2.0.0&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    deployment_status </span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;"> &#39;deploying&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    last_deployment_at </span><span style="color:#F97583;">=</span><span style="color:#F97583;"> NOW</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#F97583;">WHERE</span><span style="color:#E1E4E8;"> tenant_id </span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;"> &#39;acme-corp&#39;</span><span style="color:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>Tenant Operator automatically updates green deployment with new version.</p><h3 id="step-2-test-inactive-environment" tabindex="-1">Step 2: Test Inactive Environment <a class="header-anchor" href="#step-2-test-inactive-environment" aria-label="Permalink to &quot;Step 2: Test Inactive Environment&quot;">​</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Smoke test against green environment</span></span>
<span class="line"><span style="color:#B392F0;">curl</span><span style="color:#9ECBFF;"> https://acme-corp-green.test.example.com/healthz</span></span>
<span class="line"><span style="color:#B392F0;">curl</span><span style="color:#9ECBFF;"> https://acme-corp-green.test.example.com/api/test</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Run integration tests</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> run</span><span style="color:#9ECBFF;"> test-runner</span><span style="color:#79B8FF;"> --rm</span><span style="color:#79B8FF;"> -it</span><span style="color:#79B8FF;"> --image=curlimages/curl</span><span style="color:#79B8FF;"> --</span><span style="color:#79B8FF;"> \</span></span>
<span class="line"><span style="color:#9ECBFF;">  curl</span><span style="color:#79B8FF;"> -f</span><span style="color:#9ECBFF;"> https://acme-corp-green.test.example.com/api/comprehensive-test</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="step-3-switch-traffic-blue-→-green" tabindex="-1">Step 3: Switch Traffic (Blue → Green) <a class="header-anchor" href="#step-3-switch-traffic-blue-→-green" aria-label="Permalink to &quot;Step 3: Switch Traffic (Blue → Green)&quot;">​</a></h3><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">-- Switch active environment</span></span>
<span class="line"><span style="color:#F97583;">UPDATE</span><span style="color:#E1E4E8;"> tenants</span></span>
<span class="line"><span style="color:#F97583;">SET</span><span style="color:#E1E4E8;"> active_color </span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;"> &#39;green&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    deployment_status </span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;"> &#39;stable&#39;</span></span>
<span class="line"><span style="color:#F97583;">WHERE</span><span style="color:#E1E4E8;"> tenant_id </span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;"> &#39;acme-corp&#39;</span><span style="color:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Tenant Operator updates Service selector from <code>color: blue</code> to <code>color: green</code>. Traffic instantly switches.</p><h3 id="step-4-rollback-if-needed" tabindex="-1">Step 4: Rollback (if needed) <a class="header-anchor" href="#step-4-rollback-if-needed" aria-label="Permalink to &quot;Step 4: Rollback (if needed)&quot;">​</a></h3><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">-- Instant rollback by switching back</span></span>
<span class="line"><span style="color:#F97583;">UPDATE</span><span style="color:#E1E4E8;"> tenants</span></span>
<span class="line"><span style="color:#F97583;">SET</span><span style="color:#E1E4E8;"> active_color </span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;"> &#39;blue&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    deployment_status </span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;"> &#39;rolled-back&#39;</span></span>
<span class="line"><span style="color:#F97583;">WHERE</span><span style="color:#E1E4E8;"> tenant_id </span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;"> &#39;acme-corp&#39;</span><span style="color:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="step-5-cleanup-old-version" tabindex="-1">Step 5: Cleanup Old Version <a class="header-anchor" href="#step-5-cleanup-old-version" aria-label="Permalink to &quot;Step 5: Cleanup Old Version&quot;">​</a></h3><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">-- After confirming green is stable, update blue to match</span></span>
<span class="line"><span style="color:#F97583;">UPDATE</span><span style="color:#E1E4E8;"> tenants</span></span>
<span class="line"><span style="color:#F97583;">SET</span><span style="color:#E1E4E8;"> blue_version </span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;"> &#39;v2.0.0&#39;</span></span>
<span class="line"><span style="color:#F97583;">WHERE</span><span style="color:#E1E4E8;"> tenant_id </span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;"> &#39;acme-corp&#39;</span><span style="color:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="monitoring" tabindex="-1">Monitoring <a class="header-anchor" href="#monitoring" aria-label="Permalink to &quot;Monitoring&quot;">​</a></h2><div class="language-promql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">promql</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span># Track active deployment color per tenant</span></span>
<span class="line"><span>tenant_deployment_color{tenant=&quot;acme-corp&quot;} == 1  # 1=blue, 2=green</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Monitor deployment status</span></span>
<span class="line"><span>tenant_deployment_status{status=&quot;deploying&quot;}</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Alert on prolonged deployment</span></span>
<span class="line"><span>ALERT DeploymentStuck</span></span>
<span class="line"><span>  FOR 30m</span></span>
<span class="line"><span>  WHERE tenant_deployment_status{status=&quot;deploying&quot;} == 1</span></span>
<span class="line"><span>  ANNOTATIONS {</span></span>
<span class="line"><span>    summary = &quot;Deployment stuck for tenant {{ $labels.tenant }}&quot;</span></span>
<span class="line"><span>  }</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="benefits" tabindex="-1">Benefits <a class="header-anchor" href="#benefits" aria-label="Permalink to &quot;Benefits&quot;">​</a></h2><ol><li><strong>Zero Downtime</strong>: Instant traffic switch between environments</li><li><strong>Safe Testing</strong>: Validate new version before exposing to users</li><li><strong>Instant Rollback</strong>: Switch back to previous version in seconds</li><li><strong>Resource Efficiency</strong>: Inactive environment can run with minimal replicas</li><li><strong>Database-Driven</strong>: All orchestration via database updates</li></ol><h2 id="limitations" tabindex="-1">Limitations <a class="header-anchor" href="#limitations" aria-label="Permalink to &quot;Limitations&quot;">​</a></h2><ol><li><strong>Resource Cost</strong>: Requires running two environments (though inactive can be scaled down)</li><li><strong>Database Compatibility</strong>: Schema changes must be backward compatible during transition</li><li><strong>State Management</strong>: Stateful applications require careful session handling</li><li><strong>Cost</strong>: Double resource usage during active deployment periods</li></ol><h2 id="related-documentation" tabindex="-1">Related Documentation <a class="header-anchor" href="#related-documentation" aria-label="Permalink to &quot;Related Documentation&quot;">​</a></h2><ul><li><a href="/templates.html">Templates Guide</a> - Template syntax and conditionals</li><li><a href="/policies.html">Policies</a> - Resource lifecycle management</li><li><a href="/monitoring.html">Monitoring</a> - Metrics and alerting</li><li><a href="/advanced-use-cases.html">Advanced Use Cases</a> - Other deployment patterns</li></ul><h2 id="next-steps" tabindex="-1">Next Steps <a class="header-anchor" href="#next-steps" aria-label="Permalink to &quot;Next Steps&quot;">​</a></h2><ul><li>Implement automated smoke tests</li><li>Set up deployment pipeline</li><li>Configure monitoring and alerts</li><li>Test rollback procedures</li></ul></div></div></main><footer class="VPDocFooter" data-v-e6f2a212 data-v-1bcd8184><!--[--><!--]--><div class="edit-info" data-v-1bcd8184><div class="edit-link" data-v-1bcd8184><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/kubernetes-tenants/tenant-operator/edit/main/docs/use-case-blue-green.md" target="_blank" rel="noreferrer" data-v-1bcd8184><!--[--><span class="vpi-square-pen edit-link-icon" data-v-1bcd8184></span> Edit this page on GitHub<!--]--></a></div><div class="last-updated" data-v-1bcd8184><p class="VPLastUpdated" data-v-1bcd8184 data-v-1bb0c8a8>Updated at: <time datetime="2025-11-11T08:46:40.000Z" data-v-1bb0c8a8></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-1bcd8184><span class="visually-hidden" id="doc-footer-aria-label" data-v-1bcd8184>Pager</span><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link prev" href="/use-case-multi-tier.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Previous page</span><span class="title" data-v-1bcd8184>Multi-Tier Stack</span><!--]--></a></div><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link next" href="/use-case-database-per-tenant.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Next page</span><span class="title" data-v-1bcd8184>Database-per-Tenant</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-d8b57b2d data-v-566314d4><div class="container" data-v-566314d4><p class="message" data-v-566314d4><p style="margin-bottom: 12px">Released under the Apache 2.0 License.<br />Built with ❤️ using Kubebuilder, Controller-Runtime, and VitePress.</p></p><p class="copyright" data-v-566314d4>Copyright © 2025 Tenant Operator</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"advanced-use-cases.md\":\"Dc34Yvji\",\"alert-runbooks.md\":\"CnTWfUt3\",\"api.md\":\"DLf2SzGa\",\"architecture.md\":\"sxCuNj6c\",\"configuration.md\":\"ChdTY7kX\",\"contributing-datasource.md\":\"Dp9CUW43\",\"datasource.md\":\"i_SaRwRQ\",\"dependencies.md\":\"UmtYv7Hp\",\"development.md\":\"CNTKdKAm\",\"field-ignore.md\":\"Dt_71hx0\",\"glossary.md\":\"DKqwK_s5\",\"index.md\":\"BBzw8b4h\",\"installation.md\":\"pd30phCK\",\"integration-argocd.md\":\"DE6uuxSS\",\"integration-crossplane.md\":\"p6PQ9EnX\",\"integration-external-dns.md\":\"PjgmB-23\",\"integration-terraform-operator.md\":\"dzO-lzH2\",\"local-development-minikube.md\":\"DzBh2PIa\",\"monitoring.md\":\"DczZD4F3\",\"performance.md\":\"Cx1ChqTo\",\"policies-examples.md\":\"DDGFpccr\",\"policies.md\":\"nNk6ROuY\",\"prometheus-queries.md\":\"QXITLbpq\",\"quickstart.md\":\"CkR3smRF\",\"roadmap.md\":\"CGejDhYo\",\"security.md\":\"BxTc_Slz\",\"templates.md\":\"Dgb4A48x\",\"troubleshooting.md\":\"BwJZ7js4\",\"use-case-blue-green.md\":\"2_nGobwB\",\"use-case-custom-domains.md\":\"FynuPdCj\",\"use-case-database-per-tenant.md\":\"B3RsAxfr\",\"use-case-feature-flags.md\":\"C0nzPIgj\",\"use-case-multi-tier.md\":\"BLKRyrul\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Tenant Operator\",\"description\":\"Database-Driven Kubernetes Automation / Multi-Tenant Kubernetes Automation Platform\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":\"force-dark\",\"themeConfig\":{\"logo\":\"/logo.png\",\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Quick Start\",\"link\":\"/quickstart\"},{\"text\":\"Documentation\",\"link\":\"/architecture\"},{\"text\":\"API\",\"link\":\"/api\"}],\"sidebar\":[{\"text\":\"Getting Started\",\"collapsed\":false,\"items\":[{\"text\":\"Installation\",\"link\":\"/installation\"},{\"text\":\"Quick Start\",\"link\":\"/quickstart\"}]},{\"text\":\"Core Concepts\",\"collapsed\":false,\"items\":[{\"text\":\"Architecture\",\"link\":\"/architecture\"},{\"text\":\"API Reference\",\"link\":\"/api\"},{\"text\":\"Configuration\",\"link\":\"/configuration\"},{\"text\":\"Datasources\",\"link\":\"/datasource\"},{\"text\":\"Templates\",\"link\":\"/templates\"},{\"text\":\"Dependencies\",\"link\":\"/dependencies\"},{\"text\":\"Policies\",\"collapsed\":false,\"items\":[{\"text\":\"Overview\",\"link\":\"/policies\"},{\"text\":\"Examples\",\"link\":\"/policies-examples\"},{\"text\":\"Field-Level Ignore\",\"link\":\"/field-ignore\"}]}]},{\"text\":\"Advanced Use Cases\",\"collapsed\":false,\"items\":[{\"text\":\"Overview\",\"link\":\"/advanced-use-cases\"},{\"text\":\"Custom Domains\",\"link\":\"/use-case-custom-domains\"},{\"text\":\"Multi-Tier Stack\",\"link\":\"/use-case-multi-tier\"},{\"text\":\"Blue-Green Deployments\",\"link\":\"/use-case-blue-green\"},{\"text\":\"Database-per-Tenant\",\"link\":\"/use-case-database-per-tenant\"},{\"text\":\"Feature Flags\",\"link\":\"/use-case-feature-flags\"}]},{\"text\":\"Operations\",\"collapsed\":false,\"items\":[{\"text\":\"Monitoring & Observability\",\"link\":\"/monitoring\"},{\"text\":\"Prometheus Queries\",\"link\":\"/prometheus-queries\"},{\"text\":\"Performance Tuning\",\"link\":\"/performance\"},{\"text\":\"Security\",\"link\":\"/security\"},{\"text\":\"Troubleshooting\",\"link\":\"/troubleshooting\"},{\"text\":\"Alert Runbooks\",\"link\":\"/alert-runbooks\"}]},{\"text\":\"Integrations\",\"collapsed\":false,\"items\":[{\"text\":\"Crossplane (Recommended)\",\"link\":\"/integration-crossplane\"},{\"text\":\"External DNS (Recommended)\",\"link\":\"/integration-external-dns\"},{\"text\":\"Terraform Operator\",\"link\":\"/integration-terraform-operator\"},{\"text\":\"Argo CD\",\"link\":\"/integration-argocd\"}]},{\"text\":\"Development\",\"collapsed\":false,\"items\":[{\"text\":\"Local Development\",\"link\":\"/local-development-minikube\"},{\"text\":\"Development Guide\",\"link\":\"/development\"},{\"text\":\"Contributing\",\"link\":\"/contributing-datasource\"},{\"text\":\"Roadmap\",\"link\":\"/roadmap\"}]},{\"text\":\"Glossary\",\"link\":\"/glossary\"}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/kubernetes-tenants/tenant-operator\"}],\"search\":{\"provider\":\"local\"},\"footer\":{\"message\":\"<p style=\\\"margin-bottom: 12px\\\">Released under the Apache 2.0 License.<br />Built with ❤️ using Kubebuilder, Controller-Runtime, and VitePress.</p>\",\"copyright\":\"Copyright © 2025 Tenant Operator\"},\"editLink\":{\"pattern\":\"https://github.com/kubernetes-tenants/tenant-operator/edit/main/docs/:path\",\"text\":\"Edit this page on GitHub\"},\"lastUpdated\":{\"text\":\"Updated at\",\"formatOptions\":{\"dateStyle\":\"full\",\"timeStyle\":\"medium\"}}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>