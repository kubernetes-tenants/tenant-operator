import{_ as f,p as E,aa as q,h as C,v as k,x as D,c as t,o as r,j as n,n as o,e as d,a3 as y,a as i,t as b,G as B}from"./chunks/framework.DddEBHwx.js";const x={class:"scene-container"},w={class:"yaml-box"},A={class:"box-header"},P={key:0,class:"status-badge updated"},S={class:"yaml-content"},_={class:"value-animated"},I={key:0,class:"badge-label green"},T={key:1,class:"badge-label orange"},R={class:"yaml-box"},N={class:"box-header"},$={key:0,class:"status-badge updated"},O={class:"yaml-content"},V={key:0,class:"skip-icon"},W={class:"value-animated"},M={class:"yaml-box"},U={class:"box-header"},L={key:0,class:"status-badge success"},H={class:"yaml-content"},J={class:"value-animated"},j={key:0,class:"badge-special hpa"},G={class:"value-animated"},z={key:0,class:"badge-special synced"},K={__name:"FieldIgnoreAnimation",setup(v){const m=E(null),a=E(0),l=E(""),g=E(!1),p=q({templateImage:"1.20",lynqnodeImage:"1.20",deploymentImage:"1.20",deploymentReplicas:3}),c=C(()=>a.value===1?"lynqform":a.value===2||a.value===3?null:a.value===4?"deployment":a.value===5?"lynqform":a.value===6||a.value===7?"lynqnode":a.value===8||a.value===9?null:a.value>=10?"deployment":null),h=async()=>{const e=s=>new Promise(F=>setTimeout(F,s));a.value=1,l.value="LynqForm defines template with ignoreFields",await e(2500),a.value=2,l.value="Template renders to LynqNode",await e(2500),a.value=3,p.deploymentReplicas=3,p.deploymentImage="1.20",l.value="Initial Creation: All fields applied",await e(2500),a.value=4,await e(800),p.deploymentReplicas=5,l.value="HPA scales replicas: 3 ‚Üí 5 (ignored field)",await e(2500),a.value=5,await e(800),p.templateImage="1.21",l.value="Template updated: nginx:1.20 ‚Üí 1.21",await e(2500),a.value=6,l.value="Update propagating to LynqNode...",await e(1e3),a.value=7,p.lynqnodeImage="1.21",l.value="LynqNode spec updated",await e(2500),a.value=8,l.value="Reconciliation starts...",await e(1500),a.value=9,l.value="ignoreFields filters $.spec.replicas",await e(2500),a.value=10,l.value="Applying changes to Deployment...",await e(1e3),a.value=11,p.deploymentImage="1.21",l.value="Result: replicas ignored, image synced",await e(3e3),a.value=12,l.value="ignoreFields skips specified fields during sync",await e(2500),l.value="",await e(500),a.value=0,p.templateImage="1.20",p.lynqnodeImage="1.20",p.deploymentImage="1.20",p.deploymentReplicas=3,await e(1e3),h()};let u=null;return k(()=>{u=new IntersectionObserver(e=>{e[0].isIntersecting&&!g.value&&(g.value=!0,h(),u.disconnect())},{threshold:.3}),m.value&&u.observe(m.value)}),D(()=>{u&&u.disconnect()}),(e,s)=>(r(),t("div",{ref_key:"containerRef",ref:m,class:"field-ignore-animation"},[n("div",x,[n("div",{class:o(["box-wrapper",{focused:c.value==="lynqform",dimmed:c.value&&c.value!=="lynqform",visible:a.value>=1}])},[n("div",w,[n("div",A,[s[0]||(s[0]=n("span",{class:"box-title"},"LynqForm",-1)),a.value>=5?(r(),t("span",P,"Updated")):d("",!0)]),n("div",S,[s[6]||(s[6]=y('<div class="yaml-line" data-v-6b7f0189><span class="key" data-v-6b7f0189>deployments</span><span class="punctuation" data-v-6b7f0189>:</span></div><div class="yaml-line indent-1" data-v-6b7f0189><span class="punctuation" data-v-6b7f0189>-</span> <span class="key" data-v-6b7f0189>id</span><span class="punctuation" data-v-6b7f0189>:</span> <span class="value" data-v-6b7f0189>app</span></div><div class="yaml-line indent-2 highlight-yellow" data-v-6b7f0189><span class="key" data-v-6b7f0189>ignoreFields</span><span class="punctuation" data-v-6b7f0189>:</span></div><div class="yaml-line indent-3 highlight-yellow" data-v-6b7f0189><span class="punctuation" data-v-6b7f0189>-</span> <span class="string" data-v-6b7f0189>&quot;$.spec.replicas&quot;</span><span class="lock-icon" data-v-6b7f0189>üîí</span></div><div class="yaml-line indent-2" data-v-6b7f0189><span class="key" data-v-6b7f0189>spec</span><span class="punctuation" data-v-6b7f0189>:</span></div><div class="yaml-line indent-3" data-v-6b7f0189><span class="key" data-v-6b7f0189>apiVersion</span><span class="punctuation" data-v-6b7f0189>:</span> <span class="value" data-v-6b7f0189>apps/v1</span></div><div class="yaml-line indent-3" data-v-6b7f0189><span class="key" data-v-6b7f0189>kind</span><span class="punctuation" data-v-6b7f0189>:</span> <span class="value" data-v-6b7f0189>Deployment</span></div><div class="yaml-line indent-3" data-v-6b7f0189><span class="key" data-v-6b7f0189>spec</span><span class="punctuation" data-v-6b7f0189>:</span></div><div class="yaml-line indent-4 highlight-gray" data-v-6b7f0189><span class="key" data-v-6b7f0189>replicas</span><span class="punctuation" data-v-6b7f0189>:</span> <span class="value" data-v-6b7f0189>3</span><span class="badge-label gray" data-v-6b7f0189>ignored</span></div><div class="yaml-line indent-4" data-v-6b7f0189><span class="key" data-v-6b7f0189>template</span><span class="punctuation" data-v-6b7f0189>:</span></div><div class="yaml-line indent-5" data-v-6b7f0189><span class="key" data-v-6b7f0189>spec</span><span class="punctuation" data-v-6b7f0189>:</span></div><div class="yaml-line indent-6" data-v-6b7f0189><span class="key" data-v-6b7f0189>containers</span><span class="punctuation" data-v-6b7f0189>:</span></div>',12)),n("div",{class:o(["yaml-line indent-7",{"highlight-green":a.value>=1&&a.value<5,"highlight-orange pulse-highlight":a.value===5}])},[s[1]||(s[1]=n("span",{class:"punctuation"},"-",-1)),s[2]||(s[2]=i()),s[3]||(s[3]=n("span",{class:"key"},"image",-1)),s[4]||(s[4]=n("span",{class:"punctuation"},":",-1)),s[5]||(s[5]=i()),n("span",_,b(p.templateImage),1),a.value<5?(r(),t("span",I,"managed")):d("",!0),a.value>=5?(r(),t("span",T,"updated")):d("",!0)],2)])])],2),n("div",{class:o(["box-wrapper",{focused:c.value==="lynqnode",dimmed:c.value&&c.value!=="lynqnode",visible:a.value>=2}])},[n("div",R,[n("div",N,[s[7]||(s[7]=n("span",{class:"box-title"},"LynqNode",-1)),a.value>=7?(r(),t("span",$,"Updated")):d("",!0)]),n("div",O,[s[17]||(s[17]=y('<div class="yaml-line" data-v-6b7f0189><span class="key" data-v-6b7f0189>spec</span><span class="punctuation" data-v-6b7f0189>:</span></div><div class="yaml-line indent-1" data-v-6b7f0189><span class="key" data-v-6b7f0189>deployments</span><span class="punctuation" data-v-6b7f0189>:</span></div><div class="yaml-line indent-2" data-v-6b7f0189><span class="punctuation" data-v-6b7f0189>-</span> <span class="key" data-v-6b7f0189>id</span><span class="punctuation" data-v-6b7f0189>:</span> <span class="value" data-v-6b7f0189>app</span></div>',3)),n("div",{class:o(["yaml-line indent-3 highlight-yellow",{"pulse-highlight":a.value===9}])},[...s[8]||(s[8]=[n("span",{class:"key"},"ignoreFields",-1),n("span",{class:"punctuation"},":",-1)])],2),n("div",{class:o(["yaml-line indent-4 highlight-yellow",{"pulse-highlight":a.value===9}])},[s[9]||(s[9]=n("span",{class:"punctuation"},"-",-1)),s[10]||(s[10]=i()),s[11]||(s[11]=n("span",{class:"string"},'"$.spec.replicas"',-1)),n("span",{class:o(["lock-icon",{shake:a.value===9}])},"üîí",2),a.value===9?(r(),t("span",V,"‚è≠Ô∏è")):d("",!0)],2),s[18]||(s[18]=y('<div class="yaml-line indent-3" data-v-6b7f0189><span class="key" data-v-6b7f0189>spec</span><span class="punctuation" data-v-6b7f0189>:</span></div><div class="yaml-line indent-4" data-v-6b7f0189><span class="key" data-v-6b7f0189>replicas</span><span class="punctuation" data-v-6b7f0189>:</span> <span class="value" data-v-6b7f0189>3</span><span class="badge-label gray" data-v-6b7f0189>ignored</span></div><div class="yaml-line indent-4" data-v-6b7f0189><span class="key" data-v-6b7f0189>template</span><span class="punctuation" data-v-6b7f0189>:</span></div><div class="yaml-line indent-5" data-v-6b7f0189><span class="key" data-v-6b7f0189>spec</span><span class="punctuation" data-v-6b7f0189>:</span></div><div class="yaml-line indent-6" data-v-6b7f0189><span class="key" data-v-6b7f0189>containers</span><span class="punctuation" data-v-6b7f0189>:</span></div>',5)),n("div",{class:o(["yaml-line indent-7",{"highlight-orange pulse-highlight":a.value===7}])},[s[12]||(s[12]=n("span",{class:"punctuation"},"-",-1)),s[13]||(s[13]=i()),s[14]||(s[14]=n("span",{class:"key"},"image",-1)),s[15]||(s[15]=n("span",{class:"punctuation"},":",-1)),s[16]||(s[16]=i()),n("span",W,b(p.lynqnodeImage),1)],2)])])],2),n("div",{class:o(["box-wrapper",{focused:c.value==="deployment",dimmed:c.value&&c.value!=="deployment",visible:a.value>=3}])},[n("div",M,[n("div",U,[s[19]||(s[19]=n("span",{class:"box-title"},"Deployment",-1)),a.value>=11?(r(),t("span",L,"Synced")):d("",!0)]),n("div",H,[s[29]||(s[29]=n("div",{class:"yaml-line"},[n("span",{class:"key"},"spec"),n("span",{class:"punctuation"},":")],-1)),n("div",{class:o(["yaml-line indent-1 highlight-gray",{"pulse-highlight":a.value===4||a.value===11}])},[s[20]||(s[20]=n("span",{class:"key"},"replicas",-1)),s[21]||(s[21]=n("span",{class:"punctuation"},":",-1)),s[22]||(s[22]=i()),n("span",J,b(p.deploymentReplicas),1),n("span",{class:o(["lock-icon",{shake:a.value===11||a.value===12}])},"üîí",2),s[23]||(s[23]=n("span",{class:"badge-label gray"},"ignored",-1)),a.value===4?(r(),t("span",j,"‚öñÔ∏è HPA")):d("",!0)],2),s[30]||(s[30]=y('<div class="yaml-line indent-1" data-v-6b7f0189><span class="key" data-v-6b7f0189>template</span><span class="punctuation" data-v-6b7f0189>:</span></div><div class="yaml-line indent-2" data-v-6b7f0189><span class="key" data-v-6b7f0189>spec</span><span class="punctuation" data-v-6b7f0189>:</span></div><div class="yaml-line indent-3" data-v-6b7f0189><span class="key" data-v-6b7f0189>containers</span><span class="punctuation" data-v-6b7f0189>:</span></div>',3)),n("div",{class:o(["yaml-line indent-4",{"highlight-green pulse-highlight":a.value===11}])},[s[24]||(s[24]=n("span",{class:"punctuation"},"-",-1)),s[25]||(s[25]=i()),s[26]||(s[26]=n("span",{class:"key"},"image",-1)),s[27]||(s[27]=n("span",{class:"punctuation"},":",-1)),s[28]||(s[28]=i()),n("span",G,b(p.deploymentImage),1),a.value>=11?(r(),t("span",z,"‚úì Synced")):d("",!0)],2)])])],2)]),n("div",{class:o(["status-bar",{show:l.value}])},b(l.value),3)],512))}},Y=f(K,[["__scopeId","data-v-6b7f0189"]]),Z=JSON.parse('{"title":"Field-Level Ignore Control","description":"","frontmatter":{},"headers":[],"relativePath":"field-ignore.md","filePath":"field-ignore.md","lastUpdated":1763433669000}'),Q={name:"field-ignore.md"},ss=Object.assign(Q,{setup(v){return(m,a)=>(r(),t("div",null,[a[0]||(a[0]=n("h1",{id:"field-level-ignore-control",tabindex:"-1"},[i("Field-Level Ignore Control "),n("a",{class:"header-anchor",href:"#field-level-ignore-control","aria-label":'Permalink to "Field-Level Ignore Control"'},"‚Äã")],-1)),a[1]||(a[1]=n("h2",{id:"overview",tabindex:"-1"},[i("Overview "),n("a",{class:"header-anchor",href:"#overview","aria-label":'Permalink to "Overview"'},"‚Äã")],-1)),a[2]||(a[2]=n("p",null,[i("The "),n("code",null,"ignoreFields"),i(" feature provides fine-grained control over which fields should be excluded from synchronization. This allows you to manage most resource fields declaratively through templates while letting specific fields be controlled externally (e.g., by HPA, manual scaling, or other operators).")],-1)),B(Y),a[3]||(a[3]=y(`<h2 id="problem-statement" tabindex="-1">Problem Statement <a class="header-anchor" href="#problem-statement" aria-label="Permalink to &quot;Problem Statement&quot;">‚Äã</a></h2><p>Standard <code>CreationPolicy</code> options are too coarse-grained:</p><ul><li><strong><code>Once</code></strong>: Creates resource once, never syncs any fields (all-or-nothing)</li><li><strong><code>WhenNeeded</code></strong> (default): Continuously syncs all fields</li></ul><p><strong>Real-world scenario</strong>: You want HPA to dynamically control <code>spec.replicas</code>, but still want the operator to manage container images, environment variables, and other configuration.</p><h2 id="solution-selective-field-ignoring" tabindex="-1">Solution: Selective Field Ignoring <a class="header-anchor" href="#solution-selective-field-ignoring" aria-label="Permalink to &quot;Solution: Selective Field Ignoring&quot;">‚Äã</a></h2><p>The <code>ignoreFields</code> array accepts <strong>standard JSONPath expressions</strong> to specify which fields should be excluded from synchronization.</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">operator.lynq.sh/v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">LynqForm</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">  deployments</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">web-app</span></span>
<span class="line"><span style="color:#85E89D;">      creationPolicy</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">WhenNeeded</span><span style="color:#6A737D;">  # Default - continues syncing</span></span>
<span class="line"><span style="color:#85E89D;">      ignoreFields</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#9ECBFF;">&quot;$.spec.replicas&quot;</span><span style="color:#6A737D;">  # Let HPA control this</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#9ECBFF;">&quot;$.spec.template.spec.containers[0].resources&quot;</span><span style="color:#6A737D;">  # Allow manual tuning</span></span>
<span class="line"><span style="color:#85E89D;">      spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">        apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">apps/v1</span></span>
<span class="line"><span style="color:#85E89D;">        kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Deployment</span></span>
<span class="line"><span style="color:#85E89D;">        metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">          name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}-web&quot;</span></span>
<span class="line"><span style="color:#85E89D;">        spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">          replicas</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">3</span><span style="color:#6A737D;">  # Initial value, then ignored</span></span>
<span class="line"><span style="color:#85E89D;">          template</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">            spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">              containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">                - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">app</span></span>
<span class="line"><span style="color:#85E89D;">                  image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;nginx:{{ .version }}&quot;</span><span style="color:#6A737D;">  # Continues to sync</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="how-it-works" tabindex="-1">How It Works <a class="header-anchor" href="#how-it-works" aria-label="Permalink to &quot;How It Works&quot;">‚Äã</a></h2><h3 id="initial-creation" tabindex="-1">Initial Creation <a class="header-anchor" href="#initial-creation" aria-label="Permalink to &quot;Initial Creation&quot;">‚Äã</a></h3><p>When a resource is <strong>first created</strong>:</p><ol><li>‚úÖ All fields (including ignored ones) are applied</li><li>‚úÖ Resource created with complete specification</li></ol><h3 id="subsequent-reconciliations" tabindex="-1">Subsequent Reconciliations <a class="header-anchor" href="#subsequent-reconciliations" aria-label="Permalink to &quot;Subsequent Reconciliations&quot;">‚Äã</a></h3><p>When the resource <strong>already exists</strong>:</p><ol><li>üîç Operator detects resource exists</li><li>üóëÔ∏è Removes ignored fields from desired state</li><li>‚úÖ Applies only non-ignored fields via SSA</li><li>‚ú® <strong>Result</strong>: Ignored fields preserve cluster values, others sync to template</li></ol><h2 id="example-scenario" tabindex="-1">Example Scenario <a class="header-anchor" href="#example-scenario" aria-label="Permalink to &quot;Example Scenario&quot;">‚Äã</a></h2><h3 id="step-1-initial-deployment" tabindex="-1">Step 1: Initial Deployment <a class="header-anchor" href="#step-1-initial-deployment" aria-label="Permalink to &quot;Step 1: Initial Deployment&quot;">‚Äã</a></h3><p><strong>Template</strong>:</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">ignoreFields</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;$.spec.replicas&quot;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">  replicas</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">3</span></span>
<span class="line"><span style="color:#85E89D;">  template</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">    spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">      containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">app</span></span>
<span class="line"><span style="color:#85E89D;">          image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nginx:1.20</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>Result</strong>: Deployment created with <code>replicas: 3</code>, <code>image: nginx:1.20</code></p><h3 id="step-2-hpa-scales-up" tabindex="-1">Step 2: HPA Scales Up <a class="header-anchor" href="#step-2-hpa-scales-up" aria-label="Permalink to &quot;Step 2: HPA Scales Up&quot;">‚Äã</a></h3><p>HPA scales deployment to <code>replicas: 5</code></p><h3 id="step-3-template-update" tabindex="-1">Step 3: Template Update <a class="header-anchor" href="#step-3-template-update" aria-label="Permalink to &quot;Step 3: Template Update&quot;">‚Äã</a></h3><p><strong>Template updated</strong>:</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">ignoreFields</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;$.spec.replicas&quot;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">  replicas</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">3</span><span style="color:#6A737D;">  # Template still shows 3</span></span>
<span class="line"><span style="color:#85E89D;">  template</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">    spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">      containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">app</span></span>
<span class="line"><span style="color:#85E89D;">          image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nginx:1.21</span><span style="color:#6A737D;">  # Image updated</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="step-4-reconciliation" tabindex="-1">Step 4: Reconciliation <a class="header-anchor" href="#step-4-reconciliation" aria-label="Permalink to &quot;Step 4: Reconciliation&quot;">‚Äã</a></h3><ol><li>Cluster state: <code>replicas: 5</code>, <code>image: nginx:1.20</code></li><li>Desired state: <code>replicas: 3</code>, <code>image: nginx:1.21</code></li><li>Operator removes <code>replicas</code> from desired state</li><li>Operator applies: <code>image: nginx:1.21</code> only</li></ol><p><strong>Final Result</strong>:</p><ul><li>‚úÖ <code>replicas: 5</code> (preserved - HPA in control)</li><li>‚úÖ <code>image: nginx:1.21</code> (synced - operator in control)</li></ul><h2 id="supported-jsonpath-expressions" tabindex="-1">Supported JSONPath Expressions <a class="header-anchor" href="#supported-jsonpath-expressions" aria-label="Permalink to &quot;Supported JSONPath Expressions&quot;">‚Äã</a></h2><p>This feature uses the <a href="https://github.com/ohler55/ojg" target="_blank" rel="noreferrer">ojg/jp</a> library, providing <strong>complete JSONPath standard support</strong>.</p><h3 id="basic-path-navigation" tabindex="-1">Basic Path Navigation <a class="header-anchor" href="#basic-path-navigation" aria-label="Permalink to &quot;Basic Path Navigation&quot;">‚Äã</a></h3><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">ignoreFields</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#6A737D;">  # Simple field</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#9ECBFF;">&quot;$.spec.replicas&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">  # Nested field</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#9ECBFF;">&quot;$.spec.template.spec.securityContext&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">  # Deeply nested field</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#9ECBFF;">&quot;$.spec.template.spec.containers[0].image&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="array-element-access" tabindex="-1">Array Element Access <a class="header-anchor" href="#array-element-access" aria-label="Permalink to &quot;Array Element Access&quot;">‚Äã</a></h3><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">ignoreFields</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#6A737D;">  # First container&#39;s image</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#9ECBFF;">&quot;$.spec.template.spec.containers[0].image&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">  # Second container&#39;s resources</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#9ECBFF;">&quot;$.spec.template.spec.containers[1].resources&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">  # Init container resources</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#9ECBFF;">&quot;$.spec.template.spec.initContainers[0].resources&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="wildcard-support" tabindex="-1">Wildcard Support <a class="header-anchor" href="#wildcard-support" aria-label="Permalink to &quot;Wildcard Support&quot;">‚Äã</a></h3><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">ignoreFields</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#6A737D;">  # All containers&#39; images</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#9ECBFF;">&quot;$.spec.template.spec.containers[*].image&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">  # All containers&#39; environment variables</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#9ECBFF;">&quot;$.spec.template.spec.containers[*].env&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">  # All init containers&#39; resources</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#9ECBFF;">&quot;$.spec.template.spec.initContainers[*].resources&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="map-keys-with-special-characters" tabindex="-1">Map Keys with Special Characters <a class="header-anchor" href="#map-keys-with-special-characters" aria-label="Permalink to &quot;Map Keys with Special Characters&quot;">‚Äã</a></h3><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">ignoreFields</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#6A737D;">  # Annotation with dots and slashes</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#9ECBFF;">&quot;$.metadata.annotations[&#39;app.kubernetes.io/version&#39;]&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">  # Label with special chars</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#9ECBFF;">&quot;$.metadata.labels[&#39;app.kubernetes.io/managed-by&#39;]&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">  # ConfigMap data key</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#9ECBFF;">&quot;$.data[&#39;application.properties&#39;]&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="common-use-cases" tabindex="-1">Common Use Cases <a class="header-anchor" href="#common-use-cases" aria-label="Permalink to &quot;Common Use Cases&quot;">‚Äã</a></h2><h3 id="_1-hpa-controlled-replicas" tabindex="-1">1. HPA-Controlled Replicas <a class="header-anchor" href="#_1-hpa-controlled-replicas" aria-label="Permalink to &quot;1. HPA-Controlled Replicas&quot;">‚Äã</a></h3><p>Let HPA manage scaling while operator manages configuration:</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">deployments</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">api-server</span></span>
<span class="line"><span style="color:#85E89D;">    ignoreFields</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#9ECBFF;">&quot;$.spec.replicas&quot;</span></span>
<span class="line"><span style="color:#85E89D;">    spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">      replicas</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">3</span><span style="color:#6A737D;">  # Initial/default value</span></span>
<span class="line"><span style="color:#6A737D;">      # ... rest of spec</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_2-manual-resource-tuning" tabindex="-1">2. Manual Resource Tuning <a class="header-anchor" href="#_2-manual-resource-tuning" aria-label="Permalink to &quot;2. Manual Resource Tuning&quot;">‚Äã</a></h3><p>Allow manual resource adjustments while syncing code changes:</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">deployments</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">backend</span></span>
<span class="line"><span style="color:#85E89D;">    ignoreFields</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#9ECBFF;">&quot;$.spec.template.spec.containers[0].resources&quot;</span></span>
<span class="line"><span style="color:#85E89D;">    spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">      template</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">        spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">          containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">app</span></span>
<span class="line"><span style="color:#85E89D;">              image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;backend:{{ .version }}&quot;</span><span style="color:#6A737D;">  # Syncs</span></span>
<span class="line"><span style="color:#85E89D;">              resources</span><span style="color:#E1E4E8;">:  </span><span style="color:#6A737D;"># Ignored after creation</span></span>
<span class="line"><span style="color:#85E89D;">                limits</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">                  memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;2Gi&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="_3-multiple-containers" tabindex="-1">3. Multiple Containers <a class="header-anchor" href="#_3-multiple-containers" aria-label="Permalink to &quot;3. Multiple Containers&quot;">‚Äã</a></h3><p>Different ignore policies per container:</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">deployments</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">multi-container-app</span></span>
<span class="line"><span style="color:#85E89D;">    ignoreFields</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#6A737D;">      # Main app: ignore resources</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#9ECBFF;">&quot;$.spec.template.spec.containers[0].resources&quot;</span></span>
<span class="line"><span style="color:#6A737D;">      # Sidecar: ignore image (updated separately)</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#9ECBFF;">&quot;$.spec.template.spec.containers[1].image&quot;</span></span>
<span class="line"><span style="color:#85E89D;">    spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">      template</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">        spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">          containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">app</span></span>
<span class="line"><span style="color:#85E89D;">              image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;app:latest&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">            - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">sidecar</span></span>
<span class="line"><span style="color:#85E89D;">              image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;sidecar:stable&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="_4-bulk-ignoring-with-wildcards" tabindex="-1">4. Bulk Ignoring with Wildcards <a class="header-anchor" href="#_4-bulk-ignoring-with-wildcards" aria-label="Permalink to &quot;4. Bulk Ignoring with Wildcards&quot;">‚Äã</a></h3><p>Ignore same field across all containers:</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">deployments</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">microservice</span></span>
<span class="line"><span style="color:#85E89D;">    ignoreFields</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#6A737D;">      # All containers can be manually scaled</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#9ECBFF;">&quot;$.spec.template.spec.containers[*].resources.limits&quot;</span></span>
<span class="line"><span style="color:#6A737D;">      # All containers&#39; liveness probes can be tuned</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#9ECBFF;">&quot;$.spec.template.spec.containers[*].livenessProbe&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="validation" tabindex="-1">Validation <a class="header-anchor" href="#validation" aria-label="Permalink to &quot;Validation&quot;">‚Äã</a></h2><h3 id="admission-webhook" tabindex="-1">Admission Webhook <a class="header-anchor" href="#admission-webhook" aria-label="Permalink to &quot;Admission Webhook&quot;">‚Äã</a></h3><p>JSONPath expressions are validated at admission time:</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Valid</span></span>
<span class="line"><span style="color:#B392F0;">ignoreFields:</span><span style="color:#E1E4E8;"> [</span><span style="color:#9ECBFF;">&quot;$.spec.replicas&quot;</span><span style="color:#E1E4E8;">]  ‚úÖ</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Invalid - missing $ prefix</span></span>
<span class="line"><span style="color:#B392F0;">ignoreFields:</span><span style="color:#E1E4E8;"> [</span><span style="color:#9ECBFF;">&quot;spec.replicas&quot;</span><span style="color:#E1E4E8;">]  ‚ùå</span></span>
<span class="line"><span style="color:#B392F0;">Error:</span><span style="color:#9ECBFF;"> invalid</span><span style="color:#9ECBFF;"> JSONPath</span><span style="color:#9ECBFF;"> &quot;spec.replicas&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Invalid - malformed bracket</span></span>
<span class="line"><span style="color:#B392F0;">ignoreFields:</span><span style="color:#E1E4E8;"> [</span><span style="color:#9ECBFF;">&quot;$[invalid&quot;</span><span style="color:#E1E4E8;">]  ‚ùå</span></span>
<span class="line"><span style="color:#B392F0;">Error:</span><span style="color:#9ECBFF;"> invalid</span><span style="color:#9ECBFF;"> JSONPath</span><span style="color:#9ECBFF;"> &quot;$[invalid&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="runtime-behavior" tabindex="-1">Runtime Behavior <a class="header-anchor" href="#runtime-behavior" aria-label="Permalink to &quot;Runtime Behavior&quot;">‚Äã</a></h3><ul><li><strong>Non-existent paths</strong>: Silently skipped (no error)</li><li><strong>Array out of bounds</strong>: Silently skipped (no error)</li><li><strong>Type mismatches</strong>: Silently skipped (no error)</li></ul><p>This graceful handling ensures reconciliation continues even if ignored fields don&#39;t exist.</p><h2 id="interaction-with-policies" tabindex="-1">Interaction with Policies <a class="header-anchor" href="#interaction-with-policies" aria-label="Permalink to &quot;Interaction with Policies&quot;">‚Äã</a></h2><h3 id="creationpolicy-once" tabindex="-1">CreationPolicy: Once <a class="header-anchor" href="#creationpolicy-once" aria-label="Permalink to &quot;CreationPolicy: Once&quot;">‚Äã</a></h3><p>When combined with <code>CreationPolicy: Once</code>, <code>ignoreFields</code> has <strong>no effect</strong>:</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">deployments</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">init-job</span></span>
<span class="line"><span style="color:#85E89D;">    creationPolicy</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Once</span></span>
<span class="line"><span style="color:#85E89D;">    ignoreFields</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;$.spec.replicas&quot;</span><span style="color:#E1E4E8;">]  </span><span style="color:#6A737D;"># No effect - resource never reconciled</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>Reason</strong>: <code>Once</code> policy means resource is created once and never touched again, so field-level control is irrelevant.</p><h3 id="conflictpolicy" tabindex="-1">ConflictPolicy <a class="header-anchor" href="#conflictpolicy" aria-label="Permalink to &quot;ConflictPolicy&quot;">‚Äã</a></h3><p>Ignored fields <strong>do not participate</strong> in conflict detection:</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">deployments</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">app</span></span>
<span class="line"><span style="color:#85E89D;">    conflictPolicy</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Stuck</span></span>
<span class="line"><span style="color:#85E89D;">    ignoreFields</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;$.spec.replicas&quot;</span><span style="color:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>If another controller modifies <code>replicas</code>, no conflict is detected because it&#39;s ignored.</p><h3 id="deletionpolicy" tabindex="-1">DeletionPolicy <a class="header-anchor" href="#deletionpolicy" aria-label="Permalink to &quot;DeletionPolicy&quot;">‚Äã</a></h3><p><code>ignoreFields</code> does <strong>not affect</strong> deletion behavior:</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">deployments</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">app</span></span>
<span class="line"><span style="color:#85E89D;">    deletionPolicy</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Retain</span></span>
<span class="line"><span style="color:#85E89D;">    ignoreFields</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;$.spec.replicas&quot;</span><span style="color:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>When LynqNode is deleted, deletion policy is still respected (resources retained).</p><h2 id="best-practices" tabindex="-1">Best Practices <a class="header-anchor" href="#best-practices" aria-label="Permalink to &quot;Best Practices&quot;">‚Äã</a></h2><h3 id="_1-document-why-fields-are-ignored" tabindex="-1">1. Document Why Fields Are Ignored <a class="header-anchor" href="#_1-document-why-fields-are-ignored" aria-label="Permalink to &quot;1. Document Why Fields Are Ignored&quot;">‚Äã</a></h3><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">deployments</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">api-server</span></span>
<span class="line"><span style="color:#6A737D;">    # Replicas controlled by HPA based on CPU/memory</span></span>
<span class="line"><span style="color:#85E89D;">    ignoreFields</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;$.spec.replicas&quot;</span><span style="color:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_2-use-specific-paths-over-wildcards" tabindex="-1">2. Use Specific Paths Over Wildcards <a class="header-anchor" href="#_2-use-specific-paths-over-wildcards" aria-label="Permalink to &quot;2. Use Specific Paths Over Wildcards&quot;">‚Äã</a></h3><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># ‚úÖ Good - explicit and clear</span></span>
<span class="line"><span style="color:#85E89D;">ignoreFields</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#9ECBFF;">&quot;$.spec.template.spec.containers[0].resources&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># ‚ö†Ô∏è Use with caution - affects all containers</span></span>
<span class="line"><span style="color:#85E89D;">ignoreFields</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#9ECBFF;">&quot;$.spec.template.spec.containers[*].resources&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_3-test-ignored-fields-in-staging" tabindex="-1">3. Test Ignored Fields in Staging <a class="header-anchor" href="#_3-test-ignored-fields-in-staging" aria-label="Permalink to &quot;3. Test Ignored Fields in Staging&quot;">‚Äã</a></h3><p>Before production, verify:</p><ol><li>Initial creation includes ignored fields ‚úÖ</li><li>Manual changes to ignored fields are preserved ‚úÖ</li><li>Template changes to other fields still sync ‚úÖ</li></ol><h3 id="_4-monitor-drift" tabindex="-1">4. Monitor Drift <a class="header-anchor" href="#_4-monitor-drift" aria-label="Permalink to &quot;4. Monitor Drift&quot;">‚Äã</a></h3><p>While ignored fields won&#39;t trigger reconciliation, monitor them separately:</p><div class="language-promql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">promql</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span># Alert if replicas drift significantly from template</span></span>
<span class="line"><span>abs(</span></span>
<span class="line"><span>  kube_deployment_spec_replicas -</span></span>
<span class="line"><span>  tenant_template_spec_replicas</span></span>
<span class="line"><span>) &gt; 10</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">‚Äã</a></h2><h3 id="issue-ignored-field-still-being-overwritten" tabindex="-1">Issue: Ignored Field Still Being Overwritten <a class="header-anchor" href="#issue-ignored-field-still-being-overwritten" aria-label="Permalink to &quot;Issue: Ignored Field Still Being Overwritten&quot;">‚Äã</a></h3><p><strong>Check</strong>:</p><ol><li>Is <code>creationPolicy</code> set to <code>WhenNeeded</code>? (default)</li><li>Is JSONPath expression valid?</li><li>Does path exactly match the field structure?</li></ol><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Verify JSONPath</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> get</span><span style="color:#9ECBFF;"> lynqnode</span><span style="color:#79B8FF;"> -o</span><span style="color:#9ECBFF;"> yaml</span></span>
<span class="line"><span style="color:#6A737D;"># Check ignoreFields syntax</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="issue-template-changes-not-applying" tabindex="-1">Issue: Template Changes Not Applying <a class="header-anchor" href="#issue-template-changes-not-applying" aria-label="Permalink to &quot;Issue: Template Changes Not Applying&quot;">‚Äã</a></h3><p><strong>Possible causes</strong>:</p><ol><li>Field is accidentally in <code>ignoreFields</code></li><li>Wrong JSONPath (typo in path)</li></ol><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Wrong</span></span>
<span class="line"><span style="color:#85E89D;">ignoreFields</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;$.spec.template.spec.container[0].image&quot;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#6A737D;">                                          # ^^^ missing &#39;s&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Correct</span></span>
<span class="line"><span style="color:#85E89D;">ignoreFields</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;$.spec.template.spec.containers[0].image&quot;</span><span style="color:#E1E4E8;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="issue-validation-error-on-admission" tabindex="-1">Issue: Validation Error on Admission <a class="header-anchor" href="#issue-validation-error-on-admission" aria-label="Permalink to &quot;Issue: Validation Error on Admission&quot;">‚Äã</a></h3><p><strong>Check JSONPath syntax</strong>:</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Test JSONPath locally</span></span>
<span class="line"><span style="color:#79B8FF;">echo</span><span style="color:#9ECBFF;"> &#39;{&quot;spec&quot;:{&quot;replicas&quot;:3}}&#39;</span><span style="color:#F97583;"> |</span><span style="color:#B392F0;"> jq</span><span style="color:#9ECBFF;"> &#39;.spec.replicas&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Valid JSONPath must start with $</span></span>
<span class="line"><span style="color:#B392F0;">ignoreFields:</span><span style="color:#E1E4E8;"> [</span><span style="color:#9ECBFF;">&quot;$.spec.replicas&quot;</span><span style="color:#E1E4E8;">]  ‚úÖ</span></span>
<span class="line"><span style="color:#B392F0;">ignoreFields:</span><span style="color:#E1E4E8;"> [</span><span style="color:#9ECBFF;">&quot;spec.replicas&quot;</span><span style="color:#E1E4E8;">]    ‚ùå</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="performance-considerations" tabindex="-1">Performance Considerations <a class="header-anchor" href="#performance-considerations" aria-label="Permalink to &quot;Performance Considerations&quot;">‚Äã</a></h2><h3 id="minimal-overhead" tabindex="-1">Minimal Overhead <a class="header-anchor" href="#minimal-overhead" aria-label="Permalink to &quot;Minimal Overhead&quot;">‚Äã</a></h3><ul><li><strong>Parsing</strong>: JSONPath expressions parsed once at filter creation</li><li><strong>Filtering</strong>: O(n) where n = number of ignored fields (typically &lt; 5)</li><li><strong>Memory</strong>: Negligible (~100 bytes per expression)</li></ul><h3 id="large-scale-deployments" tabindex="-1">Large-Scale Deployments <a class="header-anchor" href="#large-scale-deployments" aria-label="Permalink to &quot;Large-Scale Deployments&quot;">‚Äã</a></h3><p>For 1000+ nodes with ignored fields:</p><ul><li><strong>CPU impact</strong>: &lt; 1% overhead</li><li><strong>Reconciliation time</strong>: &lt; 10ms additional latency</li></ul><h2 id="migration-guide" tabindex="-1">Migration Guide <a class="header-anchor" href="#migration-guide" aria-label="Permalink to &quot;Migration Guide&quot;">‚Äã</a></h2><h3 id="adding-ignorefields-to-existing-resources" tabindex="-1">Adding ignoreFields to Existing Resources <a class="header-anchor" href="#adding-ignorefields-to-existing-resources" aria-label="Permalink to &quot;Adding ignoreFields to Existing Resources&quot;">‚Äã</a></h3><p><strong>Step 1</strong>: Identify fields to ignore</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Check what&#39;s being managed</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> get</span><span style="color:#9ECBFF;"> deployment</span><span style="color:#9ECBFF;"> myapp</span><span style="color:#79B8FF;"> -o</span><span style="color:#9ECBFF;"> yaml</span><span style="color:#F97583;"> |</span><span style="color:#B392F0;"> grep</span><span style="color:#9ECBFF;"> replicas</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>Step 2</strong>: Add to template</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">deployments</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">myapp</span></span>
<span class="line"><span style="color:#85E89D;">    ignoreFields</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;$.spec.replicas&quot;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#6A737D;">    # ... existing spec</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>Step 3</strong>: Apply template</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> apply</span><span style="color:#79B8FF;"> -f</span><span style="color:#9ECBFF;"> lynqnode-template.yaml</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>Step 4</strong>: Verify</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Make a manual change</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> scale</span><span style="color:#9ECBFF;"> deployment</span><span style="color:#9ECBFF;"> myapp</span><span style="color:#79B8FF;"> --replicas=10</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Update template (change something else)</span></span>
<span class="line"><span style="color:#6A737D;"># Apply template</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Verify replicas unchanged</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> get</span><span style="color:#9ECBFF;"> deployment</span><span style="color:#9ECBFF;"> myapp</span><span style="color:#79B8FF;"> -o</span><span style="color:#9ECBFF;"> jsonpath=&#39;{.spec.replicas}&#39;</span></span>
<span class="line"><span style="color:#6A737D;"># Should still show 10</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="removing-ignorefields" tabindex="-1">Removing ignoreFields <a class="header-anchor" href="#removing-ignorefields" aria-label="Permalink to &quot;Removing ignoreFields&quot;">‚Äã</a></h3><p><strong>Warning</strong>: Removing <code>ignoreFields</code> will cause operator to overwrite cluster values with template values on next reconciliation.</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Before</span></span>
<span class="line"><span style="color:#85E89D;">ignoreFields</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;$.spec.replicas&quot;</span><span style="color:#E1E4E8;">]  </span><span style="color:#6A737D;"># replicas=10 in cluster</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">  replicas</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">3</span><span style="color:#6A737D;">  # template value</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># After removal</span></span>
<span class="line"><span style="color:#85E89D;">ignoreFields</span><span style="color:#E1E4E8;">: []  </span><span style="color:#6A737D;"># ‚Üê Removed</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Next reconciliation: replicas will be reset to 3</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="related-features" tabindex="-1">Related Features <a class="header-anchor" href="#related-features" aria-label="Permalink to &quot;Related Features&quot;">‚Äã</a></h2><ul><li><a href="./policies.html">Policies</a> - Overall resource management policies</li><li><a href="./dependencies.html">Dependencies</a> - Resource creation ordering</li><li><a href="./templates.html">Templates</a> - Template variable system</li></ul>`,115))]))}});export{Z as __pageData,ss as default};
