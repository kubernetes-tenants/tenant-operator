import{_ as a,c as n,o as e,a2 as l}from"./chunks/framework.9Uv4PgnO.js";const b=JSON.parse('{"title":"Installation Guide","description":"","frontmatter":{},"headers":[],"relativePath":"installation.md","filePath":"installation.md","lastUpdated":1761887194000}'),r={name:"installation.md"};function o(t,s,p,i,c,u){return e(),n("div",null,[...s[0]||(s[0]=[l(`<h1 id="installation-guide" tabindex="-1">Installation Guide <a class="header-anchor" href="#installation-guide" aria-label="Permalink to &quot;Installation Guide&quot;">​</a></h1><p>This guide covers various installation methods for Tenant Operator.</p><nav class="table-of-contents"><ul><li><a href="#prerequisites">Prerequisites</a><ul><li><a href="#required">Required</a></li><li><a href="#production">Production</a></li><li><a href="#optional">Optional</a></li></ul></li><li><a href="#installation-methods">Installation Methods</a><ul><li><a href="#method-1-production-install-with-cert-manager">Method 1: Production Install with cert-manager</a></li><li><a href="#method-2-install-from-source">Method 2: Install from Source</a></li><li><a href="#method-3-local-development-with-minikube">Method 3: Local Development with Minikube</a></li></ul></li><li><a href="#verification">Verification</a></li><li><a href="#configuration-options">Configuration Options</a><ul><li><a href="#webhook-tls-configuration">Webhook TLS Configuration</a></li><li><a href="#resource-limits">Resource Limits</a></li><li><a href="#concurrency-settings">Concurrency Settings</a></li></ul></li><li><a href="#multi-platform-support">Multi-Platform Support</a></li><li><a href="#namespace-isolation">Namespace Isolation</a></li><li><a href="#upgrading">Upgrading</a><ul><li><a href="#upgrade-crds-first">Upgrade CRDs First</a></li><li><a href="#upgrade-operator">Upgrade Operator</a></li><li><a href="#rolling-back">Rolling Back</a></li></ul></li><li><a href="#uninstallation">Uninstallation</a></li><li><a href="#troubleshooting-installation">Troubleshooting Installation</a><ul><li><a href="#webhook-tls-errors">Webhook TLS Errors</a></li><li><a href="#crd-already-exists">CRD Already Exists</a></li><li><a href="#image-pull-errors">Image Pull Errors</a></li><li><a href="#permission-denied">Permission Denied</a></li></ul></li><li><a href="#next-steps">Next Steps</a></li></ul></nav><div class="tip custom-block"><p class="custom-block-title">Trying it locally?</p><p>Use the <a href="./quickstart.html">Quick Start with Minikube</a> guide for an automated setup tailored to first-time users.</p></div><h2 id="prerequisites" tabindex="-1">Prerequisites <a class="header-anchor" href="#prerequisites" aria-label="Permalink to &quot;Prerequisites&quot;">​</a></h2><h3 id="required" tabindex="-1">Required <a class="header-anchor" href="#required" aria-label="Permalink to &quot;Required&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Component</th><th>Minimum version</th><th>Notes</th></tr></thead><tbody><tr><td>Kubernetes cluster</td><td>v1.11.3+</td><td>API compatibility tested with recent releases</td></tr><tr><td><code>kubectl</code></td><td>Matches cluster</td><td>Must target the cluster where you deploy</td></tr></tbody></table><h3 id="production" tabindex="-1">Production <a class="header-anchor" href="#production" aria-label="Permalink to &quot;Production&quot;">​</a></h3><div class="warning custom-block"><p class="custom-block-title">Don&#39;t skip cert-manager</p><p>Install <strong>cert-manager v1.13.0+</strong> to provision webhook TLS certificates. It issues and renews certificates automatically and injects CA bundles into webhook configurations. See <a href="#method-1-production-install-with-cert-manager">Method 1</a>.</p></div><h3 id="optional" tabindex="-1">Optional <a class="header-anchor" href="#optional" aria-label="Permalink to &quot;Optional&quot;">​</a></h3><ul><li><strong>MySQL database</strong> for tenant data source (PostgreSQL support planned for v1.1)</li></ul><h2 id="installation-methods" tabindex="-1">Installation Methods <a class="header-anchor" href="#installation-methods" aria-label="Permalink to &quot;Installation Methods&quot;">​</a></h2><h3 id="method-1-production-install-with-cert-manager" tabindex="-1">Method 1: Production Install with cert-manager <a class="header-anchor" href="#method-1-production-install-with-cert-manager" aria-label="Permalink to &quot;Method 1: Production Install with cert-manager&quot;">​</a></h3><p><strong>cert-manager is required</strong> for webhook TLS certificate management.</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Step 1: Install cert-manager (if not already installed)</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> apply</span><span style="color:#79B8FF;"> -f</span><span style="color:#9ECBFF;"> https://github.com/cert-manager/cert-manager/releases/download/v1.13.0/cert-manager.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Step 2: Wait for cert-manager to be ready</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> wait</span><span style="color:#79B8FF;"> --for=condition=Available</span><span style="color:#79B8FF;"> --timeout=300s</span><span style="color:#79B8FF;"> -n</span><span style="color:#9ECBFF;"> cert-manager</span><span style="color:#9ECBFF;"> deployment/cert-manager</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> wait</span><span style="color:#79B8FF;"> --for=condition=Available</span><span style="color:#79B8FF;"> --timeout=300s</span><span style="color:#79B8FF;"> -n</span><span style="color:#9ECBFF;"> cert-manager</span><span style="color:#9ECBFF;"> deployment/cert-manager-webhook</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Step 3: Install Tenant Operator</span></span>
<span class="line"><span style="color:#6A737D;"># cert-manager will automatically issue and manage webhook TLS certificates</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> apply</span><span style="color:#79B8FF;"> -k</span><span style="color:#9ECBFF;"> https://github.com/kubernetes-tenants/tenant-operator/config/default</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="info custom-block"><p class="custom-block-title">What cert-manager handles</p><ul><li>Issues TLS certificates for the webhook server</li><li>Renews certificates before expiration</li><li>Injects the CA bundle into webhook configurations</li><li>Provides battle-tested certificate automation for Kubernetes clusters</li></ul></div><h3 id="method-2-install-from-source" tabindex="-1">Method 2: Install from Source <a class="header-anchor" href="#method-2-install-from-source" aria-label="Permalink to &quot;Method 2: Install from Source&quot;">​</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Clone repository</span></span>
<span class="line"><span style="color:#B392F0;">git</span><span style="color:#9ECBFF;"> clone</span><span style="color:#9ECBFF;"> https://github.com/kubernetes-tenants/tenant-operator.git</span></span>
<span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#9ECBFF;"> tenant-operator</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Install CRDs</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> install</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Install cert-manager first if not already installed</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> apply</span><span style="color:#79B8FF;"> -f</span><span style="color:#9ECBFF;"> https://github.com/cert-manager/cert-manager/releases/download/v1.13.0/cert-manager.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Deploy operator</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> deploy</span><span style="color:#9ECBFF;"> IMG=ghcr.io/kubernetes-tenants/tenant-operator:latest</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="warning custom-block"><p class="custom-block-title">Remember TLS</p><p>Even when deploying from source, install cert-manager before applying the operator manifests, otherwise webhooks will fail to start.</p></div><h3 id="method-3-local-development-with-minikube" tabindex="-1">Method 3: Local Development with Minikube <a class="header-anchor" href="#method-3-local-development-with-minikube" aria-label="Permalink to &quot;Method 3: Local Development with Minikube&quot;">​</a></h3><p>For local development, use Minikube with automated setup scripts.</p><p>See <a href="./local-development-minikube.html">Local Development with Minikube</a> for detailed instructions.</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Quick setup</span></span>
<span class="line"><span style="color:#B392F0;">./scripts/setup-minikube.sh</span><span style="color:#6A737D;">      # Create cluster with cert-manager</span></span>
<span class="line"><span style="color:#B392F0;">./scripts/deploy-to-minikube.sh</span><span style="color:#6A737D;">  # Build and deploy operator</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="verification" tabindex="-1">Verification <a class="header-anchor" href="#verification" aria-label="Permalink to &quot;Verification&quot;">​</a></h2><p>Check that the operator is running:</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Check operator deployment</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> get</span><span style="color:#9ECBFF;"> deployment</span><span style="color:#79B8FF;"> -n</span><span style="color:#9ECBFF;"> tenant-operator-system</span><span style="color:#9ECBFF;"> tenant-operator-controller-manager</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Check operator logs</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> logs</span><span style="color:#79B8FF;"> -n</span><span style="color:#9ECBFF;"> tenant-operator-system</span><span style="color:#9ECBFF;"> deployment/tenant-operator-controller-manager</span><span style="color:#79B8FF;"> -f</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Verify CRDs are installed</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> get</span><span style="color:#9ECBFF;"> crd</span><span style="color:#F97583;"> |</span><span style="color:#B392F0;"> grep</span><span style="color:#9ECBFF;"> operator.kubernetes-tenants.org</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>Expected output:</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>tenantregistries.operator.kubernetes-tenants.org    2025-01-15T10:00:00Z</span></span>
<span class="line"><span>tenants.operator.kubernetes-tenants.org             2025-01-15T10:00:00Z</span></span>
<span class="line"><span>tenanttemplates.operator.kubernetes-tenants.org     2025-01-15T10:00:00Z</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">Troubleshooting</p><p>If the deployment is not ready, inspect <code>kubectl describe deployment/tenant-operator-controller-manager</code> for webhook, RBAC, or image issues.</p></div><h2 id="configuration-options" tabindex="-1">Configuration Options <a class="header-anchor" href="#configuration-options" aria-label="Permalink to &quot;Configuration Options&quot;">​</a></h2><h3 id="webhook-tls-configuration" tabindex="-1">Webhook TLS Configuration <a class="header-anchor" href="#webhook-tls-configuration" aria-label="Permalink to &quot;Webhook TLS Configuration&quot;">​</a></h3><p>Webhook TLS is managed automatically by cert-manager. The default configuration includes:</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># config/default/kustomization.yaml</span></span>
<span class="line"><span style="color:#6A737D;"># Webhook patches are enabled by default</span></span>
<span class="line"><span style="color:#85E89D;">patches</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">- </span><span style="color:#85E89D;">path</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">manager_webhook_patch.yaml</span></span>
<span class="line"><span style="color:#E1E4E8;">- </span><span style="color:#85E89D;">path</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">webhookcainjection_patch.yaml</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="info custom-block"><p class="custom-block-title">cert-manager responsibilities</p><ul><li>Issue TLS certificates for the webhook server</li><li>Inject CA bundles into webhook configurations</li><li>Renew certificates before expiration</li></ul></div><h3 id="resource-limits" tabindex="-1">Resource Limits <a class="header-anchor" href="#resource-limits" aria-label="Permalink to &quot;Resource Limits&quot;">​</a></h3><p>Adjust operator resource limits based on your cluster size:</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># config/manager/manager.yaml</span></span>
<span class="line"><span style="color:#85E89D;">resources</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">  limits</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">    cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">500m</span><span style="color:#6A737D;">      # Increase for large clusters</span></span>
<span class="line"><span style="color:#85E89D;">    memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">512Mi</span><span style="color:#6A737D;">  # Increase for many tenants</span></span>
<span class="line"><span style="color:#85E89D;">  requests</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">    cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">100m</span></span>
<span class="line"><span style="color:#85E89D;">    memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">128Mi</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="concurrency-settings" tabindex="-1">Concurrency Settings <a class="header-anchor" href="#concurrency-settings" aria-label="Permalink to &quot;Concurrency Settings&quot;">​</a></h3><p>Configure concurrent reconciliation workers:</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">  template</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">    spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">      containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">manager</span></span>
<span class="line"><span style="color:#85E89D;">        args</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#9ECBFF;">--tenant-concurrency=10</span><span style="color:#6A737D;">        # Concurrent Tenant reconciliations</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#9ECBFF;">--registry-concurrency=5</span><span style="color:#6A737D;">       # Concurrent Registry syncs</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#9ECBFF;">--leader-elect</span><span style="color:#6A737D;">                 # Enable leader election</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="multi-platform-support" tabindex="-1">Multi-Platform Support <a class="header-anchor" href="#multi-platform-support" aria-label="Permalink to &quot;Multi-Platform Support&quot;">​</a></h2><p>The operator supports multiple architectures:</p><ul><li><code>linux/amd64</code> (Intel/AMD 64-bit)</li><li><code>linux/arm64</code> (ARM 64-bit, Apple Silicon)</li></ul><p>Container images are automatically pulled for your platform.</p><h2 id="namespace-isolation" tabindex="-1">Namespace Isolation <a class="header-anchor" href="#namespace-isolation" aria-label="Permalink to &quot;Namespace Isolation&quot;">​</a></h2><p>By default, the operator is installed in <code>tenant-operator-system</code> namespace:</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Check operator namespace</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> get</span><span style="color:#9ECBFF;"> all</span><span style="color:#79B8FF;"> -n</span><span style="color:#9ECBFF;"> tenant-operator-system</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># View RBAC</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> get</span><span style="color:#9ECBFF;"> clusterrole</span><span style="color:#F97583;"> |</span><span style="color:#B392F0;"> grep</span><span style="color:#9ECBFF;"> tenant-operator</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> get</span><span style="color:#9ECBFF;"> clusterrolebinding</span><span style="color:#F97583;"> |</span><span style="color:#B392F0;"> grep</span><span style="color:#9ECBFF;"> tenant-operator</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="upgrading" tabindex="-1">Upgrading <a class="header-anchor" href="#upgrading" aria-label="Permalink to &quot;Upgrading&quot;">​</a></h2><h3 id="upgrade-crds-first" tabindex="-1">Upgrade CRDs First <a class="header-anchor" href="#upgrade-crds-first" aria-label="Permalink to &quot;Upgrade CRDs First&quot;">​</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Upgrade CRDs (safe, preserves existing data)</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> install</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Or with kubectl</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> apply</span><span style="color:#79B8FF;"> -f</span><span style="color:#9ECBFF;"> config/crd/bases/</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="upgrade-operator" tabindex="-1">Upgrade Operator <a class="header-anchor" href="#upgrade-operator" aria-label="Permalink to &quot;Upgrade Operator&quot;">​</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Update operator deployment</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> set</span><span style="color:#9ECBFF;"> image</span><span style="color:#79B8FF;"> -n</span><span style="color:#9ECBFF;"> tenant-operator-system</span><span style="color:#79B8FF;"> \\</span></span>
<span class="line"><span style="color:#9ECBFF;">  deployment/tenant-operator-controller-manager</span><span style="color:#79B8FF;"> \\</span></span>
<span class="line"><span style="color:#9ECBFF;">  manager=ghcr.io/kubernetes-tenants/tenant-operator:v1.1.0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Or use make</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> deploy</span><span style="color:#9ECBFF;"> IMG=ghcr.io/kubernetes-tenants/tenant-operator:v1.1.0</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="rolling-back" tabindex="-1">Rolling Back <a class="header-anchor" href="#rolling-back" aria-label="Permalink to &quot;Rolling Back&quot;">​</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Rollback to previous version</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> rollout</span><span style="color:#9ECBFF;"> undo</span><span style="color:#79B8FF;"> -n</span><span style="color:#9ECBFF;"> tenant-operator-system</span><span style="color:#79B8FF;"> \\</span></span>
<span class="line"><span style="color:#9ECBFF;">  deployment/tenant-operator-controller-manager</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Check rollout status</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> rollout</span><span style="color:#9ECBFF;"> status</span><span style="color:#79B8FF;"> -n</span><span style="color:#9ECBFF;"> tenant-operator-system</span><span style="color:#79B8FF;"> \\</span></span>
<span class="line"><span style="color:#9ECBFF;">  deployment/tenant-operator-controller-manager</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="uninstallation" tabindex="-1">Uninstallation <a class="header-anchor" href="#uninstallation" aria-label="Permalink to &quot;Uninstallation&quot;">​</a></h2><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Delete operator deployment</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> delete</span><span style="color:#79B8FF;"> -k</span><span style="color:#9ECBFF;"> config/default</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Or with make</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> undeploy</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Delete CRDs (WARNING: This deletes all Tenant data!)</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> uninstall</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Or with kubectl</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> delete</span><span style="color:#9ECBFF;"> crd</span><span style="color:#9ECBFF;"> tenantregistries.operator.kubernetes-tenants.org</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> delete</span><span style="color:#9ECBFF;"> crd</span><span style="color:#9ECBFF;"> tenanttemplates.operator.kubernetes-tenants.org</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> delete</span><span style="color:#9ECBFF;"> crd</span><span style="color:#9ECBFF;"> tenants.operator.kubernetes-tenants.org</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>Warning:</strong> Deleting CRDs will delete all TenantRegistry, TenantTemplate, and Tenant resources. Ensure you have backups if needed.</p><h2 id="troubleshooting-installation" tabindex="-1">Troubleshooting Installation <a class="header-anchor" href="#troubleshooting-installation" aria-label="Permalink to &quot;Troubleshooting Installation&quot;">​</a></h2><h3 id="webhook-tls-errors" tabindex="-1">Webhook TLS Errors <a class="header-anchor" href="#webhook-tls-errors" aria-label="Permalink to &quot;Webhook TLS Errors&quot;">​</a></h3><p><strong>Error:</strong> <code>open /tmp/k8s-webhook-server/serving-certs/tls.crt: no such file or directory</code></p><p><strong>Solution:</strong> Install cert-manager to automatically manage webhook TLS certificates.</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Install cert-manager</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> apply</span><span style="color:#79B8FF;"> -f</span><span style="color:#9ECBFF;"> https://github.com/cert-manager/cert-manager/releases/download/v1.13.0/cert-manager.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Wait for cert-manager to be ready</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> wait</span><span style="color:#79B8FF;"> --for=condition=Available</span><span style="color:#79B8FF;"> --timeout=300s</span><span style="color:#79B8FF;"> -n</span><span style="color:#9ECBFF;"> cert-manager</span><span style="color:#9ECBFF;"> deployment/cert-manager</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Restart operator to pick up certificates</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> rollout</span><span style="color:#9ECBFF;"> restart</span><span style="color:#79B8FF;"> -n</span><span style="color:#9ECBFF;"> tenant-operator-system</span><span style="color:#9ECBFF;"> deployment/tenant-operator-controller-manager</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="crd-already-exists" tabindex="-1">CRD Already Exists <a class="header-anchor" href="#crd-already-exists" aria-label="Permalink to &quot;CRD Already Exists&quot;">​</a></h3><p><strong>Error:</strong> <code>Error from server (AlreadyExists): customresourcedefinitions.apiextensions.k8s.io &quot;tenants.operator.kubernetes-tenants.org&quot; already exists</code></p><p><strong>Solution:</strong> This is normal during upgrades. CRD updates are applied automatically.</p><h3 id="image-pull-errors" tabindex="-1">Image Pull Errors <a class="header-anchor" href="#image-pull-errors" aria-label="Permalink to &quot;Image Pull Errors&quot;">​</a></h3><p><strong>Error:</strong> <code>Failed to pull image &quot;ghcr.io/kubernetes-tenants/tenant-operator:latest&quot;</code></p><p><strong>Solution:</strong> Ensure your cluster can access GitHub Container Registry (ghcr.io). Check network policies and image pull secrets if needed.</p><h3 id="permission-denied" tabindex="-1">Permission Denied <a class="header-anchor" href="#permission-denied" aria-label="Permalink to &quot;Permission Denied&quot;">​</a></h3><p><strong>Error:</strong> <code>Error from server (Forbidden): User &quot;system:serviceaccount:tenant-operator-system:tenant-operator-controller-manager&quot; cannot create resource</code></p><p><strong>Solution:</strong> Ensure RBAC resources are installed:</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> apply</span><span style="color:#79B8FF;"> -f</span><span style="color:#9ECBFF;"> config/rbac/</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="next-steps" tabindex="-1">Next Steps <a class="header-anchor" href="#next-steps" aria-label="Permalink to &quot;Next Steps&quot;">​</a></h2><ul><li><a href="./quickstart.html#step-4-deploy-tenantregistry">Create your first TenantRegistry</a></li><li><a href="./templates.html">Learn about Templates</a></li><li><a href="./monitoring.html">Configure Monitoring</a></li><li><a href="./security.html">Set up Security</a></li></ul>`,74)])])}const m=a(r,[["render",o]]);export{b as __pageData,m as default};
