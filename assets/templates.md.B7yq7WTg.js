import{_ as p,C as t,c,o as l,a3 as e,b as i,j as s,w as o,a,G as u,a9 as d}from"./chunks/framework.DddEBHwx.js";const C=JSON.parse('{"title":"Template Guide","description":"","frontmatter":{},"headers":[],"relativePath":"templates.md","filePath":"templates.md","lastUpdated":1763388896000}'),b={name:"templates.md"};function m(E,n,y,F,h,g){const r=t("Mermaid");return l(),c("div",null,[n[1]||(n[1]=e('<h1 id="template-guide" tabindex="-1">Template Guide <a class="header-anchor" href="#template-guide" aria-label="Permalink to &quot;Template Guide&quot;">​</a></h1><p>Templates are the core of Lynq&#39;s resource generation system. This guide covers template syntax, available functions, and best practices.</p><nav class="table-of-contents"><ul><li><a href="#template-basics">Template Basics</a></li><li><a href="#available-variables">Available Variables</a><ul><li><a href="#deprecated-variables">Deprecated Variables</a></li><li><a href="#sprig-functions-200">Sprig Functions (200+)</a></li></ul></li><li><a href="#template-examples">Template Examples</a></li><li><a href="#template-best-practices">Template Best Practices</a></li><li><a href="#template-rendering-process">Template Rendering Process</a></li><li><a href="#template-evolution">Template Evolution</a><ul><li><a href="#best-practices-for-template-changes">Best Practices for Template Changes</a></li></ul></li><li><a href="#see-also">See Also</a></li></ul></nav><h2 id="template-basics" tabindex="-1">Template Basics <a class="header-anchor" href="#template-basics" aria-label="Permalink to &quot;Template Basics&quot;">​</a></h2><p>Lynq uses Go&#39;s <code>text/template</code> engine with the Sprig function library, providing 200+ built-in functions.</p>',5)),(l(),i(d,null,{default:o(()=>[u(r,{id:"mermaid-15",class:"mermaid my-class",graph:"flowchart%20LR%0A%20%20%20%20Hub%5B%22LynqHub%3Cbr%2F%3ERow%20Data%22%5D%0A%20%20%20%20Template%5B%22LynqForm%3Cbr%2F%3ETResource%22%5D%0A%20%20%20%20Renderer%5B%22Template%20Renderer%3Cbr%2F%3E(text%2Ftemplate%20%2B%20Sprig)%22%5D%0A%20%20%20%20Node%5B%22LynqNode%20CR%3Cbr%2F%3Eresolved%20spec%22%5D%0A%20%20%20%20K8s%5B%22Kubernetes%20Resources%22%5D%0A%0A%20%20%20%20Hub%20--%20variables%20--%3E%20Template%0A%20%20%20%20Template%20--%20inputs%20--%3E%20Renderer%0A%20%20%20%20Renderer%20--%20renders%20--%3E%20Node%0A%20%20%20%20Node%20--%20SSA%20apply%20--%3E%20K8s%0A%0A%20%20%20%20classDef%20component%20fill%3A%23e8f5e9%2Cstroke%3A%2381c784%2Cstroke-width%3A2px%3B%0A%20%20%20%20classDef%20data%20fill%3A%23f3e5f5%2Cstroke%3A%23ba68c8%2Cstroke-width%3A2px%3B%0A%20%20%20%20class%20Hub%20data%3B%0A%20%20%20%20class%20Template%20component%3B%0A%20%20%20%20class%20Renderer%20component%3B%0A%20%20%20%20class%20Node%20component%3B%0A%20%20%20%20class%20K8s%20data%3B%0A"})]),fallback:o(()=>[...n[0]||(n[0]=[a(" Loading... ",-1)])]),_:1})),n[2]||(n[2]=s("div",null,[s("h3",{id:"template-syntax",tabindex:"-1"},[a("Template Syntax "),s("a",{class:"header-anchor",href:"#template-syntax","aria-label":'Permalink to "Template Syntax"'},"​")]),s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# Basic variable substitution")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"nameTemplate"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .uid }}-app"')]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# With function")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"nameTemplate"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .uid | trunc63 }}"')]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# Conditional")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"nameTemplate"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ if .region }}{{ .region }}-{{ end }}{{ .uid }}"')]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# Default value")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"nameTemplate"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .uid }}-{{ .planId | default '),s("span",{style:{color:"#79B8FF"}},'\\"'),s("span",{style:{color:"#9ECBFF"}},"basic"),s("span",{style:{color:"#79B8FF"}},'\\"'),s("span",{style:{color:"#9ECBFF"}},' }}"')])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br"),s("span",{class:"line-number"},"5"),s("br"),s("span",{class:"line-number"},"6"),s("br"),s("span",{class:"line-number"},"7"),s("br"),s("span",{class:"line-number"},"8"),s("br"),s("span",{class:"line-number"},"9"),s("br"),s("span",{class:"line-number"},"10"),s("br"),s("span",{class:"line-number"},"11"),s("br")])])],-1)),n[3]||(n[3]=s("h2",{id:"available-variables",tabindex:"-1"},[a("Available Variables "),s("a",{class:"header-anchor",href:"#available-variables","aria-label":'Permalink to "Available Variables"'},"​")],-1)),n[4]||(n[4]=s("div",null,[s("h3",{id:"required-variables",tabindex:"-1"},[a("Required Variables "),s("a",{class:"header-anchor",href:"#required-variables","aria-label":'Permalink to "Required Variables"'},"​")]),s("p",null,"These are always available from the template context:"),s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#9ECBFF"}},".uid"),s("span",{style:{color:"#6A737D"}},"         # Node unique identifier (from uid mapping)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9ECBFF"}},".activate"),s("span",{style:{color:"#6A737D"}},"    # Activation status (from activate mapping)")])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br")])])],-1)),n[5]||(n[5]=s("h3",{id:"deprecated-variables",tabindex:"-1"},[a("Deprecated Variables "),s("a",{class:"header-anchor",href:"#deprecated-variables","aria-label":'Permalink to "Deprecated Variables"'},"​")],-1)),n[6]||(n[6]=s("div",{class:"danger custom-block"},[s("p",{class:"custom-block-title"},"DEPRECATED"),s("p",null,[a("The following variables are "),s("strong",null,"deprecated since v1.1.11"),a(" and will be "),s("strong",null,"removed in v1.3.0"),a(":")])],-1)),n[7]||(n[7]=s("div",null,[s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#9ECBFF"}},".hostOrUrl"),s("span",{style:{color:"#6A737D"}},"   # Original URL/host from registry (from hostOrUrl mapping)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9ECBFF"}},".host"),s("span",{style:{color:"#6A737D"}},"        # Auto-extracted host from .hostOrUrl")])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br")])])],-1)),n[8]||(n[8]=s("div",{class:"tip custom-block"},[s("p",{class:"custom-block-title"},"Migration Guide"),s("p",null,[s("strong",null,[a("Instead of using "),s("code",null,".hostOrUrl"),a(" and "),s("code",null,".host"),a(":")])]),s("p",null,[s("strong",null,"Before (deprecated):")]),s("div",null,[s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# In LynqHub")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"spec"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  valueMappings"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"    uid"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"node_id")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"    hostOrUrl"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"domain_url"),s("span",{style:{color:"#6A737D"}},"  # ⚠️ Deprecated")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"    activate"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"is_active")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# In template")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"env"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"  - "),s("span",{style:{color:"#85E89D"}},"name"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"HOST")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"    value"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .host }}"'),s("span",{style:{color:"#6A737D"}},"  # ⚠️ Deprecated")])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br"),s("span",{class:"line-number"},"5"),s("br"),s("span",{class:"line-number"},"6"),s("br"),s("span",{class:"line-number"},"7"),s("br"),s("span",{class:"line-number"},"8"),s("br"),s("span",{class:"line-number"},"9"),s("br"),s("span",{class:"line-number"},"10"),s("br"),s("span",{class:"line-number"},"11"),s("br")])])])],-1)),n[9]||(n[9]=s("p",null,[s("strong",null,"After (v1.1.11+):")],-1)),n[10]||(n[10]=s("div",null,[s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# In LynqHub")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"spec"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  valueMappings"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"    uid"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"node_id")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"    activate"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"is_active")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  extraValueMappings"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"    domainUrl"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"domain_url"),s("span",{style:{color:"#6A737D"}},"  # ✅ Use extraValueMappings")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# In template")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"env"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"  - "),s("span",{style:{color:"#85E89D"}},"name"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"HOST")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"    value"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .domainUrl | toHost }}"'),s("span",{style:{color:"#6A737D"}},"  # ✅ Use toHost() function")])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br"),s("span",{class:"line-number"},"5"),s("br"),s("span",{class:"line-number"},"6"),s("br"),s("span",{class:"line-number"},"7"),s("br"),s("span",{class:"line-number"},"8"),s("br"),s("span",{class:"line-number"},"9"),s("br"),s("span",{class:"line-number"},"10"),s("br"),s("span",{class:"line-number"},"11"),s("br"),s("span",{class:"line-number"},"12"),s("br")])])],-1)),n[11]||(n[11]=s("p",null,[s("strong",null,"Why this change?"),a(" Lynq is now a "),s("strong",null,"database-driven automation platform"),a(", not limited to tenant/host provisioning. Requiring "),s("code",null,".hostOrUrl"),a(' was an unnecessary constraint from the legacy "tenant-operator" design.')],-1)),n[12]||(n[12]=s("div",null,[s("h3",{id:"context-variables",tabindex:"-1"},[a("Context Variables "),s("a",{class:"header-anchor",href:"#context-variables","aria-label":'Permalink to "Context Variables"'},"​")]),s("p",null,"Automatically provided:"),s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#9ECBFF"}},".hubId"),s("span",{style:{color:"#6A737D"}},"   # LynqHub name")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9ECBFF"}},".templateRef"),s("span",{style:{color:"#6A737D"}},"  # LynqForm name")])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br")])]),s("h3",{id:"custom-variables",tabindex:"-1"},[a("Custom Variables "),s("a",{class:"header-anchor",href:"#custom-variables","aria-label":'Permalink to "Custom Variables"'},"​")]),s("p",null,[a("From "),s("code",null,"extraValueMappings"),a(" in LynqHub:")]),s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"spec"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  extraValueMappings"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"    planId"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"subscription_plan")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"    region"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"deployment_region")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"    dbHost"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"database_host")])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br"),s("span",{class:"line-number"},"5"),s("br")])]),s("p",null,"Access in templates:"),s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#9ECBFF"}},".planId"),s("span",{style:{color:"#6A737D"}},"   # Maps to subscription_plan column")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9ECBFF"}},".region"),s("span",{style:{color:"#6A737D"}},"   # Maps to deployment_region column")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9ECBFF"}},".dbHost"),s("span",{style:{color:"#6A737D"}},"   # Maps to database_host column")])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br")])])],-1)),n[13]||(n[13]=s("div",null,[s("h2",{id:"template-functions",tabindex:"-1"},[a("Template Functions "),s("a",{class:"header-anchor",href:"#template-functions","aria-label":'Permalink to "Template Functions"'},"​")]),s("h3",{id:"built-in-custom-functions",tabindex:"-1"},[a("Built-in Custom Functions "),s("a",{class:"header-anchor",href:"#built-in-custom-functions","aria-label":'Permalink to "Built-in Custom Functions"'},"​")]),s("h4",{id:"tohost-url-✅",tabindex:"-1"},[s("code",null,"toHost(url)"),a(" ✅ "),s("a",{class:"header-anchor",href:"#tohost-url-✅","aria-label":'Permalink to "`toHost(url)` ✅"'},"​")]),s("p",null,"Extract hostname from URL:"),s("div",{class:"tip custom-block"},[s("p",{class:"custom-block-title"},"Recommended Usage"),s("p",null,[a("Use with "),s("code",null,"extraValueMappings"),a(" instead of deprecated "),s("code",null,".hostOrUrl"),a(":")]),s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# Input: https://acme.example.com:8080/path")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# Output: acme.example.com")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"env"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"- "),s("span",{style:{color:"#85E89D"}},"name"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"HOST")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  value"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .domainUrl | toHost }}"'),s("span",{style:{color:"#6A737D"}},"  # ✅ Recommended (v1.1.11+)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},'  # value: "{{ .hostOrUrl | toHost }}"  # ⚠️ Deprecated, removed in v1.3.0')])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br"),s("span",{class:"line-number"},"5"),s("br"),s("span",{class:"line-number"},"6"),s("br")])])])],-1)),n[14]||(n[14]=e(`<h4 id="trunc63-s-✅" tabindex="-1"><code>trunc63(s)</code> ✅ <a class="header-anchor" href="#trunc63-s-✅" aria-label="Permalink to &quot;\`trunc63(s)\` ✅&quot;">​</a></h4><p>Truncate to 63 characters (Kubernetes name limit):</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Ensures name fits K8s limits</span></span>
<span class="line"><span style="color:#85E89D;">nameTemplate</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid }}-{{ .region }}-deployment | trunc63 }}&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="sha1sum-s-✅" tabindex="-1"><code>sha1sum(s)</code> ✅ <a class="header-anchor" href="#sha1sum-s-✅" aria-label="Permalink to &quot;\`sha1sum(s)\` ✅&quot;">​</a></h4><p>Generate SHA1 hash:</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Create unique, stable resource names</span></span>
<span class="line"><span style="color:#85E89D;">nameTemplate</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;app-{{ .uid | sha1sum | trunc 8 }}&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="fromjson-s-✅" tabindex="-1"><code>fromJson(s)</code> ✅ <a class="header-anchor" href="#fromjson-s-✅" aria-label="Permalink to &quot;\`fromJson(s)\` ✅&quot;">​</a></h4><p>Parse JSON string:</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Parse JSON configuration from database</span></span>
<span class="line"><span style="color:#85E89D;">env</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">- </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">API_KEY</span></span>
<span class="line"><span style="color:#85E89D;">  value</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ (.config | fromJson).apiKey }}&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">- </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">ENDPOINT</span></span>
<span class="line"><span style="color:#85E89D;">  value</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ (.config | fromJson).endpoint }}&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="sprig-functions-200" tabindex="-1">Sprig Functions (200+) <a class="header-anchor" href="#sprig-functions-200" aria-label="Permalink to &quot;Sprig Functions (200+)&quot;">​</a></h3><p>Full documentation: <a href="https://masterminds.github.io/sprig/" target="_blank" rel="noreferrer">https://masterminds.github.io/sprig/</a></p><h4 id="string-functions" tabindex="-1">String Functions <a class="header-anchor" href="#string-functions" aria-label="Permalink to &quot;String Functions&quot;">​</a></h4><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Uppercase/lowercase</span></span>
<span class="line"><span style="color:#85E89D;">nameTemplate</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid | upper }}&quot;</span></span>
<span class="line"><span style="color:#85E89D;">nameTemplate</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid | lower }}&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Trim whitespace</span></span>
<span class="line"><span style="color:#85E89D;">value</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .name | trim }}&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Replace</span></span>
<span class="line"><span style="color:#85E89D;">value</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .uid | replace </span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">.</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#79B8FF;"> \\&quot;</span><span style="color:#9ECBFF;">-</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;"> }}&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Quote</span></span>
<span class="line"><span style="color:#85E89D;">value</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .name | quote }}&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="encoding-functions" tabindex="-1">Encoding Functions <a class="header-anchor" href="#encoding-functions" aria-label="Permalink to &quot;Encoding Functions&quot;">​</a></h4><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Base64 encode/decode</span></span>
<span class="line"><span style="color:#85E89D;">value</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .secret | b64enc }}&quot;</span></span>
<span class="line"><span style="color:#85E89D;">value</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .encoded | b64dec }}&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># URL encoding</span></span>
<span class="line"><span style="color:#85E89D;">value</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .param | urlquery }}&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># SHA256</span></span>
<span class="line"><span style="color:#85E89D;">value</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .data | sha256sum }}&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="default-values" tabindex="-1">Default Values <a class="header-anchor" href="#default-values" aria-label="Permalink to &quot;Default Values&quot;">​</a></h4><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Provide default if variable is empty</span></span>
<span class="line"><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .deployImage | default </span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">nginx:stable</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;"> }}&quot;</span></span>
<span class="line"><span style="color:#85E89D;">port</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .appPort | default </span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">8080</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;"> }}&quot;</span></span>
<span class="line"><span style="color:#85E89D;">region</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ .region | default </span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">us-east-1</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;"> }}&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="conditionals" tabindex="-1">Conditionals <a class="header-anchor" href="#conditionals" aria-label="Permalink to &quot;Conditionals&quot;">​</a></h4><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># If/else</span></span>
<span class="line"><span style="color:#85E89D;">env</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">- </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">DEBUG</span></span>
<span class="line"><span style="color:#85E89D;">  value</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ if eq .planId </span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">enterprise</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;"> }}true{{ else }}false{{ end }}&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Ternary</span></span>
<span class="line"><span style="color:#85E89D;">replicas</span><span style="color:#E1E4E8;">: {{ </span><span style="color:#9ECBFF;">ternary 5 2 (eq .planId &quot;enterprise&quot;)</span><span style="color:#E1E4E8;"> }}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="lists-and-iteration" tabindex="-1">Lists and Iteration <a class="header-anchor" href="#lists-and-iteration" aria-label="Permalink to &quot;Lists and Iteration&quot;">​</a></h4><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Join</span></span>
<span class="line"><span style="color:#85E89D;">annotations</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">  tags</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ list </span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">app</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;"> .uid .region | join </span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">,</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;"> }}&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Iterate (in ConfigMap data)</span></span>
<span class="line"><span style="color:#85E89D;">data</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">  config.json</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#9ECBFF;">    {</span></span>
<span class="line"><span style="color:#9ECBFF;">      &quot;tenants&quot;: [</span></span>
<span class="line"><span style="color:#9ECBFF;">        {{- range $i, $id := list \\&quot;tenant1\\&quot; \\&quot;tenant2\\&quot; }}</span></span>
<span class="line"><span style="color:#9ECBFF;">        {{ if $i }},{{ end }}</span></span>
<span class="line"><span style="color:#9ECBFF;">        &quot;{{ $id }}&quot;</span></span>
<span class="line"><span style="color:#9ECBFF;">        {{- end }}</span></span>
<span class="line"><span style="color:#9ECBFF;">      ]</span></span>
<span class="line"><span style="color:#9ECBFF;">    }</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="math-functions" tabindex="-1">Math Functions <a class="header-anchor" href="#math-functions" aria-label="Permalink to &quot;Math Functions&quot;">​</a></h4><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Arithmetic</span></span>
<span class="line"><span style="color:#85E89D;">value</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ add .basePort 1000 }}&quot;</span></span>
<span class="line"><span style="color:#85E89D;">value</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ mul .cpuLimit 2 }}&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Min/max</span></span>
<span class="line"><span style="color:#85E89D;">value</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;{{ max .minReplicas 3 }}&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="template-examples" tabindex="-1">Template Examples <a class="header-anchor" href="#template-examples" aria-label="Permalink to &quot;Template Examples&quot;">​</a></h2>`,24)),n[15]||(n[15]=s("div",null,[s("h3",{id:"example-1-multi-region-deployment",tabindex:"-1"},[a("Example 1: Multi-Region Deployment "),s("a",{class:"header-anchor",href:"#example-1-multi-region-deployment","aria-label":'Permalink to "Example 1: Multi-Region Deployment"'},"​")]),s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"deployments"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"  - "),s("span",{style:{color:"#85E89D"}},"id"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"app")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"    nameTemplate"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .uid }}-{{ .region | default '),s("span",{style:{color:"#79B8FF"}},'\\"'),s("span",{style:{color:"#9ECBFF"}},"default"),s("span",{style:{color:"#79B8FF"}},'\\"'),s("span",{style:{color:"#9ECBFF"}},' }}"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"    spec"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"      apiVersion"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"apps/v1")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"      kind"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"Deployment")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"      spec"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"        replicas"),s("span",{style:{color:"#E1E4E8"}},": {{ "),s("span",{style:{color:"#9ECBFF"}},'if eq .planId "enterprise"'),s("span",{style:{color:"#E1E4E8"}}," }}"),s("span",{style:{color:"#9ECBFF"}},"5{{ else }}2{{ end }}")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"        template"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"          spec"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"            containers"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"            - "),s("span",{style:{color:"#85E89D"}},"name"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"app")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"              image"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .deployImage | default '),s("span",{style:{color:"#79B8FF"}},'\\"'),s("span",{style:{color:"#9ECBFF"}},"myapp:latest"),s("span",{style:{color:"#79B8FF"}},'\\"'),s("span",{style:{color:"#9ECBFF"}},' }}"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"              env"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"              - "),s("span",{style:{color:"#85E89D"}},"name"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"TENANT_ID")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"                value"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .uid }}"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"              - "),s("span",{style:{color:"#85E89D"}},"name"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"REGION")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"                value"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .region | default '),s("span",{style:{color:"#79B8FF"}},'\\"'),s("span",{style:{color:"#9ECBFF"}},"us-east-1"),s("span",{style:{color:"#79B8FF"}},'\\"'),s("span",{style:{color:"#9ECBFF"}},' }}"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"              - "),s("span",{style:{color:"#85E89D"}},"name"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"DATABASE_HOST")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"                value"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .dbHost }}"')])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br"),s("span",{class:"line-number"},"5"),s("br"),s("span",{class:"line-number"},"6"),s("br"),s("span",{class:"line-number"},"7"),s("br"),s("span",{class:"line-number"},"8"),s("br"),s("span",{class:"line-number"},"9"),s("br"),s("span",{class:"line-number"},"10"),s("br"),s("span",{class:"line-number"},"11"),s("br"),s("span",{class:"line-number"},"12"),s("br"),s("span",{class:"line-number"},"13"),s("br"),s("span",{class:"line-number"},"14"),s("br"),s("span",{class:"line-number"},"15"),s("br"),s("span",{class:"line-number"},"16"),s("br"),s("span",{class:"line-number"},"17"),s("br"),s("span",{class:"line-number"},"18"),s("br"),s("span",{class:"line-number"},"19"),s("br"),s("span",{class:"line-number"},"20"),s("br")])]),s("h3",{id:"example-2-secure-resource-names",tabindex:"-1"},[a("Example 2: Secure Resource Names "),s("a",{class:"header-anchor",href:"#example-2-secure-resource-names","aria-label":'Permalink to "Example 2: Secure Resource Names"'},"​")]),s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# Use SHA1 to create short, unique, stable names")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"nameTemplate"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .uid | sha1sum | trunc 8 }}-app"')]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# Ensures:")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},'# - Fixed length (8 chars + "-app")')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# - Unique per node")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# - Stable across reconciliations")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# - URL-safe")])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br"),s("span",{class:"line-number"},"5"),s("br"),s("span",{class:"line-number"},"6"),s("br"),s("span",{class:"line-number"},"7"),s("br"),s("span",{class:"line-number"},"8"),s("br")])]),s("h3",{id:"example-3-json-configuration",tabindex:"-1"},[a("Example 3: JSON Configuration "),s("a",{class:"header-anchor",href:"#example-3-json-configuration","aria-label":'Permalink to "Example 3: JSON Configuration"'},"​")]),s("p",null,"Database column contains JSON:"),s("div",{class:"language-json line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"json"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"{")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#79B8FF"}},'  "apiKey"'),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"sk-abc123"'),s("span",{style:{color:"#E1E4E8"}},",")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#79B8FF"}},'  "features"'),s("span",{style:{color:"#E1E4E8"}},": ["),s("span",{style:{color:"#9ECBFF"}},'"feature-a"'),s("span",{style:{color:"#E1E4E8"}},", "),s("span",{style:{color:"#9ECBFF"}},'"feature-b"'),s("span",{style:{color:"#E1E4E8"}},"],")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#79B8FF"}},'  "limits"'),s("span",{style:{color:"#E1E4E8"}},": {"),s("span",{style:{color:"#79B8FF"}},'"requests"'),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#79B8FF"}},"1000"),s("span",{style:{color:"#E1E4E8"}},"}")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"}")])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br"),s("span",{class:"line-number"},"5"),s("br")])]),s("p",null,"Template usage:"),s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"env"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"- "),s("span",{style:{color:"#85E89D"}},"name"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"API_KEY")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  value"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ (.config | fromJson).apiKey }}"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"- "),s("span",{style:{color:"#85E89D"}},"name"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"RATE_LIMIT")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  value"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ (.config | fromJson).limits.requests }}"')])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br"),s("span",{class:"line-number"},"5"),s("br")])]),s("h3",{id:"example-4-conditional-resources",tabindex:"-1"},[a("Example 4: Conditional Resources "),s("a",{class:"header-anchor",href:"#example-4-conditional-resources","aria-label":'Permalink to "Example 4: Conditional Resources"'},"​")]),s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# Only create Redis for premium plans")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"{{- "),s("span",{style:{color:"#9ECBFF"}},'if or (eq .planId "premium") (eq .planId "enterprise")'),s("span",{style:{color:"#E1E4E8"}}," }}")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"deployments"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"  - "),s("span",{style:{color:"#85E89D"}},"id"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"redis")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"    nameTemplate"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .uid }}-redis"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"    spec"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"      apiVersion"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"apps/v1")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"      kind"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"Deployment")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"      spec"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"        replicas"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#79B8FF"}},"1")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"        template"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"          spec"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"            containers"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"            - "),s("span",{style:{color:"#85E89D"}},"name"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"redis")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"              image"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"redis:7-alpine")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"{{- "),s("span",{style:{color:"#9ECBFF"}},"end"),s("span",{style:{color:"#E1E4E8"}}," }}")])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br"),s("span",{class:"line-number"},"5"),s("br"),s("span",{class:"line-number"},"6"),s("br"),s("span",{class:"line-number"},"7"),s("br"),s("span",{class:"line-number"},"8"),s("br"),s("span",{class:"line-number"},"9"),s("br"),s("span",{class:"line-number"},"10"),s("br"),s("span",{class:"line-number"},"11"),s("br"),s("span",{class:"line-number"},"12"),s("br"),s("span",{class:"line-number"},"13"),s("br"),s("span",{class:"line-number"},"14"),s("br"),s("span",{class:"line-number"},"15"),s("br"),s("span",{class:"line-number"},"16"),s("br")])]),s("h3",{id:"example-5-dynamic-labels",tabindex:"-1"},[a("Example 5: Dynamic Labels "),s("a",{class:"header-anchor",href:"#example-5-dynamic-labels","aria-label":'Permalink to "Example 5: Dynamic Labels"'},"​")]),s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"labelsTemplate"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  app"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .uid }}"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  node"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .uid }}"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  plan"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .planId | default '),s("span",{style:{color:"#79B8FF"}},'\\"'),s("span",{style:{color:"#9ECBFF"}},"basic"),s("span",{style:{color:"#79B8FF"}},'\\"'),s("span",{style:{color:"#9ECBFF"}},' }}"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  region"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .region | default '),s("span",{style:{color:"#79B8FF"}},'\\"'),s("span",{style:{color:"#9ECBFF"}},"global"),s("span",{style:{color:"#79B8FF"}},'\\"'),s("span",{style:{color:"#9ECBFF"}},' }}"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  managed-by"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"lynq"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  version"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .appVersion | default '),s("span",{style:{color:"#79B8FF"}},'\\"'),s("span",{style:{color:"#9ECBFF"}},"v1.0.0"),s("span",{style:{color:"#79B8FF"}},'\\"'),s("span",{style:{color:"#9ECBFF"}},' }}"')])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br"),s("span",{class:"line-number"},"5"),s("br"),s("span",{class:"line-number"},"6"),s("br"),s("span",{class:"line-number"},"7"),s("br")])])],-1)),n[16]||(n[16]=s("h2",{id:"template-best-practices",tabindex:"-1"},[a("Template Best Practices "),s("a",{class:"header-anchor",href:"#template-best-practices","aria-label":'Permalink to "Template Best Practices"'},"​")],-1)),n[17]||(n[17]=s("div",null,[s("h3",{id:"_1-use-default-values",tabindex:"-1"},[a("1. Use Default Values "),s("a",{class:"header-anchor",href:"#_1-use-default-values","aria-label":'Permalink to "1. Use Default Values"'},"​")]),s("p",null,"Always provide defaults for optional variables:"),s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# Good")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"image"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .deployImage | default '),s("span",{style:{color:"#79B8FF"}},'\\"'),s("span",{style:{color:"#9ECBFF"}},"nginx:stable"),s("span",{style:{color:"#79B8FF"}},'\\"'),s("span",{style:{color:"#9ECBFF"}},' }}"')]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# Bad (fails if deployImage is empty)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"image"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .deployImage }}"')])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br"),s("span",{class:"line-number"},"5"),s("br")])]),s("h3",{id:"_2-respect-kubernetes-naming-limits",tabindex:"-1"},[a("2. Respect Kubernetes Naming Limits "),s("a",{class:"header-anchor",href:"#_2-respect-kubernetes-naming-limits","aria-label":'Permalink to "2. Respect Kubernetes Naming Limits"'},"​")]),s("p",null,"Always truncate names that might exceed 63 characters:"),s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# Good")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"nameTemplate"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .uid }}-{{ .region }}-deployment | trunc63 }}"')]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# Bad (can exceed 63 chars)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"nameTemplate"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .uid }}-{{ .region }}-deployment"')])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br"),s("span",{class:"line-number"},"5"),s("br")])]),s("h3",{id:"_3-quote-string-values-in-yaml",tabindex:"-1"},[a("3. Quote String Values in YAML "),s("a",{class:"header-anchor",href:"#_3-quote-string-values-in-yaml","aria-label":'Permalink to "3. Quote String Values in YAML"'},"​")]),s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# Good")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"value"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .uid }}"')]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# Bad (can cause YAML parsing errors)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"value"),s("span",{style:{color:"#E1E4E8"}},": {{ "),s("span",{style:{color:"#9ECBFF"}},".uid"),s("span",{style:{color:"#E1E4E8"}}," }}")])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br"),s("span",{class:"line-number"},"5"),s("br")])]),s("h3",{id:"_4-handle-missing-variables-gracefully",tabindex:"-1"},[a("4. Handle Missing Variables Gracefully "),s("a",{class:"header-anchor",href:"#_4-handle-missing-variables-gracefully","aria-label":'Permalink to "4. Handle Missing Variables Gracefully"'},"​")]),s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# Good - provides default and checks existence")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"{{- "),s("span",{style:{color:"#9ECBFF"}},"if .optionalField"),s("span",{style:{color:"#E1E4E8"}}," }}")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"value"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .optionalField }}"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"{{- "),s("span",{style:{color:"#9ECBFF"}},"else"),s("span",{style:{color:"#E1E4E8"}}," }}")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"value"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"default-value"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"{{- "),s("span",{style:{color:"#9ECBFF"}},"end"),s("span",{style:{color:"#E1E4E8"}}," }}")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# Or simpler")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"value"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .optionalField | default '),s("span",{style:{color:"#79B8FF"}},'\\"'),s("span",{style:{color:"#9ECBFF"}},"default-value"),s("span",{style:{color:"#79B8FF"}},'\\"'),s("span",{style:{color:"#9ECBFF"}},' }}"')])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br"),s("span",{class:"line-number"},"5"),s("br"),s("span",{class:"line-number"},"6"),s("br"),s("span",{class:"line-number"},"7"),s("br"),s("span",{class:"line-number"},"8"),s("br"),s("span",{class:"line-number"},"9"),s("br")])]),s("h3",{id:"_5-use-comments-for-complex-logic",tabindex:"-1"},[a("5. Use Comments for Complex Logic "),s("a",{class:"header-anchor",href:"#_5-use-comments-for-complex-logic","aria-label":'Permalink to "5. Use Comments for Complex Logic"'},"​")]),s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# Calculate replicas based on plan tier")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# enterprise: 5, premium: 3, basic: 2")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"replicas"),s("span",{style:{color:"#E1E4E8"}},": {{- "),s("span",{style:{color:"#9ECBFF"}},'if eq .planId "enterprise"'),s("span",{style:{color:"#E1E4E8"}}," }}"),s("span",{style:{color:"#9ECBFF"}},'5{{- else if eq .planId "premium" }}3{{- else }}2{{- end }}')])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br")])])],-1)),n[18]||(n[18]=s("h2",{id:"template-rendering-process",tabindex:"-1"},[a("Template Rendering Process "),s("a",{class:"header-anchor",href:"#template-rendering-process","aria-label":'Permalink to "Template Rendering Process"'},"​")],-1)),n[19]||(n[19]=s("div",null,[s("h3",{id:"_1-variable-collection",tabindex:"-1"},[a("1. Variable Collection "),s("a",{class:"header-anchor",href:"#_1-variable-collection","aria-label":'Permalink to "1. Variable Collection"'},"​")]),s("p",null,"Hub controller collects variables from database row:"),s("div",{class:"language- line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",null,'uid = "acme-corp"')]),a(`
`),s("span",{class:"line"},[s("span",null,'# hostOrUrl = "https://acme.example.com"  # DEPRECATED v1.1.11+')]),a(`
`),s("span",{class:"line"},[s("span",null,"activate = true")]),a(`
`),s("span",{class:"line"},[s("span",null,'planId = "enterprise"')]),a(`
`),s("span",{class:"line"},[s("span",null,'customUrl = "https://acme.example.com"  # Use extraValueMappings instead')])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br"),s("span",{class:"line-number"},"5"),s("br")])]),s("h3",{id:"_2-auto-processing-deprecated",tabindex:"-1"},[a("2. Auto-Processing (Deprecated) "),s("a",{class:"header-anchor",href:"#_2-auto-processing-deprecated","aria-label":'Permalink to "2. Auto-Processing (Deprecated)"'},"​")]),s("p",null,[s("strong",null,"Note:"),a(" This step is deprecated since v1.1.11.")]),s("p",null,[s("s",null,[a("Operator automatically extracts "),s("code",null,".host"),a(":")])]),s("div",{class:"language- line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",null,'# .host = "acme.example.com"  # DEPRECATED - extracted from .hostOrUrl')])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br")])]),s("p",null,[s("strong",null,"New approach (v1.1.11+):"),a(" Use "),s("code",null,"toHost()"),a(" function in templates:")]),s("div",{class:"language- line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"}),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",null,"# In template:")]),a(`
`),s("span",{class:"line"},[s("span",null,'value: "{{ .customUrl | toHost }}"  # Extracts "acme.example.com"')])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br")])]),s("h3",{id:"_3-template-evaluation",tabindex:"-1"},[a("3. Template Evaluation "),s("a",{class:"header-anchor",href:"#_3-template-evaluation","aria-label":'Permalink to "3. Template Evaluation"'},"​")]),s("p",null,"For each resource in the template:"),s("ul",null,[s("li",null,[a("Render "),s("code",null,"nameTemplate"),a(" → resource name")]),s("li",null,[a("Render "),s("code",null,"labelsTemplate"),a(" → labels")]),s("li",null,[a("Render "),s("code",null,"annotationsTemplate"),a(" → annotations")]),s("li",null,[a("Render "),s("code",null,"spec"),a(" → recursively render all string values in the resource")])]),s("h3",{id:"_4-resource-creation",tabindex:"-1"},[a("4. Resource Creation "),s("a",{class:"header-anchor",href:"#_4-resource-creation","aria-label":'Permalink to "4. Resource Creation"'},"​")]),s("p",null,"Rendered resource is applied to Kubernetes using Server-Side Apply."),s("h2",{id:"debugging-templates",tabindex:"-1"},[a("Debugging Templates "),s("a",{class:"header-anchor",href:"#debugging-templates","aria-label":'Permalink to "Debugging Templates"'},"​")]),s("h3",{id:"check-rendered-values",tabindex:"-1"},[a("Check Rendered Values "),s("a",{class:"header-anchor",href:"#check-rendered-values","aria-label":'Permalink to "Check Rendered Values"'},"​")]),s("p",null,"View rendered LynqNode CR to see evaluated templates:"),s("div",{class:"language-bash line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# Get LynqNode CR")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#B392F0"}},"kubectl"),s("span",{style:{color:"#9ECBFF"}}," get"),s("span",{style:{color:"#9ECBFF"}}," lynqnode"),s("span",{style:{color:"#F97583"}}," <"),s("span",{style:{color:"#9ECBFF"}},"lynqnode-nam"),s("span",{style:{color:"#E1E4E8"}},"e"),s("span",{style:{color:"#F97583"}},">"),s("span",{style:{color:"#79B8FF"}}," -o"),s("span",{style:{color:"#9ECBFF"}}," yaml")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# Check spec (contains rendered resources)")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#B392F0"}},"kubectl"),s("span",{style:{color:"#9ECBFF"}}," get"),s("span",{style:{color:"#9ECBFF"}}," lynqnode"),s("span",{style:{color:"#F97583"}}," <"),s("span",{style:{color:"#9ECBFF"}},"lynqnode-nam"),s("span",{style:{color:"#E1E4E8"}},"e"),s("span",{style:{color:"#F97583"}},">"),s("span",{style:{color:"#79B8FF"}}," -o"),s("span",{style:{color:"#9ECBFF"}}," jsonpath='{.spec.deployments[0].nameTemplate}'")])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br"),s("span",{class:"line-number"},"5"),s("br")])]),s("h3",{id:"watch-for-rendering-errors",tabindex:"-1"},[a("Watch for Rendering Errors "),s("a",{class:"header-anchor",href:"#watch-for-rendering-errors","aria-label":'Permalink to "Watch for Rendering Errors"'},"​")]),s("div",{class:"language-bash line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"bash"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# Check operator logs")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#B392F0"}},"kubectl"),s("span",{style:{color:"#9ECBFF"}}," logs"),s("span",{style:{color:"#79B8FF"}}," -n"),s("span",{style:{color:"#9ECBFF"}}," lynq-system"),s("span",{style:{color:"#9ECBFF"}}," deployment/lynq-controller-manager"),s("span",{style:{color:"#79B8FF"}}," -f"),s("span",{style:{color:"#F97583"}}," |"),s("span",{style:{color:"#B392F0"}}," grep"),s("span",{style:{color:"#9ECBFF"}},' "render"')]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# Check Node events")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#B392F0"}},"kubectl"),s("span",{style:{color:"#9ECBFF"}}," describe"),s("span",{style:{color:"#9ECBFF"}}," lynqnode"),s("span",{style:{color:"#F97583"}}," <"),s("span",{style:{color:"#9ECBFF"}},"lynqnode-nam"),s("span",{style:{color:"#E1E4E8"}},"e"),s("span",{style:{color:"#F97583"}},">")])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br"),s("span",{class:"line-number"},"5"),s("br")])]),s("h3",{id:"common-errors",tabindex:"-1"},[a("Common Errors "),s("a",{class:"header-anchor",href:"#common-errors","aria-label":'Permalink to "Common Errors"'},"​")]),s("p",null,[s("strong",null,"Error:"),a(),s("code",null,'template: tmpl:1: function "unknownFunc" not defined')]),s("ul",null,[s("li",null,[s("strong",null,"Cause:"),a(" Using a function that doesn't exist")]),s("li",null,[s("strong",null,"Fix:"),a(" Check "),s("a",{href:"https://masterminds.github.io/sprig/",target:"_blank",rel:"noreferrer"},"Sprig docs"),a(" or "),s("a",{href:"#built-in-custom-functions"},"Custom Functions")])]),s("p",null,[s("strong",null,"Error:"),a(),s("code",null,'template: tmpl:1:10: executing "tmpl" at <.missingVar>: map has no entry for key "missingVar"')]),s("ul",null,[s("li",null,[s("strong",null,"Cause:"),a(" Referencing a variable that doesn't exist")]),s("li",null,[s("strong",null,"Fix:"),a(" Use "),s("code",null,"default"),a(" function or check "),s("code",null,"extraValueMappings")])]),s("p",null,[s("strong",null,"Error:"),a(),s("code",null,"yaml: line 10: mapping values are not allowed in this context")]),s("ul",null,[s("li",null,[s("strong",null,"Cause:"),a(" Missing quotes around template")]),s("li",null,[s("strong",null,"Fix:"),a(" Always quote templates: "),s("code",null,'"{{ .value }}"')])]),s("h2",{id:"advanced-template-techniques",tabindex:"-1"},[a("Advanced Template Techniques "),s("a",{class:"header-anchor",href:"#advanced-template-techniques","aria-label":'Permalink to "Advanced Template Techniques"'},"​")]),s("h3",{id:"nested-templates",tabindex:"-1"},[a("Nested Templates "),s("a",{class:"header-anchor",href:"#nested-templates","aria-label":'Permalink to "Nested Templates"'},"​")]),s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# Define reusable template values")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"{{- "),s("span",{style:{color:"#9ECBFF"}},'$appName := printf "%s-app" .uid'),s("span",{style:{color:"#E1E4E8"}}," }}")]),a(`
`),s("span",{class:"line"}),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"nameTemplate"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ $appName }}"')])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br")])]),s("h3",{id:"range-over-lists",tabindex:"-1"},[a("Range Over Lists "),s("a",{class:"header-anchor",href:"#range-over-lists","aria-label":'Permalink to "Range Over Lists"'},"​")]),s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# In ConfigMap data field")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"data"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  endpoints.txt"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#F97583"}},"|")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9ECBFF"}},'    {{- range $i, $region := list "us-east-1" "us-west-2" "eu-west-1" }}')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9ECBFF"}},"    {{ $region }}.example.com")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#9ECBFF"}},"    {{- end }}")])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br"),s("span",{class:"line-number"},"5"),s("br"),s("span",{class:"line-number"},"6"),s("br")])]),s("h3",{id:"complex-json-parsing",tabindex:"-1"},[a("Complex JSON Parsing "),s("a",{class:"header-anchor",href:"#complex-json-parsing","aria-label":'Permalink to "Complex JSON Parsing"'},"​")]),s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},`# Database field: config = '{"db":{"host":"localhost","port":5432}}'`)]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"env"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"- "),s("span",{style:{color:"#85E89D"}},"name"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"DB_HOST")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  value"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ ((.config | fromJson).db).host }}"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"- "),s("span",{style:{color:"#85E89D"}},"name"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"DB_PORT")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  value"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ ((.config | fromJson).db).port }}"')])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br"),s("span",{class:"line-number"},"5"),s("br"),s("span",{class:"line-number"},"6"),s("br")])])],-1)),n[20]||(n[20]=s("h2",{id:"template-evolution",tabindex:"-1"},[a("Template Evolution "),s("a",{class:"header-anchor",href:"#template-evolution","aria-label":'Permalink to "Template Evolution"'},"​")],-1)),n[21]||(n[21]=s("div",{class:"tip custom-block"},[s("p",{class:"custom-block-title"},"Dynamic Updates"),s("p",null,"LynqForms can be safely modified at runtime. The operator automatically handles resource additions, modifications, and removals.")],-1)),n[22]||(n[22]=s("div",null,[s("h3",{id:"adding-resources",tabindex:"-1"},[a("Adding Resources "),s("a",{class:"header-anchor",href:"#adding-resources","aria-label":'Permalink to "Adding Resources"'},"​")]),s("p",null,"New resources are automatically created during the next reconciliation:"),s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# Add a new service to existing template")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"services"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"  - "),s("span",{style:{color:"#85E89D"}},"id"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"api-service")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"    nameTemplate"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .uid }}-api"')]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"    spec"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"      apiVersion"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"v1")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"      kind"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"Service")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"      # ... service spec")])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br"),s("span",{class:"line-number"},"5"),s("br"),s("span",{class:"line-number"},"6"),s("br"),s("span",{class:"line-number"},"7"),s("br"),s("span",{class:"line-number"},"8"),s("br")])]),s("p",null,[s("strong",null,"Result:"),a(" Service is created for all existing LynqNodes using this template.")]),s("h3",{id:"modifying-resources",tabindex:"-1"},[a("Modifying Resources "),s("a",{class:"header-anchor",href:"#modifying-resources","aria-label":'Permalink to "Modifying Resources"'},"​")]),s("p",null,[a("Existing resources are updated according to their "),s("code",null,"patchStrategy"),a(":")]),s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"deployments"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"  - "),s("span",{style:{color:"#85E89D"}},"id"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"web")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"    patchStrategy"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"apply"),s("span",{style:{color:"#6A737D"}},"  # SSA updates managed fields only")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"    spec"),s("span",{style:{color:"#E1E4E8"}},":")]),a(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"      # Modified spec here")])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br"),s("span",{class:"line-number"},"5"),s("br")])]),s("p",null,[s("strong",null,"Result:"),a(" Resources are updated while preserving unmanaged fields.")]),s("h3",{id:"removing-resources",tabindex:"-1"},[a("Removing Resources "),s("a",{class:"header-anchor",href:"#removing-resources","aria-label":'Permalink to "Removing Resources"'},"​")]),s("div",{class:"warning custom-block"},[s("p",{class:"custom-block-title"},"Orphan Cleanup"),s("p",null,[a("Removed resources are automatically deleted or retained based on their "),s("code",null,"deletionPolicy"),a(".")])])],-1)),n[23]||(n[23]=e(`<p><strong>Example:</strong></p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Before: Template has 3 deployments</span></span>
<span class="line"><span style="color:#85E89D;">deployments</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">web</span></span>
<span class="line"><span style="color:#85E89D;">    deletionPolicy</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Delete</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">worker</span></span>
<span class="line"><span style="color:#85E89D;">    deletionPolicy</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Retain</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">cache</span></span>
<span class="line"><span style="color:#85E89D;">    deletionPolicy</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Delete</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># After: Removed worker and cache</span></span>
<span class="line"><span style="color:#85E89D;">deployments</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">web</span></span>
<span class="line"><span style="color:#85E89D;">    deletionPolicy</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Delete</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>Result:</strong></p><ul><li><code>worker</code> deployment: <strong>Retained</strong> in cluster with orphan labels (no ownerReference was set initially)</li><li><code>cache</code> deployment: <strong>Deleted</strong> from cluster (via ownerReference)</li><li><code>web</code> deployment: Continues to be managed normally</li></ul><p><strong>Orphan markers added to retained resources:</strong></p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">  labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">    lynq.sh/orphaned</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;true&quot;</span><span style="color:#6A737D;">  # Label for selector queries</span></span>
<span class="line"><span style="color:#85E89D;">  annotations</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">    lynq.sh/orphaned-at</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;2025-01-15T10:30:00Z&quot;</span><span style="color:#6A737D;">  # RFC3339 timestamp</span></span>
<span class="line"><span style="color:#85E89D;">    lynq.sh/orphaned-reason</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;RemovedFromTemplate&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>Why label + annotation?</strong></p><ul><li>Label values must be RFC 1123 compliant (no colons), so we use simple <code>&quot;true&quot;</code> for selectors</li><li>Annotations can store detailed metadata like timestamps without format restrictions</li></ul><p><strong>Re-adoption of Orphaned Resources:</strong></p><p>When you re-add a previously removed resource back to the template:</p><ul><li>Operator automatically detects and removes all orphan markers</li><li>Resource smoothly transitions back to managed state</li><li>No manual intervention needed</li></ul><p>This enables safe experimentation:</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Day 1: Remove worker deployment</span></span>
<span class="line"><span style="color:#85E89D;">deployments</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">web</span><span style="color:#6A737D;">  # worker removed</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Day 2: Re-add worker deployment</span></span>
<span class="line"><span style="color:#85E89D;">deployments</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">web</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">id</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">worker</span><span style="color:#6A737D;">  # Re-added! Orphan markers auto-removed</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>You can easily find these orphaned resources later:</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Find all orphaned resources (using label selector)</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> get</span><span style="color:#9ECBFF;"> all</span><span style="color:#79B8FF;"> -A</span><span style="color:#79B8FF;"> -l</span><span style="color:#9ECBFF;"> lynq.sh/orphaned=</span><span style="color:#79B8FF;">true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Find resources orphaned due to template changes (filter by annotation)</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> get</span><span style="color:#9ECBFF;"> all</span><span style="color:#79B8FF;"> -A</span><span style="color:#79B8FF;"> -l</span><span style="color:#9ECBFF;"> lynq.sh/orphaned=</span><span style="color:#79B8FF;">true</span><span style="color:#79B8FF;"> -o</span><span style="color:#9ECBFF;"> jsonpath=&#39;{range .items[?(@.metadata.annotations.k8s-lynq\\.org/orphaned-reason==&quot;RemovedFromTemplate&quot;)]}{.kind}/{.metadata.name}{&quot;\\n&quot;}{end}&#39;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>How it works:</strong></p><ol><li>Operator tracks applied resources in <code>LynqNode.status.appliedResources</code></li><li>During reconciliation, compares current template with previous state</li><li>Detects orphaned resources (in status but not in template)</li><li>Applies each resource&#39;s <code>deletionPolicy</code>: <ul><li><code>Delete</code>: Removes from cluster (automatic via ownerReference)</li><li><code>Retain</code>: Removes tracking labels, adds orphan labels, keeps resource (no ownerReference to remove)</li></ul></li></ol><p><strong>Benefits:</strong></p><ul><li>✅ Safe template evolution without manual intervention</li><li>✅ No accumulation of orphaned resources</li><li>✅ Consistent behavior across all deletion scenarios</li><li>✅ Automatic during normal reconciliation (no special operation needed)</li></ul><h3 id="best-practices-for-template-changes" tabindex="-1">Best Practices for Template Changes <a class="header-anchor" href="#best-practices-for-template-changes" aria-label="Permalink to &quot;Best Practices for Template Changes&quot;">​</a></h3><ol><li><strong>Test in non-production first</strong>: Validate template changes in dev/staging</li><li><strong>Use appropriate deletion policies</strong>: <ul><li><code>Delete</code> for stateless resources (Deployments, Services)</li><li><code>Retain</code> for stateful resources (PVCs, databases)</li></ul></li><li><strong>Review <code>appliedResources</code> status</strong>: Check what resources are currently tracked</li><li><strong>Monitor reconciliation</strong>: Watch operator logs during template updates</li><li><strong>Use <code>creationPolicy: Once</code></strong> for resources that shouldn&#39;t be updated</li></ol><p><strong>Example workflow:</strong></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># 1. Check current applied resources</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> get</span><span style="color:#9ECBFF;"> lynqnode</span><span style="color:#79B8FF;"> -o</span><span style="color:#9ECBFF;"> jsonpath=&#39;{.status.appliedResources}&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 2. Update template</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> apply</span><span style="color:#79B8FF;"> -f</span><span style="color:#9ECBFF;"> updated-template.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 3. Monitor reconciliation</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> logs</span><span style="color:#79B8FF;"> -n</span><span style="color:#9ECBFF;"> lynq-system</span><span style="color:#9ECBFF;"> deployment/lynq-controller-manager</span><span style="color:#79B8FF;"> -f</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 4. Verify changes</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> get</span><span style="color:#9ECBFF;"> lynqnode</span><span style="color:#79B8FF;"> -o</span><span style="color:#9ECBFF;"> yaml</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="see-also" tabindex="-1">See Also <a class="header-anchor" href="#see-also" aria-label="Permalink to &quot;See Also&quot;">​</a></h2><ul><li><a href="./policies.html">Policies Guide</a> - Creation/deletion/conflict policies</li><li><a href="./dependencies.html">Dependencies Guide</a> - Resource ordering</li><li><a href="./api.html">API Reference</a> - Complete CRD schema</li></ul>`,25))])}const B=p(b,[["render",m]]);export{C as __pageData,B as default};
