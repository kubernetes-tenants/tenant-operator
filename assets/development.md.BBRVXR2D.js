import{_ as p,C as r,c as o,o as n,a2 as a,b as t,w as e,a as i,G as c,a5 as u}from"./chunks/framework.BNM54Z5_.js";const B=JSON.parse('{"title":"Development Guide","description":"","frontmatter":{},"headers":[],"relativePath":"development.md","filePath":"development.md","lastUpdated":1762323966000}'),d={name:"development.md"};function b(m,s,y,h,g,F){const l=r("Mermaid");return n(),o("div",null,[s[1]||(s[1]=a(`<h1 id="development-guide" tabindex="-1">Development Guide <a class="header-anchor" href="#development-guide" aria-label="Permalink to &quot;Development Guide&quot;">â€‹</a></h1><p>Guide for developing and contributing to Tenant Operator.</p><nav class="table-of-contents"><ul><li><a href="#setup">Setup</a><ul><li><a href="#prerequisites">Prerequisites</a></li><li><a href="#clone-repository">Clone Repository</a></li><li><a href="#install-dependencies">Install Dependencies</a></li></ul></li><li><a href="#local-development">Local Development</a><ul><li><a href="#running-locally">Running Locally</a></li><li><a href="#testing-against-local-cluster">Testing Against Local Cluster</a></li></ul></li><li><a href="#building">Building</a><ul><li><a href="#build-binary">Build Binary</a></li><li><a href="#build-container-image">Build Container Image</a></li></ul></li><li><a href="#testing">Testing</a><ul><li><a href="#unit-tests">Unit Tests</a></li><li><a href="#integration-tests">Integration Tests</a></li><li><a href="#e2e-tests">E2E Tests</a></li></ul></li><li><a href="#code-quality">Code Quality</a><ul><li><a href="#linting">Linting</a></li><li><a href="#formatting">Formatting</a></li><li><a href="#generate-code">Generate Code</a></li></ul></li><li><a href="#project-structure">Project Structure</a></li><li><a href="#adding-features">Adding Features</a><ul><li><a href="#new-crd-field">New CRD Field</a></li><li><a href="#new-controller">New Controller</a></li></ul></li><li><a href="#adding-a-new-datasource">Adding a New Datasource</a><ul><li><a href="#architecture">Architecture</a></li><li><a href="#quick-reference">Quick Reference</a></li><li><a href="#full-guide">Full Guide</a></li><li><a href="#key-files">Key Files</a></li><li><a href="#example-study-mysql-adapter">Example: Study MySQL Adapter</a></li><li><a href="#development-workflow">Development Workflow</a></li><li><a href="#common-patterns">Common Patterns</a></li><li><a href="#tips">Tips</a></li></ul></li><li><a href="#contributing">Contributing</a><ul><li><a href="#workflow">Workflow</a></li><li><a href="#conventional-commits">Conventional Commits</a></li><li><a href="#pull-request-template">Pull Request Template</a></li></ul></li><li><a href="#release-process">Release Process</a><ul><li><a href="#version-bump">Version Bump</a></li></ul></li><li><a href="#useful-commands">Useful Commands</a></li><li><a href="#see-also">See Also</a></li></ul></nav><div class="tip custom-block"><p class="custom-block-title">First time here?</p><p>Start with the <a href="./quickstart.html">Quick Start guide</a> to get familiar with the system before diving into development tooling.</p></div><h2 id="setup" tabindex="-1">Setup <a class="header-anchor" href="#setup" aria-label="Permalink to &quot;Setup&quot;">â€‹</a></h2><h3 id="prerequisites" tabindex="-1">Prerequisites <a class="header-anchor" href="#prerequisites" aria-label="Permalink to &quot;Prerequisites&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>Tool</th><th>Version / Notes</th></tr></thead><tbody><tr><td>Go</td><td>1.22+</td></tr><tr><td>kubectl</td><td>Matches target cluster</td></tr><tr><td>kind or minikube</td><td>Local cluster for testing</td></tr><tr><td>Docker</td><td>Required for image builds</td></tr><tr><td>make</td><td>Used for build/test helpers</td></tr></tbody></table><h3 id="clone-repository" tabindex="-1">Clone Repository <a class="header-anchor" href="#clone-repository" aria-label="Permalink to &quot;Clone Repository&quot;">â€‹</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">git</span><span style="color:#9ECBFF;"> clone</span><span style="color:#9ECBFF;"> https://github.com/kubernetes-tenants/tenant-operator.git</span></span>
<span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#9ECBFF;"> tenant-operator</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="install-dependencies" tabindex="-1">Install Dependencies <a class="header-anchor" href="#install-dependencies" aria-label="Permalink to &quot;Install Dependencies&quot;">â€‹</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">go</span><span style="color:#9ECBFF;"> mod</span><span style="color:#9ECBFF;"> download</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="local-development" tabindex="-1">Local Development <a class="header-anchor" href="#local-development" aria-label="Permalink to &quot;Local Development&quot;">â€‹</a></h2><h3 id="running-locally" tabindex="-1">Running Locally <a class="header-anchor" href="#running-locally" aria-label="Permalink to &quot;Running Locally&quot;">â€‹</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Install CRDs</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> install</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Run controller locally (uses ~/.kube/config)</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> run</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Run with debug logging</span></span>
<span class="line"><span style="color:#E1E4E8;">LOG_LEVEL</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">debug</span><span style="color:#B392F0;"> make</span><span style="color:#9ECBFF;"> run</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="warning custom-block"><p class="custom-block-title">Local Run Limitations</p><p><code>make run</code> runs the operator outside the cluster, which means:</p><ul><li>âš ï¸ <strong>Webhooks are NOT available</strong> (no TLS certificates)</li><li>âš ï¸ <strong>No validation</strong> at admission time (invalid configs will only fail at reconciliation)</li><li>âš ï¸ <strong>No defaulting</strong> (all fields must be specified explicitly)</li></ul><p><strong>For complete testing with webhooks</strong>, deploy to cluster with cert-manager:</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># See Local Development with Minikube guide</span></span>
<span class="line"><span style="color:#B392F0;">./scripts/deploy-to-minikube.sh</span><span style="color:#6A737D;">  # Includes cert-manager and webhooks</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>When to use <code>make run</code></strong>:</p><ul><li>Quick iteration on controller logic</li><li>Testing reconciliation loops</li><li>Debugging without webhook complications</li></ul><p><strong>When to deploy to cluster</strong>:</p><ul><li>Testing webhooks (validation/defaulting)</li><li>Final testing before committing</li><li>Verifying production-like behavior</li></ul></div><h3 id="testing-against-local-cluster" tabindex="-1">Testing Against Local Cluster <a class="header-anchor" href="#testing-against-local-cluster" aria-label="Permalink to &quot;Testing Against Local Cluster&quot;">â€‹</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Create kind cluster</span></span>
<span class="line"><span style="color:#B392F0;">kind</span><span style="color:#9ECBFF;"> create</span><span style="color:#9ECBFF;"> cluster</span><span style="color:#79B8FF;"> --name</span><span style="color:#9ECBFF;"> tenant-operator-dev</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Install CRDs</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> install</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Run operator</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> run</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="building" tabindex="-1">Building <a class="header-anchor" href="#building" aria-label="Permalink to &quot;Building&quot;">â€‹</a></h2><h3 id="build-binary" tabindex="-1">Build Binary <a class="header-anchor" href="#build-binary" aria-label="Permalink to &quot;Build Binary&quot;">â€‹</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Build for current platform</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> build</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Binary output: bin/manager</span></span>
<span class="line"><span style="color:#B392F0;">./bin/manager</span><span style="color:#79B8FF;"> --help</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="build-container-image" tabindex="-1">Build Container Image <a class="header-anchor" href="#build-container-image" aria-label="Permalink to &quot;Build Container Image&quot;">â€‹</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Build image</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> docker-build</span><span style="color:#9ECBFF;"> IMG=myregistry/tenant-operator:dev</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Push image</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> docker-push</span><span style="color:#9ECBFF;"> IMG=myregistry/tenant-operator:dev</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Build multi-platform</span></span>
<span class="line"><span style="color:#B392F0;">docker</span><span style="color:#9ECBFF;"> buildx</span><span style="color:#9ECBFF;"> build</span><span style="color:#79B8FF;"> --platform</span><span style="color:#9ECBFF;"> linux/amd64,linux/arm64</span><span style="color:#79B8FF;"> \\</span></span>
<span class="line"><span style="color:#79B8FF;">  -t</span><span style="color:#9ECBFF;"> myregistry/tenant-operator:dev</span><span style="color:#79B8FF;"> \\</span></span>
<span class="line"><span style="color:#79B8FF;">  --push</span><span style="color:#9ECBFF;"> .</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="testing" tabindex="-1">Testing <a class="header-anchor" href="#testing" aria-label="Permalink to &quot;Testing&quot;">â€‹</a></h2><h3 id="unit-tests" tabindex="-1">Unit Tests <a class="header-anchor" href="#unit-tests" aria-label="Permalink to &quot;Unit Tests&quot;">â€‹</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Run all unit tests</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> test</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Run with coverage</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> test-coverage</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># View coverage report</span></span>
<span class="line"><span style="color:#B392F0;">go</span><span style="color:#9ECBFF;"> tool</span><span style="color:#9ECBFF;"> cover</span><span style="color:#79B8FF;"> -html=cover.out</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="integration-tests" tabindex="-1">Integration Tests <a class="header-anchor" href="#integration-tests" aria-label="Permalink to &quot;Integration Tests&quot;">â€‹</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Run integration tests (requires cluster)</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> test-integration</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="warning custom-block"><p class="custom-block-title">Cluster required</p><p>Integration and E2E suites create and mutate Kubernetes resources. Run them against disposable clusters.</p></div><h3 id="e2e-tests" tabindex="-1">E2E Tests <a class="header-anchor" href="#e2e-tests" aria-label="Permalink to &quot;E2E Tests&quot;">â€‹</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Create test cluster</span></span>
<span class="line"><span style="color:#B392F0;">kind</span><span style="color:#9ECBFF;"> create</span><span style="color:#9ECBFF;"> cluster</span><span style="color:#79B8FF;"> --name</span><span style="color:#9ECBFF;"> e2e-test</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Run E2E tests</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> test-e2e</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Cleanup</span></span>
<span class="line"><span style="color:#B392F0;">kind</span><span style="color:#9ECBFF;"> delete</span><span style="color:#9ECBFF;"> cluster</span><span style="color:#79B8FF;"> --name</span><span style="color:#9ECBFF;"> e2e-test</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="code-quality" tabindex="-1">Code Quality <a class="header-anchor" href="#code-quality" aria-label="Permalink to &quot;Code Quality&quot;">â€‹</a></h2><h3 id="linting" tabindex="-1">Linting <a class="header-anchor" href="#linting" aria-label="Permalink to &quot;Linting&quot;">â€‹</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Run linter</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> lint</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Auto-fix issues</span></span>
<span class="line"><span style="color:#B392F0;">golangci-lint</span><span style="color:#9ECBFF;"> run</span><span style="color:#79B8FF;"> --fix</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="formatting" tabindex="-1">Formatting <a class="header-anchor" href="#formatting" aria-label="Permalink to &quot;Formatting&quot;">â€‹</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Format code</span></span>
<span class="line"><span style="color:#B392F0;">go</span><span style="color:#9ECBFF;"> fmt</span><span style="color:#9ECBFF;"> ./...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Or use goimports</span></span>
<span class="line"><span style="color:#B392F0;">goimports</span><span style="color:#79B8FF;"> -w</span><span style="color:#9ECBFF;"> .</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="generate-code" tabindex="-1">Generate Code <a class="header-anchor" href="#generate-code" aria-label="Permalink to &quot;Generate Code&quot;">â€‹</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Generate CRD manifests, RBAC, etc.</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> generate</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Generate DeepCopy methods</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> manifests</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="project-structure" tabindex="-1">Project Structure <a class="header-anchor" href="#project-structure" aria-label="Permalink to &quot;Project Structure&quot;">â€‹</a></h2><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>tenant-operator/</span></span>
<span class="line"><span>â”œâ”€â”€ api/v1/                    # CRD types</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ tenant_types.go</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ tenantregistry_types.go</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ tenanttemplate_types.go</span></span>
<span class="line"><span>â”‚   â””â”€â”€ common_types.go</span></span>
<span class="line"><span>â”œâ”€â”€ internal/controller/       # Controllers</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ tenant_controller.go</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ tenantregistry_controller.go</span></span>
<span class="line"><span>â”‚   â””â”€â”€ tenanttemplate_controller.go</span></span>
<span class="line"><span>â”œâ”€â”€ internal/apply/            # SSA apply engine</span></span>
<span class="line"><span>â”œâ”€â”€ internal/database/         # Database connectors</span></span>
<span class="line"><span>â”œâ”€â”€ internal/graph/            # Dependency graph</span></span>
<span class="line"><span>â”œâ”€â”€ internal/readiness/        # Readiness checks</span></span>
<span class="line"><span>â”œâ”€â”€ internal/template/         # Template engine</span></span>
<span class="line"><span>â”œâ”€â”€ internal/metrics/          # Prometheus metrics</span></span>
<span class="line"><span>â”œâ”€â”€ config/                    # Kustomize configs</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ crd/                   # CRD manifests</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ rbac/                  # RBAC configs</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ manager/               # Deployment configs</span></span>
<span class="line"><span>â”‚   â””â”€â”€ samples/               # Example CRs</span></span>
<span class="line"><span>â”œâ”€â”€ test/                      # Tests</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ e2e/                   # E2E tests</span></span>
<span class="line"><span>â”‚   â””â”€â”€ utils/                 # Test utilities</span></span>
<span class="line"><span>â”œâ”€â”€ docs/                      # Documentation</span></span>
<span class="line"><span>â””â”€â”€ cmd/                       # Entry point</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h2 id="adding-features" tabindex="-1">Adding Features <a class="header-anchor" href="#adding-features" aria-label="Permalink to &quot;Adding Features&quot;">â€‹</a></h2><h3 id="new-crd-field" tabindex="-1">New CRD Field <a class="header-anchor" href="#new-crd-field" aria-label="Permalink to &quot;New CRD Field&quot;">â€‹</a></h3><ol><li>Update API types:</li></ol><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// api/v1/tenant_types.go</span></span>
<span class="line"><span style="color:#F97583;">type</span><span style="color:#B392F0;"> TenantSpec</span><span style="color:#F97583;"> struct</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    NewField </span><span style="color:#F97583;">string</span><span style="color:#9ECBFF;"> \`json:&quot;newField,omitempty&quot;\`</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol start="2"><li>Generate code:</li></ol><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> generate</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> manifests</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="3"><li><p>Update controller logic</p></li><li><p>Add tests</p></li><li><p>Update documentation</p></li></ol><h3 id="new-controller" tabindex="-1">New Controller <a class="header-anchor" href="#new-controller" aria-label="Permalink to &quot;New Controller&quot;">â€‹</a></h3><ol><li>Create controller file:</li></ol><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// internal/controller/myresource_controller.go</span></span>
<span class="line"><span style="color:#F97583;">package</span><span style="color:#B392F0;"> controller</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">type</span><span style="color:#B392F0;"> MyResourceReconciler</span><span style="color:#F97583;"> struct</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#B392F0;">    client</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">Client</span></span>
<span class="line"><span style="color:#E1E4E8;">    Scheme </span><span style="color:#F97583;">*</span><span style="color:#B392F0;">runtime</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">Scheme</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">func</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">r </span><span style="color:#F97583;">*</span><span style="color:#B392F0;">MyResourceReconciler</span><span style="color:#E1E4E8;">) </span><span style="color:#B392F0;">Reconcile</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">ctx</span><span style="color:#B392F0;"> context</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">Context</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">req</span><span style="color:#B392F0;"> ctrl</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">Request</span><span style="color:#E1E4E8;">) (</span><span style="color:#B392F0;">ctrl</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">Result</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">error</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#6A737D;">    // Implementation</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ol start="2"><li>Register controller:</li></ol><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">// cmd/main.go</span></span>
<span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> err </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> (</span><span style="color:#F97583;">&amp;</span><span style="color:#B392F0;">controller</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">MyResourceReconciler</span><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    Client: mgr.</span><span style="color:#B392F0;">GetClient</span><span style="color:#E1E4E8;">(),</span></span>
<span class="line"><span style="color:#E1E4E8;">    Scheme: mgr.</span><span style="color:#B392F0;">GetScheme</span><span style="color:#E1E4E8;">(),</span></span>
<span class="line"><span style="color:#E1E4E8;">}).</span><span style="color:#B392F0;">SetupWithManager</span><span style="color:#E1E4E8;">(mgr); err </span><span style="color:#F97583;">!=</span><span style="color:#79B8FF;"> nil</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#6A737D;">    // Handle error</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ol start="3"><li>Add tests</li></ol><h2 id="adding-a-new-datasource" tabindex="-1">Adding a New Datasource <a class="header-anchor" href="#adding-a-new-datasource" aria-label="Permalink to &quot;Adding a New Datasource&quot;">â€‹</a></h2><p>Tenant Operator uses a pluggable adapter pattern for datasources, making it easy to add support for new databases or data sources.</p><h3 id="architecture" tabindex="-1">Architecture <a class="header-anchor" href="#architecture" aria-label="Permalink to &quot;Architecture&quot;">â€‹</a></h3>`,55)),(n(),t(u,null,{default:e(()=>[c(l,{id:"mermaid-283",class:"mermaid my-class",graph:"flowchart%20LR%0A%20%20%20%20Controller%5BRegistry%3Cbr%2F%3EController%5D%0A%20%20%20%20Interface%5BDatasource%3Cbr%2F%3EInterface%5D%0A%20%20%20%20MySQL%5BMySQL%3Cbr%2F%3EAdapter%5D%0A%20%20%20%20Postgres%5BPostgreSQL%3Cbr%2F%3EAdapter%5D%0A%20%20%20%20Custom%5BYour%3Cbr%2F%3EAdapter%5D%0A%0A%20%20%20%20Controller%20--%3E%20Interface%0A%20%20%20%20Interface%20-.-%3E%20MySQL%0A%20%20%20%20Interface%20-.-%3E%20Postgres%0A%20%20%20%20Interface%20-.-%3E%20Custom%0A%0A%20%20%20%20classDef%20interface%20fill%3A%23fff3e0%2Cstroke%3A%23ffb74d%0A%20%20%20%20classDef%20adapter%20fill%3A%23e3f2fd%2Cstroke%3A%2364b5f6%0A%20%20%20%20class%20Interface%20interface%0A%20%20%20%20class%20MySQL%2CPostgres%2CCustom%20adapter%0A"})]),fallback:e(()=>[...s[0]||(s[0]=[i(" Loading... ",-1)])]),_:1})),s[2]||(s[2]=a(`<h3 id="quick-reference" tabindex="-1">Quick Reference <a class="header-anchor" href="#quick-reference" aria-label="Permalink to &quot;Quick Reference&quot;">â€‹</a></h3><p><strong>1. Implement Interface</strong> (<code>internal/datasource/your_adapter.go</code>):</p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">package</span><span style="color:#B392F0;"> datasource</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">type</span><span style="color:#B392F0;"> YourAdapter</span><span style="color:#F97583;"> struct</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    conn </span><span style="color:#F97583;">*</span><span style="color:#B392F0;">YourConnection</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// QueryTenants retrieves tenant data</span></span>
<span class="line"><span style="color:#F97583;">func</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">a </span><span style="color:#F97583;">*</span><span style="color:#B392F0;">YourAdapter</span><span style="color:#E1E4E8;">) </span><span style="color:#B392F0;">QueryTenants</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">ctx</span><span style="color:#B392F0;"> context</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">Context</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">config</span><span style="color:#B392F0;"> QueryConfig</span><span style="color:#E1E4E8;">) ([]</span><span style="color:#B392F0;">TenantRow</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">error</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#6A737D;">    // 1. Build query using config.Table, config.ValueMappings, config.ExtraMappings</span></span>
<span class="line"><span style="color:#6A737D;">    // 2. Execute query</span></span>
<span class="line"><span style="color:#6A737D;">    // 3. Map results to []TenantRow</span></span>
<span class="line"><span style="color:#6A737D;">    // 4. Filter active tenants</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#E1E4E8;"> tenants, </span><span style="color:#79B8FF;">nil</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">// Close cleans up resources</span></span>
<span class="line"><span style="color:#F97583;">func</span><span style="color:#E1E4E8;"> (</span><span style="color:#FFAB70;">a </span><span style="color:#F97583;">*</span><span style="color:#B392F0;">YourAdapter</span><span style="color:#E1E4E8;">) </span><span style="color:#B392F0;">Close</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">error</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">    return</span><span style="color:#E1E4E8;"> a.conn.</span><span style="color:#B392F0;">Close</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>2. Register in Factory</strong> (<code>internal/datasource/interface.go</code>):</p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> SourceTypeYours</span><span style="color:#B392F0;"> SourceType</span><span style="color:#F97583;"> =</span><span style="color:#9ECBFF;"> &quot;yourdatasource&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">func</span><span style="color:#B392F0;"> NewDatasource</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">sourceType</span><span style="color:#B392F0;"> SourceType</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">config</span><span style="color:#B392F0;"> Config</span><span style="color:#E1E4E8;">) (</span><span style="color:#B392F0;">Datasource</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">error</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#F97583;">    switch</span><span style="color:#E1E4E8;"> sourceType {</span></span>
<span class="line"><span style="color:#F97583;">    case</span><span style="color:#E1E4E8;"> SourceTypeYours:</span></span>
<span class="line"><span style="color:#F97583;">        return</span><span style="color:#B392F0;"> NewYourAdapter</span><span style="color:#E1E4E8;">(config)</span></span>
<span class="line"><span style="color:#6A737D;">    // ... other cases</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>3. Add API Types</strong> (<code>api/v1/tenantregistry_types.go</code>):</p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">const</span><span style="color:#79B8FF;"> SourceTypeYours</span><span style="color:#B392F0;"> SourceType</span><span style="color:#F97583;"> =</span><span style="color:#9ECBFF;"> &quot;yourdatasource&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">type</span><span style="color:#B392F0;"> TenantRegistrySourceSpec</span><span style="color:#F97583;"> struct</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#6A737D;">    // +kubebuilder:validation:Enum=mysql;postgresql;yourdatasource</span></span>
<span class="line"><span style="color:#E1E4E8;">    Type </span><span style="color:#B392F0;">SourceType</span><span style="color:#9ECBFF;"> \`json:&quot;type&quot;\`</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    YourDatasource </span><span style="color:#F97583;">*</span><span style="color:#B392F0;">YourDatasourceSpec</span><span style="color:#9ECBFF;"> \`json:&quot;yourdatasource,omitempty&quot;\`</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>4. Test</strong>:</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> test</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> lint</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> build</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="full-guide" tabindex="-1">Full Guide <a class="header-anchor" href="#full-guide" aria-label="Permalink to &quot;Full Guide&quot;">â€‹</a></h3><p>ğŸ“š <strong>Detailed Step-by-Step Guide</strong>: <a href="./contributing-datasource.html">Contributing a New Datasource</a></p><p>The full guide includes:</p><ul><li>Interface explanation with examples</li><li>Complete MySQL reference implementation walkthrough</li><li>PostgreSQL adapter example</li><li>Testing strategies</li><li>Documentation templates</li><li>PR checklist</li></ul><h3 id="key-files" tabindex="-1">Key Files <a class="header-anchor" href="#key-files" aria-label="Permalink to &quot;Key Files&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>File</th><th>Purpose</th></tr></thead><tbody><tr><td><code>internal/datasource/interface.go</code></td><td>Interface definition + factory</td></tr><tr><td><code>internal/datasource/mysql.go</code></td><td>Reference implementation</td></tr><tr><td><code>internal/datasource/your_adapter.go</code></td><td>Your implementation</td></tr><tr><td><code>api/v1/tenantregistry_types.go</code></td><td>API types</td></tr><tr><td><code>internal/controller/tenantregistry_controller.go</code></td><td>Controller integration</td></tr></tbody></table><h3 id="example-study-mysql-adapter" tabindex="-1">Example: Study MySQL Adapter <a class="header-anchor" href="#example-study-mysql-adapter" aria-label="Permalink to &quot;Example: Study MySQL Adapter&quot;">â€‹</a></h3><p>The MySQL adapter (<code>internal/datasource/mysql.go</code>) is a complete, production-ready reference:</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># View the implementation</span></span>
<span class="line"><span style="color:#B392F0;">cat</span><span style="color:#9ECBFF;"> internal/datasource/mysql.go</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Key sections:</span></span>
<span class="line"><span style="color:#6A737D;"># - NewMySQLAdapter(): Connection setup</span></span>
<span class="line"><span style="color:#6A737D;"># - QueryTenants(): Query + mapping + filtering</span></span>
<span class="line"><span style="color:#6A737D;"># - Close(): Resource cleanup</span></span>
<span class="line"><span style="color:#6A737D;"># - Helper functions: joinColumns(), isActive()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>What to learn:</strong></p><ul><li>Connection pooling configuration</li><li>Query building with column mappings</li><li>Result scanning and type handling</li><li>Filtering logic (active tenants only)</li><li>Error handling patterns</li></ul><h3 id="development-workflow" tabindex="-1">Development Workflow <a class="header-anchor" href="#development-workflow" aria-label="Permalink to &quot;Development Workflow&quot;">â€‹</a></h3><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># 1. Create adapter file</span></span>
<span class="line"><span style="color:#B392F0;">touch</span><span style="color:#9ECBFF;"> internal/datasource/postgres.go</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 2. Implement interface</span></span>
<span class="line"><span style="color:#6A737D;"># (Copy mysql.go as template)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 3. Register in factory</span></span>
<span class="line"><span style="color:#B392F0;">vim</span><span style="color:#9ECBFF;"> internal/datasource/interface.go</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 4. Add API types</span></span>
<span class="line"><span style="color:#B392F0;">vim</span><span style="color:#9ECBFF;"> api/v1/tenantregistry_types.go</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 5. Generate manifests</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> manifests</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 6. Write tests</span></span>
<span class="line"><span style="color:#B392F0;">touch</span><span style="color:#9ECBFF;"> internal/datasource/postgres_test.go</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 7. Test</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> test</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 8. Lint</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> lint</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 9. Build</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> build</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 10. Test locally</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> install</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> run</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> apply</span><span style="color:#79B8FF;"> -f</span><span style="color:#9ECBFF;"> config/samples/postgres/</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="common-patterns" tabindex="-1">Common Patterns <a class="header-anchor" href="#common-patterns" aria-label="Permalink to &quot;Common Patterns&quot;">â€‹</a></h3><p><strong>SQL-based datasources</strong> (MySQL, PostgreSQL):</p><ul><li>Use <code>database/sql</code> package</li><li>Build SELECT queries dynamically</li><li>Use parameterized queries for safety</li><li>Handle NULL values with <code>sql.NullString</code></li></ul><p><strong>NoSQL datasources</strong> (MongoDB, DynamoDB):</p><ul><li>Use native client libraries</li><li>Map documents/items to <code>TenantRow</code></li><li>Handle different query syntax</li><li>Consider pagination for large datasets</li></ul><p><strong>REST APIs</strong>:</p><ul><li>Use <code>net/http</code> client</li><li>Unmarshal JSON to structs</li><li>Map to <code>TenantRow</code></li><li>Handle authentication</li></ul><h3 id="tips" tabindex="-1">Tips <a class="header-anchor" href="#tips" aria-label="Permalink to &quot;Tips&quot;">â€‹</a></h3><ol><li><strong>Start with MySQL adapter</strong> - Copy it as a template</li><li><strong>Focus on QueryTenants()</strong> - This is the core logic</li><li><strong>Handle errors gracefully</strong> - Return clear error messages</li><li><strong>Filter consistently</strong> - Use the same <code>isActive()</code> logic</li><li><strong>Test thoroughly</strong> - Unit tests + integration tests</li><li><strong>Document well</strong> - Help users configure your datasource</li></ol><h2 id="contributing" tabindex="-1">Contributing <a class="header-anchor" href="#contributing" aria-label="Permalink to &quot;Contributing&quot;">â€‹</a></h2><div class="tip custom-block"><p class="custom-block-title">Contribution checklist</p><p>Always include tests, update docs, and run <code>make lint</code> before opening a pull request.</p></div><h3 id="workflow" tabindex="-1">Workflow <a class="header-anchor" href="#workflow" aria-label="Permalink to &quot;Workflow&quot;">â€‹</a></h3><ol><li>Fork repository</li><li>Create feature branch</li><li>Make changes</li><li>Add tests</li><li>Run linter: <code>make lint</code></li><li>Run tests: <code>make test</code></li><li>Commit with conventional commits</li><li>Open Pull Request</li></ol><h3 id="conventional-commits" tabindex="-1">Conventional Commits <a class="header-anchor" href="#conventional-commits" aria-label="Permalink to &quot;Conventional Commits&quot;">â€‹</a></h3><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>feat: add new feature</span></span>
<span class="line"><span>fix: fix bug</span></span>
<span class="line"><span>docs: update documentation</span></span>
<span class="line"><span>test: add tests</span></span>
<span class="line"><span>refactor: refactor code</span></span>
<span class="line"><span>chore: maintenance tasks</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="pull-request-template" tabindex="-1">Pull Request Template <a class="header-anchor" href="#pull-request-template" aria-label="Permalink to &quot;Pull Request Template&quot;">â€‹</a></h3><div class="language-markdown line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">markdown</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#79B8FF;font-weight:bold;">## Description</span></span>
<span class="line"><span style="color:#E1E4E8;">Brief description of changes</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF;font-weight:bold;">## Type of Change</span></span>
<span class="line"><span style="color:#FFAB70;">-</span><span style="color:#E1E4E8;"> [ ] Bug fix</span></span>
<span class="line"><span style="color:#FFAB70;">-</span><span style="color:#E1E4E8;"> [ ] New feature</span></span>
<span class="line"><span style="color:#FFAB70;">-</span><span style="color:#E1E4E8;"> [ ] Breaking change</span></span>
<span class="line"><span style="color:#FFAB70;">-</span><span style="color:#E1E4E8;"> [ ] Documentation update</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF;font-weight:bold;">## Testing</span></span>
<span class="line"><span style="color:#FFAB70;">-</span><span style="color:#E1E4E8;"> [ ] Unit tests added/updated</span></span>
<span class="line"><span style="color:#FFAB70;">-</span><span style="color:#E1E4E8;"> [ ] Integration tests added/updated</span></span>
<span class="line"><span style="color:#FFAB70;">-</span><span style="color:#E1E4E8;"> [ ] Manual testing performed</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF;font-weight:bold;">## Checklist</span></span>
<span class="line"><span style="color:#FFAB70;">-</span><span style="color:#E1E4E8;"> [ ] Code follows style guidelines</span></span>
<span class="line"><span style="color:#FFAB70;">-</span><span style="color:#E1E4E8;"> [ ] Self-review completed</span></span>
<span class="line"><span style="color:#FFAB70;">-</span><span style="color:#E1E4E8;"> [ ] Documentation updated</span></span>
<span class="line"><span style="color:#FFAB70;">-</span><span style="color:#E1E4E8;"> [ ] Tests passing</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="release-process" tabindex="-1">Release Process <a class="header-anchor" href="#release-process" aria-label="Permalink to &quot;Release Process&quot;">â€‹</a></h2><div class="info custom-block"><p class="custom-block-title">Release automation</p><p>Tags trigger the release pipeline. Confirm CI is green before pushing a new tag.</p></div><h3 id="version-bump" tabindex="-1">Version Bump <a class="header-anchor" href="#version-bump" aria-label="Permalink to &quot;Version Bump&quot;">â€‹</a></h3><ol><li><p>Update version in:</p><ul><li><code>README.md</code></li><li><code>config/manager/kustomization.yaml</code></li></ul></li><li><p>Generate changelog</p></li><li><p>Create git tag:</p></li></ol><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">git</span><span style="color:#9ECBFF;"> tag</span><span style="color:#79B8FF;"> -a</span><span style="color:#9ECBFF;"> v1.1.0</span><span style="color:#79B8FF;"> -m</span><span style="color:#9ECBFF;"> &quot;Release v1.1.0&quot;</span></span>
<span class="line"><span style="color:#B392F0;">git</span><span style="color:#9ECBFF;"> push</span><span style="color:#9ECBFF;"> origin</span><span style="color:#9ECBFF;"> v1.1.0</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="4"><li>GitHub Actions builds and publishes release</li></ol><h2 id="useful-commands" tabindex="-1">Useful Commands <a class="header-anchor" href="#useful-commands" aria-label="Permalink to &quot;Useful Commands&quot;">â€‹</a></h2><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Install CRDs</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> install</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Uninstall CRDs</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> uninstall</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Deploy operator</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> deploy</span><span style="color:#9ECBFF;"> IMG=</span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">imag</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Undeploy operator</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> undeploy</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Run locally</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> run</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Build binary</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> build</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Build container</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> docker-build</span><span style="color:#9ECBFF;"> IMG=</span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">imag</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Run tests</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> test</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Run linter</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> lint</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Generate code</span></span>
<span class="line"><span style="color:#B392F0;">make</span><span style="color:#9ECBFF;"> generate</span><span style="color:#9ECBFF;"> manifests</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="see-also" tabindex="-1">See Also <a class="header-anchor" href="#see-also" aria-label="Permalink to &quot;See Also&quot;">â€‹</a></h2><ul><li><a href="https://github.com/kubernetes-tenants/tenant-operator/blob/main/CONTRIBUTING.md" target="_blank" rel="noreferrer">Contributing Guide</a></li><li><a href="./api.html">API Reference</a></li><li><a href="./">Architecture Overview</a></li></ul>`,49))])}const f=p(d,[["render",b]]);export{B as __pageData,f as default};
