import{_ as e,c as p,o,a2 as a,j as s,a as n}from"./chunks/framework.9Uv4PgnO.js";const d=JSON.parse('{"title":"DataSource Configuration Guide","description":"","frontmatter":{},"headers":[],"relativePath":"datasource.md","filePath":"datasource.md","lastUpdated":1761887194000}'),r={name:"datasource.md"};function t(c,l,i,E,y,u){return o(),p("div",null,[...l[0]||(l[0]=[a(`<h1 id="datasource-configuration-guide" tabindex="-1">DataSource Configuration Guide <a class="header-anchor" href="#datasource-configuration-guide" aria-label="Permalink to &quot;DataSource Configuration Guide&quot;">​</a></h1><p>Complete guide for configuring MySQL datasources with Tenant Operator.</p><nav class="table-of-contents"><ul><li><a href="#overview">Overview</a></li><li><a href="#mysql-connection">MySQL Connection</a><ul><li><a href="#basic-configuration">Basic Configuration</a></li><li><a href="#connection-details">Connection Details</a></li></ul></li><li><a href="#column-mappings">Column Mappings</a><ul><li><a href="#required-mappings">Required Mappings</a></li><li><a href="#extra-mappings">Extra Mappings</a></li></ul></li><li><a href="#database-schema-examples">Database Schema Examples</a><ul><li><a href="#example-1-simple-tenant-table">Example 1: Simple Tenant Table</a></li><li><a href="#example-2-boolean-and-string-activate-column">Example 2: Boolean and String Activate Column</a></li></ul></li><li><a href="#data-transformation-with-views">Data Transformation with Views</a><ul><li><a href="#use-case-1-transform-status-string-to-truthy-value">Use Case 1: Transform Status String to Truthy Value</a></li><li><a href="#use-case-2-combine-multiple-columns">Use Case 2: Combine Multiple Columns</a></li><li><a href="#use-case-3-filter-and-transform">Use Case 3: Filter and Transform</a></li><li><a href="#use-case-4-add-computed-columns">Use Case 4: Add Computed Columns</a></li></ul></li><li><a href="#best-practices">Best Practices</a><ul><li><a href="#_1-use-read-only-database-user">1. Use Read-Only Database User</a></li><li><a href="#_2-use-views-for-data-isolation">2. Use Views for Data Isolation</a></li><li><a href="#_3-add-indexes-for-performance">3. Add Indexes for Performance</a></li><li><a href="#_4-validate-data-before-deployment">4. Validate Data Before Deployment</a></li><li><a href="#_5-use-appropriate-sync-intervals">5. Use Appropriate Sync Intervals</a></li></ul></li><li><a href="#troubleshooting">Troubleshooting</a><ul><li><a href="#problem-tenants-not-being-created">Problem: Tenants Not Being Created</a></li><li><a href="#problem-view-not-updating">Problem: View Not Updating</a></li><li><a href="#problem-connection-errors">Problem: Connection Errors</a></li></ul></li><li><a href="#complete-example">Complete Example</a><ul><li><a href="#database-setup">Database Setup</a></li><li><a href="#kubernetes-secret">Kubernetes Secret</a></li><li><a href="#tenantregistry">TenantRegistry</a></li><li><a href="#query-results">Query Results</a></li></ul></li><li><a href="#see-also">See Also</a></li></ul></nav><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p>Tenant Operator reads tenant data from external MySQL databases and automatically provisions Kubernetes resources. This guide covers database setup, column mappings, and data transformation techniques.</p><div class="info custom-block"><p class="custom-block-title">Scope</p><p>Examples focus on MySQL, but the same patterns apply to other relational sources when they are supported.</p></div><h2 id="mysql-connection" tabindex="-1">MySQL Connection <a class="header-anchor" href="#mysql-connection" aria-label="Permalink to &quot;MySQL Connection&quot;">​</a></h2><h3 id="basic-configuration" tabindex="-1">Basic Configuration <a class="header-anchor" href="#basic-configuration" aria-label="Permalink to &quot;Basic Configuration&quot;">​</a></h3><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">operator.kubernetes-tenants.org/v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">TenantRegistry</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">  name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">my-registry</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">  source</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">    type</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">mysql</span></span>
<span class="line"><span style="color:#85E89D;">    mysql</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">      host</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">mysql.default.svc.cluster.local</span></span>
<span class="line"><span style="color:#85E89D;">      port</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">3306</span></span>
<span class="line"><span style="color:#85E89D;">      username</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">tenant_reader</span></span>
<span class="line"><span style="color:#85E89D;">      passwordRef</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">        name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">mysql-credentials</span></span>
<span class="line"><span style="color:#85E89D;">        key</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">password</span></span>
<span class="line"><span style="color:#85E89D;">      database</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">tenants</span></span>
<span class="line"><span style="color:#85E89D;">      table</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">tenant_configs</span></span>
<span class="line"><span style="color:#85E89D;">    syncInterval</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">1m</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="connection-details" tabindex="-1">Connection Details <a class="header-anchor" href="#connection-details" aria-label="Permalink to &quot;Connection Details&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Field</th><th>Description</th><th>Default / Recommendation</th></tr></thead><tbody><tr><td><code>host</code></td><td>MySQL server hostname or IP</td><td>Cluster DNS entry</td></tr><tr><td><code>port</code></td><td>MySQL server port</td><td><code>3306</code></td></tr><tr><td><code>username</code></td><td>Database username (use read-only credentials)</td><td><code>tenant_reader</code></td></tr><tr><td><code>passwordRef</code></td><td>Reference to a Kubernetes Secret containing the password</td><td><code>mysql-credentials</code></td></tr><tr><td><code>database</code></td><td>Database name</td><td><code>tenants</code></td></tr><tr><td><code>table</code></td><td>Table or view containing tenant data</td><td><code>tenant_configs</code></td></tr><tr><td><code>syncInterval</code></td><td>How often to poll the database (e.g., <code>30s</code>, <code>1m</code>, <code>5m</code>)</td><td><code>1m</code></td></tr></tbody></table><h2 id="column-mappings" tabindex="-1">Column Mappings <a class="header-anchor" href="#column-mappings" aria-label="Permalink to &quot;Column Mappings&quot;">​</a></h2><h3 id="required-mappings" tabindex="-1">Required Mappings <a class="header-anchor" href="#required-mappings" aria-label="Permalink to &quot;Required Mappings&quot;">​</a></h3><p>Three columns are required for every tenant:</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">valueMappings</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">  uid</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">tenant_id</span><span style="color:#6A737D;">           # Unique tenant identifier</span></span>
<span class="line"><span style="color:#85E89D;">  hostOrUrl</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">tenant_url</span><span style="color:#6A737D;">    # Tenant URL or hostname</span></span>
<span class="line"><span style="color:#85E89D;">  activate</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">is_active</span><span style="color:#6A737D;">      # Activation flag</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="uid-tenant-identifier" tabindex="-1"><code>uid</code> - Tenant Identifier <a class="header-anchor" href="#uid-tenant-identifier" aria-label="Permalink to &quot;\`uid\` - Tenant Identifier&quot;">​</a></h4><ul><li><strong>Type</strong>: String</li><li><strong>Required</strong>: Yes</li><li><strong>Purpose</strong>: Unique identifier for each tenant</li><li><strong>Examples</strong>: <code>&quot;tenant-123&quot;</code>, <code>&quot;acme-corp&quot;</code>, <code>&quot;customer-456&quot;</code></li><li><strong>Used in</strong>: Resource naming, labels, template variables</li></ul><h4 id="hostorurl-tenant-url-hostname" tabindex="-1"><code>hostOrUrl</code> - Tenant URL/Hostname <a class="header-anchor" href="#hostorurl-tenant-url-hostname" aria-label="Permalink to &quot;\`hostOrUrl\` - Tenant URL/Hostname&quot;">​</a></h4><ul><li><strong>Type</strong>: String</li><li><strong>Required</strong>: Yes</li><li><strong>Purpose</strong>: Tenant&#39;s URL or hostname</li><li><strong>Examples</strong>: <ul><li><code>&quot;https://acme.example.com&quot;</code></li><li><code>&quot;acme.example.com&quot;</code></li><li><code>&quot;tenant123.myapp.io&quot;</code></li></ul></li><li><strong>Auto-extraction</strong>: <code>.host</code> variable is automatically extracted <ul><li><code>&quot;https://acme.example.com&quot;</code> → <code>.host = &quot;acme.example.com&quot;</code></li></ul></li></ul><h4 id="activate-activation-flag-⚠️" tabindex="-1"><code>activate</code> - Activation Flag ⚠️ <a class="header-anchor" href="#activate-activation-flag-⚠️" aria-label="Permalink to &quot;\`activate\` - Activation Flag ⚠️&quot;">​</a></h4><ul><li><strong>Type</strong>: String (truthy values)</li><li><strong>Required</strong>: Yes</li><li><strong>Purpose</strong>: Controls whether tenant resources are created</li></ul><div class="warning custom-block"><p class="custom-block-title">Activation rules</p><table tabindex="0"><thead><tr><th>Accepted values (case-sensitive)</th><th>Result</th></tr></thead><tbody><tr><td><code>&quot;1&quot;</code>, <code>&quot;true&quot;</code>, <code>&quot;TRUE&quot;</code>, <code>&quot;True&quot;</code>, <code>&quot;yes&quot;</code>, <code>&quot;YES&quot;</code>, <code>&quot;Yes&quot;</code></td><td>Tenant is marked <strong>active</strong> and resources reconcile.</td></tr></tbody></table><table tabindex="0"><thead><tr><th>Rejected values</th><th>Result</th></tr></thead><tbody><tr><td><code>&quot;0&quot;</code>, <code>&quot;false&quot;</code>, <code>&quot;FALSE&quot;</code>, <code>&quot;no&quot;</code>, <code>&quot;&quot;</code>, <code>NULL</code>, any other string</td><td>Tenant is <strong>ignored</strong> during sync.</td></tr></tbody></table><ul><li>Only the exact accepted strings above are considered active.</li><li>Boolean columns work if they stringify to <code>&quot;1&quot;</code> or <code>&quot;true&quot;</code>.</li><li>Integer columns (<code>TINYINT</code>) work when they return the string <code>&quot;1&quot;</code>.</li></ul></div><h3 id="extra-mappings" tabindex="-1">Extra Mappings <a class="header-anchor" href="#extra-mappings" aria-label="Permalink to &quot;Extra Mappings&quot;">​</a></h3><p>Add custom variables for use in templates:</p>`,24),s("div",null,[s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"extraValueMappings"),s("span",{style:{color:"#E1E4E8"}},":")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  planId"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"subscription_plan"),s("span",{style:{color:"#6A737D"}},'        # Maps "subscription_plan" column to {{ .planId }}')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  region"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"deployment_region"),s("span",{style:{color:"#6A737D"}},'        # Maps "deployment_region" column to {{ .region }}')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  maxUsers"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"max_user_count"),s("span",{style:{color:"#6A737D"}},'         # Maps "max_user_count" column to {{ .maxUsers }}')]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  apiKey"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"api_token"),s("span",{style:{color:"#6A737D"}},'                # Maps "api_token" column to {{ .apiKey }}')])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br"),s("span",{class:"line-number"},"5"),s("br")])]),s("p",null,[n("These variables become available in all templates as "),s("code",null,"{{ .planId }}"),n(", "),s("code",null,"{{ .region }}"),n(", etc.")])],-1),a(`<h2 id="database-schema-examples" tabindex="-1">Database Schema Examples <a class="header-anchor" href="#database-schema-examples" aria-label="Permalink to &quot;Database Schema Examples&quot;">​</a></h2><h3 id="example-1-simple-tenant-table" tabindex="-1">Example 1: Simple Tenant Table <a class="header-anchor" href="#example-1-simple-tenant-table" aria-label="Permalink to &quot;Example 1: Simple Tenant Table&quot;">​</a></h3><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#F97583;"> TABLE</span><span style="color:#B392F0;"> tenant_configs</span><span style="color:#E1E4E8;"> (</span></span>
<span class="line"><span style="color:#E1E4E8;">    tenant_id </span><span style="color:#F97583;">VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">255</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">PRIMARY KEY</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    tenant_url </span><span style="color:#F97583;">VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">500</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">NOT NULL</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    is_active </span><span style="color:#F97583;">TINYINT</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">DEFAULT</span><span style="color:#79B8FF;"> 0</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    subscription_plan </span><span style="color:#F97583;">VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">50</span><span style="color:#E1E4E8;">),</span></span>
<span class="line"><span style="color:#E1E4E8;">    deployment_region </span><span style="color:#F97583;">VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">50</span><span style="color:#E1E4E8;">),</span></span>
<span class="line"><span style="color:#E1E4E8;">    created_at </span><span style="color:#F97583;">TIMESTAMP</span><span style="color:#F97583;"> DEFAULT</span><span style="color:#E1E4E8;"> CURRENT_TIMESTAMP</span></span>
<span class="line"><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- Sample data</span></span>
<span class="line"><span style="color:#F97583;">INSERT INTO</span><span style="color:#E1E4E8;"> tenant_configs (tenant_id, tenant_url, is_active, subscription_plan, deployment_region) </span><span style="color:#F97583;">VALUES</span></span>
<span class="line"><span style="color:#E1E4E8;">    (</span><span style="color:#9ECBFF;">&#39;acme-corp&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;https://acme.example.com&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;enterprise&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;us-east-1&#39;</span><span style="color:#E1E4E8;">),</span></span>
<span class="line"><span style="color:#E1E4E8;">    (</span><span style="color:#9ECBFF;">&#39;beta-inc&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;https://beta.example.com&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;startup&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;eu-west-1&#39;</span><span style="color:#E1E4E8;">),</span></span>
<span class="line"><span style="color:#E1E4E8;">    (</span><span style="color:#9ECBFF;">&#39;gamma-llc&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;https://gamma.example.com&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;trial&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;ap-south-1&#39;</span><span style="color:#E1E4E8;">);  </span><span style="color:#6A737D;">-- Not active</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>Registry Configuration:</strong></p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">valueMappings</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">  uid</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">tenant_id</span></span>
<span class="line"><span style="color:#85E89D;">  hostOrUrl</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">tenant_url</span></span>
<span class="line"><span style="color:#85E89D;">  activate</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">is_active</span></span>
<span class="line"><span style="color:#85E89D;">extraValueMappings</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">  planId</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">subscription_plan</span></span>
<span class="line"><span style="color:#85E89D;">  region</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">deployment_region</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="example-2-boolean-and-string-activate-column" tabindex="-1">Example 2: Boolean and String Activate Column <a class="header-anchor" href="#example-2-boolean-and-string-activate-column" aria-label="Permalink to &quot;Example 2: Boolean and String Activate Column&quot;">​</a></h3><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">-- Option A: TINYINT (returns &quot;1&quot; or &quot;0&quot; as string)</span></span>
<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#F97583;"> TABLE</span><span style="color:#B392F0;"> tenants</span><span style="color:#E1E4E8;"> (</span></span>
<span class="line"><span style="color:#E1E4E8;">    id </span><span style="color:#F97583;">VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">255</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">PRIMARY KEY</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#F97583;">    url</span><span style="color:#F97583;"> VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">500</span><span style="color:#E1E4E8;">),</span></span>
<span class="line"><span style="color:#E1E4E8;">    active </span><span style="color:#F97583;">TINYINT</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">DEFAULT</span><span style="color:#79B8FF;"> 0</span><span style="color:#6A737D;">  -- ✅ Returns &quot;1&quot; (truthy) or &quot;0&quot; (falsy)</span></span>
<span class="line"><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- Option B: VARCHAR with explicit values</span></span>
<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#F97583;"> TABLE</span><span style="color:#B392F0;"> tenants</span><span style="color:#E1E4E8;"> (</span></span>
<span class="line"><span style="color:#E1E4E8;">    id </span><span style="color:#F97583;">VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">255</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">PRIMARY KEY</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#F97583;">    url</span><span style="color:#F97583;"> VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">500</span><span style="color:#E1E4E8;">),</span></span>
<span class="line"><span style="color:#F97583;">    status</span><span style="color:#F97583;"> VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">20</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">DEFAULT</span><span style="color:#9ECBFF;"> &#39;inactive&#39;</span><span style="color:#6A737D;">  -- Values: &quot;active&quot; or &quot;inactive&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- Option C: BOOLEAN (MySQL stores as TINYINT)</span></span>
<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#F97583;"> TABLE</span><span style="color:#B392F0;"> tenants</span><span style="color:#E1E4E8;"> (</span></span>
<span class="line"><span style="color:#E1E4E8;">    id </span><span style="color:#F97583;">VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">255</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">PRIMARY KEY</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#F97583;">    url</span><span style="color:#F97583;"> VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">500</span><span style="color:#E1E4E8;">),</span></span>
<span class="line"><span style="color:#F97583;">    enabled</span><span style="color:#F97583;"> BOOLEAN</span><span style="color:#F97583;"> DEFAULT</span><span style="color:#E1E4E8;"> FALSE  </span><span style="color:#6A737D;">-- ✅ Returns &quot;1&quot; or &quot;0&quot; as string</span></span>
<span class="line"><span style="color:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p><strong>Registry Configurations:</strong></p><p>For Option A or C (TINYINT/BOOLEAN):</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">valueMappings</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">  uid</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">id</span></span>
<span class="line"><span style="color:#85E89D;">  hostOrUrl</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">url</span></span>
<span class="line"><span style="color:#85E89D;">  activate</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">active</span><span style="color:#6A737D;">  # ✅ &quot;1&quot; is truthy, &quot;0&quot; is falsy</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>For Option B (VARCHAR status):</p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># ❌ Won&#39;t work directly - &quot;active&quot; is not a valid truthy value</span></span>
<span class="line"><span style="color:#6A737D;"># Use a VIEW with transformation (see below)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="data-transformation-with-views" tabindex="-1">Data Transformation with Views <a class="header-anchor" href="#data-transformation-with-views" aria-label="Permalink to &quot;Data Transformation with Views&quot;">​</a></h2><p>If your database schema doesn&#39;t match the required format, create a MySQL VIEW to transform data.</p><h3 id="use-case-1-transform-status-string-to-truthy-value" tabindex="-1">Use Case 1: Transform Status String to Truthy Value <a class="header-anchor" href="#use-case-1-transform-status-string-to-truthy-value" aria-label="Permalink to &quot;Use Case 1: Transform Status String to Truthy Value&quot;">​</a></h3><p><strong>Problem:</strong> Your <code>status</code> column has values like <code>&quot;active&quot;</code>, <code>&quot;inactive&quot;</code>, <code>&quot;suspended&quot;</code></p><p><strong>Solution:</strong> Create a view that maps to truthy values:</p><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#F97583;"> VIEW</span><span style="color:#B392F0;"> tenant_configs</span><span style="color:#F97583;"> AS</span></span>
<span class="line"><span style="color:#F97583;">SELECT</span></span>
<span class="line"><span style="color:#E1E4E8;">    id </span><span style="color:#F97583;">AS</span><span style="color:#E1E4E8;"> tenant_id,</span></span>
<span class="line"><span style="color:#F97583;">    url</span><span style="color:#F97583;"> AS</span><span style="color:#E1E4E8;"> tenant_url,</span></span>
<span class="line"><span style="color:#F97583;">    CASE</span></span>
<span class="line"><span style="color:#F97583;">        WHEN</span><span style="color:#F97583;"> status</span><span style="color:#F97583;"> =</span><span style="color:#9ECBFF;"> &#39;active&#39;</span><span style="color:#F97583;"> THEN</span><span style="color:#9ECBFF;"> &#39;1&#39;</span></span>
<span class="line"><span style="color:#F97583;">        ELSE</span><span style="color:#9ECBFF;"> &#39;0&#39;</span></span>
<span class="line"><span style="color:#F97583;">    END</span><span style="color:#F97583;"> AS</span><span style="color:#E1E4E8;"> is_active,</span></span>
<span class="line"><span style="color:#E1E4E8;">    plan </span><span style="color:#F97583;">AS</span><span style="color:#E1E4E8;"> subscription_plan,</span></span>
<span class="line"><span style="color:#E1E4E8;">    region </span><span style="color:#F97583;">AS</span><span style="color:#E1E4E8;"> deployment_region</span></span>
<span class="line"><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> tenants</span></span>
<span class="line"><span style="color:#F97583;">WHERE</span><span style="color:#F97583;"> status</span><span style="color:#F97583;"> IN</span><span style="color:#E1E4E8;"> (</span><span style="color:#9ECBFF;">&#39;active&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;inactive&#39;</span><span style="color:#E1E4E8;">);  </span><span style="color:#6A737D;">-- Exclude suspended</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>Registry Configuration:</strong></p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">  source</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">    mysql</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">      table</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">tenant_configs</span><span style="color:#6A737D;">  # ✅ Use VIEW name, not original table</span></span>
<span class="line"><span style="color:#85E89D;">  valueMappings</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">    uid</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">tenant_id</span></span>
<span class="line"><span style="color:#85E89D;">    hostOrUrl</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">tenant_url</span></span>
<span class="line"><span style="color:#85E89D;">    activate</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">is_active</span><span style="color:#6A737D;">       # ✅ Now returns &quot;1&quot; or &quot;0&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="use-case-2-combine-multiple-columns" tabindex="-1">Use Case 2: Combine Multiple Columns <a class="header-anchor" href="#use-case-2-combine-multiple-columns" aria-label="Permalink to &quot;Use Case 2: Combine Multiple Columns&quot;">​</a></h3><p><strong>Problem:</strong> Tenant URL is split across multiple columns</p><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">-- Original table</span></span>
<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#F97583;"> TABLE</span><span style="color:#B392F0;"> customers</span><span style="color:#E1E4E8;"> (</span></span>
<span class="line"><span style="color:#E1E4E8;">    customer_id </span><span style="color:#F97583;">INT</span><span style="color:#F97583;"> PRIMARY KEY</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    subdomain </span><span style="color:#F97583;">VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">),</span></span>
<span class="line"><span style="color:#E1E4E8;">    domain </span><span style="color:#F97583;">VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">),  </span><span style="color:#6A737D;">-- e.g., &quot;myapp.com&quot;</span></span>
<span class="line"><span style="color:#F97583;">    enabled</span><span style="color:#F97583;"> TINYINT</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- View to combine columns</span></span>
<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#F97583;"> VIEW</span><span style="color:#B392F0;"> tenant_configs</span><span style="color:#F97583;"> AS</span></span>
<span class="line"><span style="color:#F97583;">SELECT</span></span>
<span class="line"><span style="color:#79B8FF;">    CONCAT</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;customer-&#39;</span><span style="color:#E1E4E8;">, customer_id) </span><span style="color:#F97583;">AS</span><span style="color:#E1E4E8;"> tenant_id,</span></span>
<span class="line"><span style="color:#79B8FF;">    CONCAT</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;https://&#39;</span><span style="color:#E1E4E8;">, subdomain, </span><span style="color:#9ECBFF;">&#39;.&#39;</span><span style="color:#E1E4E8;">, domain) </span><span style="color:#F97583;">AS</span><span style="color:#E1E4E8;"> tenant_url,</span></span>
<span class="line"><span style="color:#F97583;">    IF</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">enabled</span><span style="color:#F97583;"> =</span><span style="color:#79B8FF;"> 1</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;1&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;0&#39;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">AS</span><span style="color:#E1E4E8;"> is_active</span></span>
<span class="line"><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> customers</span></span>
<span class="line"><span style="color:#F97583;">WHERE</span><span style="color:#F97583;"> enabled</span><span style="color:#F97583;"> =</span><span style="color:#79B8FF;"> 1</span><span style="color:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="use-case-3-filter-and-transform" tabindex="-1">Use Case 3: Filter and Transform <a class="header-anchor" href="#use-case-3-filter-and-transform" aria-label="Permalink to &quot;Use Case 3: Filter and Transform&quot;">​</a></h3><p><strong>Problem:</strong> You want to exclude certain tenants or apply business logic</p><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#F97583;"> VIEW</span><span style="color:#B392F0;"> active_paying_tenants</span><span style="color:#F97583;"> AS</span></span>
<span class="line"><span style="color:#F97583;">SELECT</span></span>
<span class="line"><span style="color:#E1E4E8;">    tenant_id,</span></span>
<span class="line"><span style="color:#E1E4E8;">    tenant_url,</span></span>
<span class="line"><span style="color:#9ECBFF;">    &#39;1&#39;</span><span style="color:#F97583;"> AS</span><span style="color:#E1E4E8;"> is_active,  </span><span style="color:#6A737D;">-- Always active in this view</span></span>
<span class="line"><span style="color:#E1E4E8;">    subscription_tier,</span></span>
<span class="line"><span style="color:#79B8FF;">    MAX</span><span style="color:#E1E4E8;">(license_count) </span><span style="color:#F97583;">AS</span><span style="color:#E1E4E8;"> max_users</span></span>
<span class="line"><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> tenants t</span></span>
<span class="line"><span style="color:#F97583;">JOIN</span><span style="color:#E1E4E8;"> subscriptions s </span><span style="color:#F97583;">ON</span><span style="color:#79B8FF;"> t</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">id</span><span style="color:#F97583;"> =</span><span style="color:#79B8FF;"> s</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">tenant_id</span></span>
<span class="line"><span style="color:#F97583;">WHERE</span></span>
<span class="line"><span style="color:#79B8FF;">    s</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">status</span><span style="color:#F97583;"> =</span><span style="color:#9ECBFF;"> &#39;active&#39;</span></span>
<span class="line"><span style="color:#F97583;">    AND</span><span style="color:#79B8FF;"> s</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">payment_status</span><span style="color:#F97583;"> =</span><span style="color:#9ECBFF;"> &#39;paid&#39;</span></span>
<span class="line"><span style="color:#F97583;">    AND</span><span style="color:#79B8FF;"> s</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">expiry_date</span><span style="color:#F97583;"> &gt;</span><span style="color:#F97583;"> NOW</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#F97583;">GROUP BY</span><span style="color:#E1E4E8;"> tenant_id, tenant_url, subscription_tier;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="use-case-4-add-computed-columns" tabindex="-1">Use Case 4: Add Computed Columns <a class="header-anchor" href="#use-case-4-add-computed-columns" aria-label="Permalink to &quot;Use Case 4: Add Computed Columns&quot;">​</a></h3><p><strong>Problem:</strong> You need derived data in templates</p><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#F97583;"> VIEW</span><span style="color:#B392F0;"> tenant_configs</span><span style="color:#F97583;"> AS</span></span>
<span class="line"><span style="color:#F97583;">SELECT</span></span>
<span class="line"><span style="color:#E1E4E8;">    tenant_id,</span></span>
<span class="line"><span style="color:#E1E4E8;">    tenant_url,</span></span>
<span class="line"><span style="color:#E1E4E8;">    is_active,</span></span>
<span class="line"><span style="color:#E1E4E8;">    subscription_plan,</span></span>
<span class="line"><span style="color:#6A737D;">    -- Computed columns</span></span>
<span class="line"><span style="color:#79B8FF;">    CONCAT</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;https://cdn-&#39;</span><span style="color:#E1E4E8;">, deployment_region, </span><span style="color:#9ECBFF;">&#39;.example.com&#39;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">AS</span><span style="color:#E1E4E8;"> cdn_url,</span></span>
<span class="line"><span style="color:#F97583;">    CASE</span><span style="color:#E1E4E8;"> subscription_plan</span></span>
<span class="line"><span style="color:#F97583;">        WHEN</span><span style="color:#9ECBFF;"> &#39;enterprise&#39;</span><span style="color:#F97583;"> THEN</span><span style="color:#9ECBFF;"> &#39;100&#39;</span></span>
<span class="line"><span style="color:#F97583;">        WHEN</span><span style="color:#9ECBFF;"> &#39;business&#39;</span><span style="color:#F97583;"> THEN</span><span style="color:#9ECBFF;"> &#39;50&#39;</span></span>
<span class="line"><span style="color:#F97583;">        ELSE</span><span style="color:#9ECBFF;"> &#39;10&#39;</span></span>
<span class="line"><span style="color:#F97583;">    END</span><span style="color:#F97583;"> AS</span><span style="color:#E1E4E8;"> max_replicas,</span></span>
<span class="line"><span style="color:#F97583;">    DATE_FORMAT</span><span style="color:#E1E4E8;">(created_at, </span><span style="color:#9ECBFF;">&#39;%Y-%m-%d&#39;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">AS</span><span style="color:#E1E4E8;"> created_date</span></span>
<span class="line"><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> tenants;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><strong>Use in templates:</strong></p>`,30),s("div",null,[s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"extraValueMappings"),s("span",{style:{color:"#E1E4E8"}},":")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  cdnUrl"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"cdn_url")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  maxReplicas"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"max_replicas")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  createdDate"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"created_date")])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br")])]),s("div",{class:"language-yaml line-numbers-mode"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yaml"),s("pre",{class:"shiki github-dark vp-code",tabindex:"0","v-pre":""},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# In deployment template")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"spec"),s("span",{style:{color:"#E1E4E8"}},":")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  replicas"),s("span",{style:{color:"#E1E4E8"}},": {{ "),s("span",{style:{color:"#9ECBFF"}},".maxReplicas"),s("span",{style:{color:"#E1E4E8"}}," }}  "),s("span",{style:{color:"#6A737D"}},"# Uses computed value")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"  containers"),s("span",{style:{color:"#E1E4E8"}},":")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"  - "),s("span",{style:{color:"#85E89D"}},"name"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"app")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"    env"),s("span",{style:{color:"#E1E4E8"}},":")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#E1E4E8"}},"    - "),s("span",{style:{color:"#85E89D"}},"name"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},"CDN_URL")]),n(`
`),s("span",{class:"line"},[s("span",{style:{color:"#85E89D"}},"      value"),s("span",{style:{color:"#E1E4E8"}},": "),s("span",{style:{color:"#9ECBFF"}},'"{{ .cdnUrl }}"')])])]),s("div",{class:"line-numbers-wrapper","aria-hidden":"true"},[s("span",{class:"line-number"},"1"),s("br"),s("span",{class:"line-number"},"2"),s("br"),s("span",{class:"line-number"},"3"),s("br"),s("span",{class:"line-number"},"4"),s("br"),s("span",{class:"line-number"},"5"),s("br"),s("span",{class:"line-number"},"6"),s("br"),s("span",{class:"line-number"},"7"),s("br"),s("span",{class:"line-number"},"8"),s("br")])])],-1),a(`<h2 id="best-practices" tabindex="-1">Best Practices <a class="header-anchor" href="#best-practices" aria-label="Permalink to &quot;Best Practices&quot;">​</a></h2><h3 id="_1-use-read-only-database-user" tabindex="-1">1. Use Read-Only Database User <a class="header-anchor" href="#_1-use-read-only-database-user" aria-label="Permalink to &quot;1. Use Read-Only Database User&quot;">​</a></h3><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">-- Create read-only user</span></span>
<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#F97583;"> USER</span><span style="color:#E1E4E8;"> &#39;</span><span style="color:#B392F0;">tenant_reader</span><span style="color:#E1E4E8;">&#39;@</span><span style="color:#9ECBFF;">&#39;%&#39;</span><span style="color:#E1E4E8;"> IDENTIFIED </span><span style="color:#F97583;">BY</span><span style="color:#9ECBFF;"> &#39;secure_password&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">GRANT</span><span style="color:#F97583;"> SELECT</span><span style="color:#F97583;"> ON</span><span style="color:#79B8FF;"> tenants</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">tenant_configs</span><span style="color:#F97583;"> TO</span><span style="color:#9ECBFF;"> &#39;tenant_reader&#39;</span><span style="color:#E1E4E8;">@</span><span style="color:#9ECBFF;">&#39;%&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">FLUSH PRIVILEGES;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_2-use-views-for-data-isolation" tabindex="-1">2. Use Views for Data Isolation <a class="header-anchor" href="#_2-use-views-for-data-isolation" aria-label="Permalink to &quot;2. Use Views for Data Isolation&quot;">​</a></h3><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">-- Original table has sensitive data</span></span>
<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#F97583;"> TABLE</span><span style="color:#B392F0;"> tenants_internal</span><span style="color:#E1E4E8;"> (</span></span>
<span class="line"><span style="color:#E1E4E8;">    id </span><span style="color:#F97583;">VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">255</span><span style="color:#E1E4E8;">),</span></span>
<span class="line"><span style="color:#F97583;">    url</span><span style="color:#F97583;"> VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">500</span><span style="color:#E1E4E8;">),</span></span>
<span class="line"><span style="color:#E1E4E8;">    active </span><span style="color:#F97583;">TINYINT</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">),</span></span>
<span class="line"><span style="color:#E1E4E8;">    api_secret </span><span style="color:#F97583;">VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">500</span><span style="color:#E1E4E8;">),      </span><span style="color:#6A737D;">-- Sensitive!</span></span>
<span class="line"><span style="color:#E1E4E8;">    billing_email </span><span style="color:#F97583;">VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">255</span><span style="color:#E1E4E8;">),   </span><span style="color:#6A737D;">-- Sensitive!</span></span>
<span class="line"><span style="color:#E1E4E8;">    internal_notes </span><span style="color:#F97583;">TEXT</span><span style="color:#6A737D;">           -- Sensitive!</span></span>
<span class="line"><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- View exposes only necessary columns</span></span>
<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#F97583;"> VIEW</span><span style="color:#B392F0;"> tenant_configs</span><span style="color:#F97583;"> AS</span></span>
<span class="line"><span style="color:#F97583;">SELECT</span></span>
<span class="line"><span style="color:#E1E4E8;">    id </span><span style="color:#F97583;">AS</span><span style="color:#E1E4E8;"> tenant_id,</span></span>
<span class="line"><span style="color:#F97583;">    url</span><span style="color:#F97583;"> AS</span><span style="color:#E1E4E8;"> tenant_url,</span></span>
<span class="line"><span style="color:#F97583;">    IF</span><span style="color:#E1E4E8;">(active </span><span style="color:#F97583;">=</span><span style="color:#79B8FF;"> 1</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;1&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;0&#39;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">AS</span><span style="color:#E1E4E8;"> is_active</span></span>
<span class="line"><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> tenants_internal;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- Grant access only to view</span></span>
<span class="line"><span style="color:#F97583;">GRANT</span><span style="color:#F97583;"> SELECT</span><span style="color:#F97583;"> ON</span><span style="color:#79B8FF;"> tenants</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">tenant_configs</span><span style="color:#F97583;"> TO</span><span style="color:#9ECBFF;"> &#39;tenant_reader&#39;</span><span style="color:#E1E4E8;">@</span><span style="color:#9ECBFF;">&#39;%&#39;</span><span style="color:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="_3-add-indexes-for-performance" tabindex="-1">3. Add Indexes for Performance <a class="header-anchor" href="#_3-add-indexes-for-performance" aria-label="Permalink to &quot;3. Add Indexes for Performance&quot;">​</a></h3><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">-- Index on activation column for faster filtering</span></span>
<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#F97583;"> INDEX</span><span style="color:#B392F0;"> idx_active</span><span style="color:#F97583;"> ON</span><span style="color:#E1E4E8;"> tenants(is_active);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- Composite index for common queries</span></span>
<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#F97583;"> INDEX</span><span style="color:#B392F0;"> idx_active_created</span><span style="color:#F97583;"> ON</span><span style="color:#E1E4E8;"> tenants(is_active, created_at);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_4-validate-data-before-deployment" tabindex="-1">4. Validate Data Before Deployment <a class="header-anchor" href="#_4-validate-data-before-deployment" aria-label="Permalink to &quot;4. Validate Data Before Deployment&quot;">​</a></h3><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">-- Check for invalid activate values</span></span>
<span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> tenant_id, is_active</span></span>
<span class="line"><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> tenant_configs</span></span>
<span class="line"><span style="color:#F97583;">WHERE</span><span style="color:#E1E4E8;"> is_active </span><span style="color:#F97583;">NOT</span><span style="color:#F97583;"> IN</span><span style="color:#E1E4E8;"> (</span><span style="color:#9ECBFF;">&#39;0&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;1&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;true&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;false&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;yes&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;no&#39;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- Check for missing required fields</span></span>
<span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> tenant_id</span></span>
<span class="line"><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> tenant_configs</span></span>
<span class="line"><span style="color:#F97583;">WHERE</span><span style="color:#E1E4E8;"> tenant_url </span><span style="color:#F97583;">IS</span><span style="color:#F97583;"> NULL</span><span style="color:#F97583;"> OR</span><span style="color:#E1E4E8;"> tenant_url </span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;"> &#39;&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- Check for duplicate UIDs</span></span>
<span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> tenant_id, </span><span style="color:#79B8FF;">COUNT</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">as</span><span style="color:#E1E4E8;"> count</span></span>
<span class="line"><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> tenant_configs</span></span>
<span class="line"><span style="color:#F97583;">GROUP BY</span><span style="color:#E1E4E8;"> tenant_id</span></span>
<span class="line"><span style="color:#F97583;">HAVING</span><span style="color:#E1E4E8;"> count </span><span style="color:#F97583;">&gt;</span><span style="color:#79B8FF;"> 1</span><span style="color:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="_5-use-appropriate-sync-intervals" tabindex="-1">5. Use Appropriate Sync Intervals <a class="header-anchor" href="#_5-use-appropriate-sync-intervals" aria-label="Permalink to &quot;5. Use Appropriate Sync Intervals&quot;">​</a></h3><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># High-frequency (more API calls, faster sync)</span></span>
<span class="line"><span style="color:#85E89D;">syncInterval</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">30s</span><span style="color:#6A737D;">   # For development/testing</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Medium-frequency (balanced)</span></span>
<span class="line"><span style="color:#85E89D;">syncInterval</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">1m</span><span style="color:#6A737D;">    # Recommended for production</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Low-frequency (fewer API calls, slower sync)</span></span>
<span class="line"><span style="color:#85E89D;">syncInterval</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">5m</span><span style="color:#6A737D;">    # For large deployments (1000+ tenants)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">​</a></h2><h3 id="problem-tenants-not-being-created" tabindex="-1">Problem: Tenants Not Being Created <a class="header-anchor" href="#problem-tenants-not-being-created" aria-label="Permalink to &quot;Problem: Tenants Not Being Created&quot;">​</a></h3><p><strong>Check 1: Verify <code>activate</code> column values</strong></p><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> tenant_id, is_active,</span></span>
<span class="line"><span style="color:#F97583;">    CASE</span><span style="color:#E1E4E8;"> is_active</span></span>
<span class="line"><span style="color:#F97583;">        WHEN</span><span style="color:#9ECBFF;"> &#39;1&#39;</span><span style="color:#F97583;"> THEN</span><span style="color:#9ECBFF;"> &#39;✅ Valid&#39;</span></span>
<span class="line"><span style="color:#F97583;">        WHEN</span><span style="color:#9ECBFF;"> &#39;true&#39;</span><span style="color:#F97583;"> THEN</span><span style="color:#9ECBFF;"> &#39;✅ Valid&#39;</span></span>
<span class="line"><span style="color:#F97583;">        WHEN</span><span style="color:#9ECBFF;"> &#39;TRUE&#39;</span><span style="color:#F97583;"> THEN</span><span style="color:#9ECBFF;"> &#39;✅ Valid&#39;</span></span>
<span class="line"><span style="color:#F97583;">        WHEN</span><span style="color:#9ECBFF;"> &#39;yes&#39;</span><span style="color:#F97583;"> THEN</span><span style="color:#9ECBFF;"> &#39;✅ Valid&#39;</span></span>
<span class="line"><span style="color:#F97583;">        ELSE</span><span style="color:#9ECBFF;"> &#39;❌ Invalid&#39;</span></span>
<span class="line"><span style="color:#F97583;">    END</span><span style="color:#F97583;"> AS</span><span style="color:#F97583;"> status</span></span>
<span class="line"><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> tenant_configs;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>Check 2: Query what operator sees</strong></p><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">-- Run the exact query operator uses</span></span>
<span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> tenant_id, tenant_url, is_active</span></span>
<span class="line"><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> tenant_configs;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>Check 3: Check operator logs</strong></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> logs</span><span style="color:#79B8FF;"> -n</span><span style="color:#9ECBFF;"> tenant-operator-system</span><span style="color:#79B8FF;"> -l</span><span style="color:#9ECBFF;"> control-plane=controller-manager</span><span style="color:#F97583;"> |</span><span style="color:#B392F0;"> grep</span><span style="color:#79B8FF;"> -i</span><span style="color:#9ECBFF;"> &quot;query\\|tenant&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="problem-view-not-updating" tabindex="-1">Problem: View Not Updating <a class="header-anchor" href="#problem-view-not-updating" aria-label="Permalink to &quot;Problem: View Not Updating&quot;">​</a></h3><p><strong>Solution 1: Refresh view definition</strong></p><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#F97583;">DROP</span><span style="color:#F97583;"> VIEW</span><span style="color:#F97583;"> IF</span><span style="color:#F97583;"> EXISTS</span><span style="color:#E1E4E8;"> tenant_configs;</span></span>
<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#F97583;"> VIEW</span><span style="color:#B392F0;"> tenant_configs</span><span style="color:#F97583;"> AS</span></span>
<span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> ...;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>Solution 2: Check view dependencies</strong></p><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#E1E4E8;">SHOW </span><span style="color:#F97583;">CREATE</span><span style="color:#E1E4E8;"> VIEW tenant_configs;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="problem-connection-errors" tabindex="-1">Problem: Connection Errors <a class="header-anchor" href="#problem-connection-errors" aria-label="Permalink to &quot;Problem: Connection Errors&quot;">​</a></h3><p><strong>Check database accessibility from cluster:</strong></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> run</span><span style="color:#9ECBFF;"> mysql-test</span><span style="color:#79B8FF;"> --rm</span><span style="color:#79B8FF;"> -it</span><span style="color:#79B8FF;"> --image=mysql:8</span><span style="color:#79B8FF;"> --</span><span style="color:#79B8FF;"> \\</span></span>
<span class="line"><span style="color:#9ECBFF;">  mysql</span><span style="color:#79B8FF;"> -h</span><span style="color:#9ECBFF;"> mysql.default.svc.cluster.local</span><span style="color:#79B8FF;"> -u</span><span style="color:#9ECBFF;"> tenant_reader</span><span style="color:#79B8FF;"> -p</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>Check credentials:</strong></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;"># Verify secret exists</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> get</span><span style="color:#9ECBFF;"> secret</span><span style="color:#9ECBFF;"> mysql-secret</span><span style="color:#79B8FF;"> -o</span><span style="color:#9ECBFF;"> yaml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Decode password</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#9ECBFF;"> get</span><span style="color:#9ECBFF;"> secret</span><span style="color:#9ECBFF;"> mysql-secret</span><span style="color:#79B8FF;"> -o</span><span style="color:#9ECBFF;"> jsonpath=&#39;{.data.password}&#39;</span><span style="color:#F97583;"> |</span><span style="color:#B392F0;"> base64</span><span style="color:#79B8FF;"> -d</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="complete-example" tabindex="-1">Complete Example <a class="header-anchor" href="#complete-example" aria-label="Permalink to &quot;Complete Example&quot;">​</a></h2><h3 id="database-setup" tabindex="-1">Database Setup <a class="header-anchor" href="#database-setup" aria-label="Permalink to &quot;Database Setup&quot;">​</a></h3><div class="language-sql line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#6A737D;">-- Create main tenants table</span></span>
<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#F97583;"> TABLE</span><span style="color:#B392F0;"> tenants</span><span style="color:#E1E4E8;"> (</span></span>
<span class="line"><span style="color:#E1E4E8;">    id </span><span style="color:#F97583;">INT</span><span style="color:#E1E4E8;"> AUTO_INCREMENT </span><span style="color:#F97583;">PRIMARY KEY</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    company_name </span><span style="color:#F97583;">VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">255</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">NOT NULL</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    subdomain </span><span style="color:#F97583;">VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">NOT NULL</span><span style="color:#F97583;"> UNIQUE</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#F97583;">    status</span><span style="color:#E1E4E8;"> ENUM(</span><span style="color:#9ECBFF;">&#39;active&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;suspended&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;trial&#39;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">DEFAULT</span><span style="color:#9ECBFF;"> &#39;trial&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    plan </span><span style="color:#F97583;">VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">50</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">DEFAULT</span><span style="color:#9ECBFF;"> &#39;free&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    region </span><span style="color:#F97583;">VARCHAR</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">50</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">DEFAULT</span><span style="color:#9ECBFF;"> &#39;us-east-1&#39;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    max_users </span><span style="color:#F97583;">INT</span><span style="color:#F97583;"> DEFAULT</span><span style="color:#79B8FF;"> 5</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    created_at </span><span style="color:#F97583;">TIMESTAMP</span><span style="color:#F97583;"> DEFAULT</span><span style="color:#E1E4E8;"> CURRENT_TIMESTAMP,</span></span>
<span class="line"><span style="color:#E1E4E8;">    updated_at </span><span style="color:#F97583;">TIMESTAMP</span><span style="color:#F97583;"> DEFAULT</span><span style="color:#E1E4E8;"> CURRENT_TIMESTAMP </span><span style="color:#F97583;">ON</span><span style="color:#F97583;"> UPDATE</span><span style="color:#E1E4E8;"> CURRENT_TIMESTAMP</span></span>
<span class="line"><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- Create transformation view</span></span>
<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#F97583;"> VIEW</span><span style="color:#B392F0;"> tenant_configs</span><span style="color:#F97583;"> AS</span></span>
<span class="line"><span style="color:#F97583;">SELECT</span></span>
<span class="line"><span style="color:#79B8FF;">    CONCAT</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;tenant-&#39;</span><span style="color:#E1E4E8;">, id) </span><span style="color:#F97583;">AS</span><span style="color:#E1E4E8;"> tenant_id,</span></span>
<span class="line"><span style="color:#79B8FF;">    CONCAT</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&#39;https://&#39;</span><span style="color:#E1E4E8;">, subdomain, </span><span style="color:#9ECBFF;">&#39;.myapp.com&#39;</span><span style="color:#E1E4E8;">) </span><span style="color:#F97583;">AS</span><span style="color:#E1E4E8;"> tenant_url,</span></span>
<span class="line"><span style="color:#F97583;">    CASE</span><span style="color:#F97583;"> status</span></span>
<span class="line"><span style="color:#F97583;">        WHEN</span><span style="color:#9ECBFF;"> &#39;active&#39;</span><span style="color:#F97583;"> THEN</span><span style="color:#9ECBFF;"> &#39;1&#39;</span></span>
<span class="line"><span style="color:#F97583;">        WHEN</span><span style="color:#9ECBFF;"> &#39;trial&#39;</span><span style="color:#F97583;"> THEN</span><span style="color:#9ECBFF;"> &#39;1&#39;</span></span>
<span class="line"><span style="color:#F97583;">        ELSE</span><span style="color:#9ECBFF;"> &#39;0&#39;</span></span>
<span class="line"><span style="color:#F97583;">    END</span><span style="color:#F97583;"> AS</span><span style="color:#E1E4E8;"> is_active,</span></span>
<span class="line"><span style="color:#E1E4E8;">    plan </span><span style="color:#F97583;">AS</span><span style="color:#E1E4E8;"> subscription_plan,</span></span>
<span class="line"><span style="color:#E1E4E8;">    region </span><span style="color:#F97583;">AS</span><span style="color:#E1E4E8;"> deployment_region,</span></span>
<span class="line"><span style="color:#E1E4E8;">    max_users </span><span style="color:#F97583;">AS</span><span style="color:#E1E4E8;"> max_user_count</span></span>
<span class="line"><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> tenants;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- Create read-only user</span></span>
<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#F97583;"> USER</span><span style="color:#E1E4E8;"> &#39;</span><span style="color:#B392F0;">tenant_reader</span><span style="color:#E1E4E8;">&#39;@</span><span style="color:#9ECBFF;">&#39;%&#39;</span><span style="color:#E1E4E8;"> IDENTIFIED </span><span style="color:#F97583;">BY</span><span style="color:#9ECBFF;"> &#39;secure_password_here&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">GRANT</span><span style="color:#F97583;"> SELECT</span><span style="color:#F97583;"> ON</span><span style="color:#79B8FF;"> mydb</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">tenant_configs</span><span style="color:#F97583;"> TO</span><span style="color:#9ECBFF;"> &#39;tenant_reader&#39;</span><span style="color:#E1E4E8;">@</span><span style="color:#9ECBFF;">&#39;%&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">FLUSH PRIVILEGES;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- Insert sample data</span></span>
<span class="line"><span style="color:#F97583;">INSERT INTO</span><span style="color:#E1E4E8;"> tenants (company_name, subdomain, </span><span style="color:#F97583;">status</span><span style="color:#E1E4E8;">, plan, region, max_users) </span><span style="color:#F97583;">VALUES</span></span>
<span class="line"><span style="color:#E1E4E8;">    (</span><span style="color:#9ECBFF;">&#39;Acme Corp&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;acme&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;active&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;enterprise&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;us-east-1&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;">),</span></span>
<span class="line"><span style="color:#E1E4E8;">    (</span><span style="color:#9ECBFF;">&#39;Beta Inc&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;beta&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;trial&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;startup&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;eu-west-1&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;">),</span></span>
<span class="line"><span style="color:#E1E4E8;">    (</span><span style="color:#9ECBFF;">&#39;Gamma LLC&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;gamma&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;suspended&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;free&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;ap-south-1&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><h3 id="kubernetes-secret" tabindex="-1">Kubernetes Secret <a class="header-anchor" href="#kubernetes-secret" aria-label="Permalink to &quot;Kubernetes Secret&quot;">​</a></h3><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Secret</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">  name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">mysql-credentials</span></span>
<span class="line"><span style="color:#85E89D;">  namespace</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">tenant-operator-system</span></span>
<span class="line"><span style="color:#85E89D;">type</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Opaque</span></span>
<span class="line"><span style="color:#85E89D;">stringData</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">  password</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">secure_password_here</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="tenantregistry" tabindex="-1">TenantRegistry <a class="header-anchor" href="#tenantregistry" aria-label="Permalink to &quot;TenantRegistry&quot;">​</a></h3><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">operator.kubernetes-tenants.org/v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">TenantRegistry</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">  name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">production-tenants</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">  source</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">    type</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">mysql</span></span>
<span class="line"><span style="color:#85E89D;">    mysql</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">      host</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">mysql.default.svc.cluster.local</span></span>
<span class="line"><span style="color:#85E89D;">      port</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">3306</span></span>
<span class="line"><span style="color:#85E89D;">      username</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">tenant_reader</span></span>
<span class="line"><span style="color:#85E89D;">      passwordRef</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">        name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">mysql-credentials</span></span>
<span class="line"><span style="color:#85E89D;">        key</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">password</span></span>
<span class="line"><span style="color:#85E89D;">      database</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">mydb</span></span>
<span class="line"><span style="color:#85E89D;">      table</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">tenant_configs</span><span style="color:#6A737D;">  # ✅ Use view name</span></span>
<span class="line"><span style="color:#85E89D;">    syncInterval</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">1m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D;">  valueMappings</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">    uid</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">tenant_id</span></span>
<span class="line"><span style="color:#85E89D;">    hostOrUrl</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">tenant_url</span></span>
<span class="line"><span style="color:#85E89D;">    activate</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">is_active</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D;">  extraValueMappings</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#85E89D;">    planId</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">subscription_plan</span></span>
<span class="line"><span style="color:#85E89D;">    region</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">deployment_region</span></span>
<span class="line"><span style="color:#85E89D;">    maxUsers</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">max_user_count</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="query-results" tabindex="-1">Query Results <a class="header-anchor" href="#query-results" aria-label="Permalink to &quot;Query Results&quot;">​</a></h3><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code" tabindex="0"><code><span class="line"><span>tenant_id      tenant_url                      is_active  subscription_plan  deployment_region  max_user_count</span></span>
<span class="line"><span>-------------- ------------------------------- ---------- ------------------ ------------------ --------------</span></span>
<span class="line"><span>tenant-1       https://acme.myapp.com          1          enterprise         us-east-1          100</span></span>
<span class="line"><span>tenant-2       https://beta.myapp.com          1          startup            eu-west-1          10</span></span>
<span class="line"><span>tenant-3       https://gamma.myapp.com         0          free               ap-south-1         5</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>Result:</strong> 2 Tenant CRs created (tenant-1, tenant-2). tenant-3 is skipped because <code>is_active = &quot;0&quot;</code>.</p><h2 id="see-also" tabindex="-1">See Also <a class="header-anchor" href="#see-also" aria-label="Permalink to &quot;See Also&quot;">​</a></h2><ul><li><a href="./configuration.html">Configuration Guide</a> - Registry and template configuration</li><li><a href="./templates.html">Templates Guide</a> - Using template variables</li><li><a href="./security.html">Security Guide</a> - Securing database credentials</li><li><a href="./troubleshooting.html">Troubleshooting Guide</a> - Common issues and solutions</li></ul>`,41)])])}const m=e(r,[["render",t]]);export{d as __pageData,m as default};
